import { Steps } from "nextra/components"
import { Callout } from "nextra/components"

# React (Vite / CRA)

This guide explains how to integrate Rybbit with your client-side React application, such as those created with Create React App (CRA) or Vite.

## How to Add Rybbit to Your React App

There are two primary methods to add the Rybbit tracking script: directly in your `index.html` file (simplest for most SPAs) or by dynamically injecting it using a React component (more control, but often unnecessary if Rybbit's script handles SPA navigation well).

### Method 1: Adding to `public/index.html` (Recommended for CRA/Vite)

This is the most straightforward method and ensures the script is loaded early.

<Steps>
### 1. Retrieve Your Tracking Script

Navigate to your Rybbit dashboard to obtain your code snippet. It will look like this:

```html
<script
  src="https://app.rybbit.io/api/script.js"
  data-site-id="YOUR_SITE_ID"
  async
></script>
```
Remember to replace `YOUR_SITE_ID` with your actual Site ID.

### 2. Locate Your `index.html` File

-   For **Create React App (CRA)**: This file is typically located at `public/index.html`.
-   For **Vite (React template)**: This file is typically located at the root of your project as `index.html`.

### 3. Add the Snippet to `index.html`

Open your `index.html` file and paste the Rybbit tracking snippet just before the closing `</head>` tag or `</body>` tag. Placing it in the `<head>` allows it to load sooner.

```html filename="public/index.html (CRA) or index.html (Vite)"
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" /> {/* Example for CRA */}
    {/* Other meta tags and links */}
    <title>My React App</title>
    {/* Rybbit Tracking Snippet */}
    <script
      src="https://app.rybbit.io/api/script.js"
      data-site-id="YOUR_SITE_ID"
      async
    ></script>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
    {/* If you prefer, you can also place the script here, before </body> */}
  </body>
</html>
```
Make sure to replace `YOUR_SITE_ID` with your actual Site ID.

### 4. Verify Installation

After deploying your application, open your Rybbit dashboard to see if data is being received. You can also check your browser's network tab to ensure `script.js` is loaded.
</Steps>

### Method 2: Using a React Component (Advanced)

You can also load the script dynamically using a React component, for instance, with `useEffect`. This gives you more control but is generally not necessary if the script is placed in `index.html`.

```jsx filename="src/components/RybbitTracker.jsx"
import React, { useEffect } from 'react'; // Corrected import

const RYBBIT_SITE_ID = 'YOUR_SITE_ID'; // Replace with your Site ID

const RybbitTracker = () => {
  useEffect(() => {
    const existingScript = document.querySelector(`script[data-site-id="${RYBBIT_SITE_ID}"]`);

    if (!existingScript) {
      const script = document.createElement('script');
      script.src = 'https://app.rybbit.io/api/script.js';
      script.async = true;
      script.setAttribute('data-site-id', RYBBIT_SITE_ID);
      document.head.appendChild(script);

      // Optional: Clean up script on component unmount if needed,
      // though for analytics scripts, this is usually not desired.
      // return () => {
      //   document.head.removeChild(script);
      // };
    }
  }, []); // Empty dependency array ensures this runs once on mount

  return null; // This component doesn't render anything
};

export default RybbitTracker;
```
You would then include this component in your main `App.js` or a similar root component:
```jsx filename="src/App.js"
import RybbitTracker from './components/RybbitTracker';
// ... other imports

function App() {
  return (
    <>
      <RybbitTracker />
      {/* Rest of your application */}
    </>
  );
}

export default App;
```

<Callout type="info">
  **SPA Page View Tracking**: Rybbit's tracking script is designed to automatically detect route changes in most modern SPAs (including those using React Router or similar libraries) and track them as page views. If you find that page views are not being tracked correctly after navigation, you might need to manually trigger page views using `window.rybbit.trackPageview()` after each route change. However, try the standard installation first.
</Callout>

## Custom Event Tracking

Once the script is installed, you can track custom events from any of your React components:

```jsx
function MyComponent() {
  const handleButtonClick = () => {
    if (window.rybbit) {
      window.rybbit.trackEvent('button_click', { category: 'CTA', label: 'Learn More' });
    }
  };

  return <button onClick={handleButtonClick}>Learn More</button>;
}
```

Ensure `window.rybbit` is available before calling its methods, especially if you load the script dynamically or have strict Content Security Policies.