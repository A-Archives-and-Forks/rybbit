{"version":3,"file":"script-full.js","sources":["../../analytics-script/node_modules/web-vitals/dist/web-vitals.js","../../analytics-script/src/webVitals.ts","../../analytics-script/src/utils.ts","../../analytics-script/src/index.ts"],"sourcesContent":["var e,n,t,i,r,a=-1,o=function(e){addEventListener(\"pageshow\",(function(n){n.persisted&&(a=n.timeStamp,e(n))}),!0)},c=function(){return window.performance&&performance.getEntriesByType&&performance.getEntriesByType(\"navigation\")[0]},u=function(){var e=c();return e&&e.activationStart||0},f=function(e,n){var t=c(),i=\"navigate\";a>=0?i=\"back-forward-cache\":t&&(document.prerendering||u()>0?i=\"prerender\":document.wasDiscarded?i=\"restore\":t.type&&(i=t.type.replace(/_/g,\"-\")));return{name:e,value:void 0===n?-1:n,rating:\"good\",delta:0,entries:[],id:\"v3-\".concat(Date.now(),\"-\").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:i}},s=function(e,n,t){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var i=new PerformanceObserver((function(e){Promise.resolve().then((function(){n(e.getEntries())}))}));return i.observe(Object.assign({type:e,buffered:!0},t||{})),i}}catch(e){}},d=function(e,n,t,i){var r,a;return function(o){n.value>=0&&(o||i)&&((a=n.value-(r||0))||void 0===r)&&(r=n.value,n.delta=a,n.rating=function(e,n){return e>n[1]?\"poor\":e>n[0]?\"needs-improvement\":\"good\"}(n.value,t),e(n))}},l=function(e){requestAnimationFrame((function(){return requestAnimationFrame((function(){return e()}))}))},p=function(e){var n=function(n){\"pagehide\"!==n.type&&\"hidden\"!==document.visibilityState||e(n)};addEventListener(\"visibilitychange\",n,!0),addEventListener(\"pagehide\",n,!0)},v=function(e){var n=!1;return function(t){n||(e(t),n=!0)}},m=-1,h=function(){return\"hidden\"!==document.visibilityState||document.prerendering?1/0:0},g=function(e){\"hidden\"===document.visibilityState&&m>-1&&(m=\"visibilitychange\"===e.type?e.timeStamp:0,T())},y=function(){addEventListener(\"visibilitychange\",g,!0),addEventListener(\"prerenderingchange\",g,!0)},T=function(){removeEventListener(\"visibilitychange\",g,!0),removeEventListener(\"prerenderingchange\",g,!0)},E=function(){return m<0&&(m=h(),y(),o((function(){setTimeout((function(){m=h(),y()}),0)}))),{get firstHiddenTime(){return m}}},C=function(e){document.prerendering?addEventListener(\"prerenderingchange\",(function(){return e()}),!0):e()},L=[1800,3e3],w=function(e,n){n=n||{},C((function(){var t,i=E(),r=f(\"FCP\"),a=s(\"paint\",(function(e){e.forEach((function(e){\"first-contentful-paint\"===e.name&&(a.disconnect(),e.startTime<i.firstHiddenTime&&(r.value=Math.max(e.startTime-u(),0),r.entries.push(e),t(!0)))}))}));a&&(t=d(e,r,L,n.reportAllChanges),o((function(i){r=f(\"FCP\"),t=d(e,r,L,n.reportAllChanges),l((function(){r.value=performance.now()-i.timeStamp,t(!0)}))})))}))},b=[.1,.25],S=function(e,n){n=n||{},w(v((function(){var t,i=f(\"CLS\",0),r=0,a=[],c=function(e){e.forEach((function(e){if(!e.hadRecentInput){var n=a[0],t=a[a.length-1];r&&e.startTime-t.startTime<1e3&&e.startTime-n.startTime<5e3?(r+=e.value,a.push(e)):(r=e.value,a=[e])}})),r>i.value&&(i.value=r,i.entries=a,t())},u=s(\"layout-shift\",c);u&&(t=d(e,i,b,n.reportAllChanges),p((function(){c(u.takeRecords()),t(!0)})),o((function(){r=0,i=f(\"CLS\",0),t=d(e,i,b,n.reportAllChanges),l((function(){return t()}))})),setTimeout(t,0))})))},A={passive:!0,capture:!0},I=new Date,P=function(i,r){e||(e=r,n=i,t=new Date,k(removeEventListener),F())},F=function(){if(n>=0&&n<t-I){var r={entryType:\"first-input\",name:e.type,target:e.target,cancelable:e.cancelable,startTime:e.timeStamp,processingStart:e.timeStamp+n};i.forEach((function(e){e(r)})),i=[]}},M=function(e){if(e.cancelable){var n=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;\"pointerdown\"==e.type?function(e,n){var t=function(){P(e,n),r()},i=function(){r()},r=function(){removeEventListener(\"pointerup\",t,A),removeEventListener(\"pointercancel\",i,A)};addEventListener(\"pointerup\",t,A),addEventListener(\"pointercancel\",i,A)}(n,e):P(n,e)}},k=function(e){[\"mousedown\",\"keydown\",\"touchstart\",\"pointerdown\"].forEach((function(n){return e(n,M,A)}))},D=[100,300],x=function(t,r){r=r||{},C((function(){var a,c=E(),u=f(\"FID\"),l=function(e){e.startTime<c.firstHiddenTime&&(u.value=e.processingStart-e.startTime,u.entries.push(e),a(!0))},m=function(e){e.forEach(l)},h=s(\"first-input\",m);a=d(t,u,D,r.reportAllChanges),h&&p(v((function(){m(h.takeRecords()),h.disconnect()}))),h&&o((function(){var o;u=f(\"FID\"),a=d(t,u,D,r.reportAllChanges),i=[],n=-1,e=null,k(addEventListener),o=l,i.push(o),F()}))}))},B=0,R=1/0,H=0,N=function(e){e.forEach((function(e){e.interactionId&&(R=Math.min(R,e.interactionId),H=Math.max(H,e.interactionId),B=H?(H-R)/7+1:0)}))},O=function(){return r?B:performance.interactionCount||0},q=function(){\"interactionCount\"in performance||r||(r=s(\"event\",N,{type:\"event\",buffered:!0,durationThreshold:0}))},j=[200,500],_=0,z=function(){return O()-_},G=[],J={},K=function(e){var n=G[G.length-1],t=J[e.interactionId];if(t||G.length<10||e.duration>n.latency){if(t)t.entries.push(e),t.latency=Math.max(t.latency,e.duration);else{var i={id:e.interactionId,latency:e.duration,entries:[e]};J[i.id]=i,G.push(i)}G.sort((function(e,n){return n.latency-e.latency})),G.splice(10).forEach((function(e){delete J[e.id]}))}},Q=function(e,n){n=n||{},C((function(){var t;q();var i,r=f(\"INP\"),a=function(e){e.forEach((function(e){(e.interactionId&&K(e),\"first-input\"===e.entryType)&&(!G.some((function(n){return n.entries.some((function(n){return e.duration===n.duration&&e.startTime===n.startTime}))}))&&K(e))}));var n,t=(n=Math.min(G.length-1,Math.floor(z()/50)),G[n]);t&&t.latency!==r.value&&(r.value=t.latency,r.entries=t.entries,i())},c=s(\"event\",a,{durationThreshold:null!==(t=n.durationThreshold)&&void 0!==t?t:40});i=d(e,r,j,n.reportAllChanges),c&&(\"PerformanceEventTiming\"in window&&\"interactionId\"in PerformanceEventTiming.prototype&&c.observe({type:\"first-input\",buffered:!0}),p((function(){a(c.takeRecords()),r.value<0&&z()>0&&(r.value=0,r.entries=[]),i(!0)})),o((function(){G=[],_=O(),r=f(\"INP\"),i=d(e,r,j,n.reportAllChanges)})))}))},U=[2500,4e3],V={},W=function(e,n){n=n||{},C((function(){var t,i=E(),r=f(\"LCP\"),a=function(e){var n=e[e.length-1];n&&n.startTime<i.firstHiddenTime&&(r.value=Math.max(n.startTime-u(),0),r.entries=[n],t())},c=s(\"largest-contentful-paint\",a);if(c){t=d(e,r,U,n.reportAllChanges);var m=v((function(){V[r.id]||(a(c.takeRecords()),c.disconnect(),V[r.id]=!0,t(!0))}));[\"keydown\",\"click\"].forEach((function(e){addEventListener(e,(function(){return setTimeout(m,0)}),!0)})),p(m),o((function(i){r=f(\"LCP\"),t=d(e,r,U,n.reportAllChanges),l((function(){r.value=performance.now()-i.timeStamp,V[r.id]=!0,t(!0)}))}))}}))},X=[800,1800],Y=function e(n){document.prerendering?C((function(){return e(n)})):\"complete\"!==document.readyState?addEventListener(\"load\",(function(){return e(n)}),!0):setTimeout(n,0)},Z=function(e,n){n=n||{};var t=f(\"TTFB\"),i=d(e,t,X,n.reportAllChanges);Y((function(){var r=c();if(r){var a=r.responseStart;if(a<=0||a>performance.now())return;t.value=Math.max(a-u(),0),t.entries=[r],i(!0),o((function(){t=f(\"TTFB\",0),(i=d(e,t,X,n.reportAllChanges))(!0)}))}}))};export{b as CLSThresholds,L as FCPThresholds,D as FIDThresholds,j as INPThresholds,U as LCPThresholds,X as TTFBThresholds,S as getCLS,w as getFCP,x as getFID,Q as getINP,W as getLCP,Z as getTTFB,S as onCLS,w as onFCP,x as onFID,Q as onINP,W as onLCP,Z as onTTFB};\n","import { getCLS, getFCP, getINP, getLCP, getTTFB } from \"web-vitals\";\r\nimport type {\r\n  WebVitalsData,\r\n  WebVitalsMetric,\r\n  TrackingPayload,\r\n} from \"./types.js\";\r\n\r\nexport class WebVitalsCollector {\r\n  private data: WebVitalsData = {\r\n    lcp: null,\r\n    cls: null,\r\n    inp: null,\r\n    fcp: null,\r\n    ttfb: null,\r\n  };\r\n\r\n  private sent = false;\r\n  private timeout: ReturnType<typeof setTimeout> | null = null;\r\n  private onSend: (payload: Partial<TrackingPayload>) => void;\r\n\r\n  constructor(onSend: (payload: Partial<TrackingPayload>) => void) {\r\n    this.onSend = onSend;\r\n  }\r\n\r\n  /**\r\n   * Initialize Web Vitals collection\r\n   */\r\n  public init(): void {\r\n    if (this.sent) return;\r\n\r\n    try {\r\n      // Track Core Web Vitals\r\n      getLCP(this.collectMetric.bind(this));\r\n      getCLS(this.collectMetric.bind(this));\r\n      getINP(this.collectMetric.bind(this));\r\n\r\n      // Track additional metrics\r\n      getFCP(this.collectMetric.bind(this));\r\n      getTTFB(this.collectMetric.bind(this));\r\n\r\n      // Set a timeout to send metrics even if not all are collected\r\n      // This handles cases where some metrics might not fire (e.g., no user interactions for INP)\r\n      this.timeout = setTimeout(() => {\r\n        if (!this.sent) {\r\n          this.sendMetrics();\r\n        }\r\n      }, 20000);\r\n\r\n      // Also send on page unload to capture any remaining metrics\r\n      window.addEventListener(\"beforeunload\", () => {\r\n        if (!this.sent) {\r\n          this.sendMetrics();\r\n        }\r\n      });\r\n    } catch (e) {\r\n      console.warn(\"Error initializing web vitals tracking:\", e);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Collect individual metric\r\n   */\r\n  private collectMetric(metric: WebVitalsMetric): void {\r\n    if (this.sent) return;\r\n\r\n    const metricName = metric.name.toLowerCase() as keyof WebVitalsData;\r\n    this.data[metricName] = metric.value;\r\n\r\n    this.checkAndSendMetrics();\r\n  }\r\n\r\n  /**\r\n   * Check if all metrics are collected and send if ready\r\n   */\r\n  private checkAndSendMetrics(): void {\r\n    if (this.sent) return;\r\n\r\n    const allMetricsCollected = Object.values(this.data).every(\r\n      (value) => value !== null\r\n    );\r\n\r\n    if (allMetricsCollected) {\r\n      this.sendMetrics();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Send web vitals data in a single request\r\n   */\r\n  private sendMetrics(): void {\r\n    if (this.sent) return;\r\n    this.sent = true;\r\n\r\n    // Clear timeout if it exists\r\n    if (this.timeout) {\r\n      clearTimeout(this.timeout);\r\n      this.timeout = null;\r\n    }\r\n\r\n    const payload: Partial<TrackingPayload> = {\r\n      type: \"performance\",\r\n      event_name: \"web-vitals\",\r\n      // Include all collected metrics\r\n      lcp: this.data.lcp,\r\n      cls: this.data.cls,\r\n      inp: this.data.inp,\r\n      fcp: this.data.fcp,\r\n      ttfb: this.data.ttfb,\r\n    };\r\n\r\n    this.onSend(payload);\r\n  }\r\n\r\n  /**\r\n   * Get current metrics data (for testing)\r\n   */\r\n  public getData(): WebVitalsData {\r\n    return { ...this.data };\r\n  }\r\n\r\n  /**\r\n   * Check if metrics have been sent (for testing)\r\n   */\r\n  public isSent(): boolean {\r\n    return this.sent;\r\n  }\r\n\r\n  /**\r\n   * Reset collector state (for testing)\r\n   */\r\n  public reset(): void {\r\n    this.data = {\r\n      lcp: null,\r\n      cls: null,\r\n      inp: null,\r\n      fcp: null,\r\n      ttfb: null,\r\n    };\r\n    this.sent = false;\r\n    if (this.timeout) {\r\n      clearTimeout(this.timeout);\r\n      this.timeout = null;\r\n    }\r\n  }\r\n}\r\n","import type { CustomEventProperties } from \"./types.js\";\r\n\r\n/**\r\n * Helper function to convert wildcard pattern to regex\r\n */\r\nexport function patternToRegex(pattern: string): RegExp {\r\n  // Use a safer approach by replacing wildcards with unique tokens first\r\n  const DOUBLE_WILDCARD_TOKEN = \"__DOUBLE_ASTERISK_TOKEN__\";\r\n  const SINGLE_WILDCARD_TOKEN = \"__SINGLE_ASTERISK_TOKEN__\";\r\n\r\n  // Replace wildcards with tokens\r\n  let tokenized = pattern\r\n    .replace(/\\*\\*/g, DOUBLE_WILDCARD_TOKEN)\r\n    .replace(/\\*/g, SINGLE_WILDCARD_TOKEN);\r\n\r\n  // Escape special regex characters\r\n  let escaped = tokenized.replace(/[.+?^${}()|[\\]\\\\]/g, \"\\\\$&\");\r\n\r\n  // Escape forward slashes\r\n  escaped = escaped.replace(/\\//g, \"\\\\/\");\r\n\r\n  // Replace tokens with appropriate regex patterns\r\n  let regexPattern = escaped\r\n    .replace(new RegExp(DOUBLE_WILDCARD_TOKEN, \"g\"), \".*\")\r\n    .replace(new RegExp(SINGLE_WILDCARD_TOKEN, \"g\"), \"[^/]+\");\r\n\r\n  return new RegExp(\"^\" + regexPattern + \"$\");\r\n}\r\n\r\n/**\r\n * Find matching pattern in array of patterns\r\n */\r\nexport function findMatchingPattern(\r\n  path: string,\r\n  patterns: string[]\r\n): string | null {\r\n  for (const pattern of patterns) {\r\n    try {\r\n      const regex = patternToRegex(pattern);\r\n      if (regex.test(path)) {\r\n        return pattern; // Return the pattern string itself\r\n      }\r\n    } catch (e) {\r\n      console.error(`Invalid pattern: ${pattern}`, e);\r\n    }\r\n  }\r\n  return null;\r\n}\r\n\r\n/**\r\n * Debounce function to limit function calls\r\n */\r\nexport function debounce<T extends (...args: any[]) => any>(\r\n  func: T,\r\n  wait: number\r\n): (...args: Parameters<T>) => void {\r\n  let timeout: ReturnType<typeof setTimeout>;\r\n  return function (...args: Parameters<T>) {\r\n    clearTimeout(timeout);\r\n    timeout = setTimeout(() => func(...args), wait);\r\n  };\r\n}\r\n\r\n/**\r\n * Check if a URL is an outbound link\r\n */\r\nexport function isOutboundLink(url: string): boolean {\r\n  try {\r\n    const currentHost = window.location.hostname;\r\n    const linkHost = new URL(url).hostname;\r\n    return linkHost !== currentHost && linkHost !== \"\";\r\n  } catch (e) {\r\n    return false;\r\n  }\r\n}\r\n\r\n/**\r\n * Parse JSON safely with fallback\r\n */\r\nexport function safeJsonParse<T>(jsonString: string | null, fallback: T): T {\r\n  if (!jsonString) return fallback;\r\n\r\n  try {\r\n    const parsed = JSON.parse(jsonString);\r\n    // Only return parsed if it matches the expected type structure\r\n    if (Array.isArray(fallback) && Array.isArray(parsed)) {\r\n      return parsed as T;\r\n    }\r\n    return fallback;\r\n  } catch (e) {\r\n    console.error(\"Error parsing JSON:\", e);\r\n    return fallback;\r\n  }\r\n}\r\n\r\n/**\r\n * Get attribute value with fallback\r\n */\r\nexport function getAttributeValue(\r\n  element: Element | null,\r\n  ...attributeNames: string[]\r\n): string | null {\r\n  if (!element) return null;\r\n\r\n  for (const attrName of attributeNames) {\r\n    const value = element.getAttribute(attrName);\r\n    if (value !== null) return value;\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\n/**\r\n * Collect custom event properties from data attributes\r\n */\r\nexport function collectCustomProperties(\r\n  element: Element\r\n): CustomEventProperties {\r\n  const properties: CustomEventProperties = {};\r\n\r\n  for (const attr of element.attributes) {\r\n    if (attr.name.startsWith(\"data-rybbit-prop-\")) {\r\n      const propName = attr.name.replace(\"data-rybbit-prop-\", \"\");\r\n      properties[propName] = attr.value;\r\n    }\r\n  }\r\n\r\n  return properties;\r\n}\r\n/**\r\n * Alias for collectCustomProperties to match import name\r\n */\r\nexport const collectCustomEventProperties = collectCustomProperties;\r\n\r\n/**\r\n * Safe localStorage operations\r\n */\r\nexport function safeLocalStorageGet(key: string): string | null {\r\n  try {\r\n    return localStorage.getItem(key);\r\n  } catch (e) {\r\n    return null;\r\n  }\r\n}\r\n\r\nexport function safeLocalStorageSet(key: string, value: string): void {\r\n  try {\r\n    localStorage.setItem(key, value);\r\n  } catch (e) {\r\n    console.warn(\"Could not persist to localStorage:\", e);\r\n  }\r\n}\r\n\r\nexport function safeLocalStorageRemove(key: string): void {\r\n  try {\r\n    localStorage.removeItem(key);\r\n  } catch (e) {\r\n    // localStorage not available, ignore\r\n  }\r\n}\r\n\r\n/**\r\n * Safe localStorage operations\r\n */\r\nexport const storage = {\r\n  get(key: string): string | null {\r\n    try {\r\n      return localStorage.getItem(key);\r\n    } catch (e) {\r\n      return null;\r\n    }\r\n  },\r\n\r\n  set(key: string, value: string): boolean {\r\n    try {\r\n      localStorage.setItem(key, value);\r\n      return true;\r\n    } catch (e) {\r\n      console.warn(`Could not persist ${key} to localStorage`);\r\n      return false;\r\n    }\r\n  },\r\n\r\n  remove(key: string): boolean {\r\n    try {\r\n      localStorage.removeItem(key);\r\n      return true;\r\n    } catch (e) {\r\n      return false;\r\n    }\r\n  },\r\n};\r\n","import { WebVitalsCollector } from \"./webVitals.js\";\r\nimport {\r\n  patternToRegex,\r\n  findMatchingPattern,\r\n  debounce,\r\n  isOutboundLink,\r\n  safeJsonParse,\r\n  safeLocalStorageGet,\r\n  safeLocalStorageSet,\r\n  safeLocalStorageRemove,\r\n  collectCustomEventProperties,\r\n} from \"./utils.js\";\r\nimport type {\r\n  RybbitConfig,\r\n  TrackingPayload,\r\n  CustomEventProperties,\r\n  RybbitAPI,\r\n} from \"./types.js\";\r\n\r\n// Main analytics script implementation\r\n(function (): void {\r\n  const scriptTag = document.currentScript as HTMLScriptElement;\r\n  if (!scriptTag) {\r\n    console.error(\"Rybbit Analytics: Could not find script tag\");\r\n    return;\r\n  }\r\n\r\n  const ANALYTICS_HOST = scriptTag.getAttribute(\"src\")?.split(\"/script.js\")[0];\r\n\r\n  // Check if the user has opted out of tracking\r\n  if (\r\n    !!window.__RYBBIT_OPTOUT__ ||\r\n    safeLocalStorageGet(\"disable-rybbit\") !== null\r\n  ) {\r\n    // Create a no-op implementation to ensure the API still works\r\n    window.rybbit = {\r\n      pageview: () => {},\r\n      event: () => {},\r\n      trackOutbound: () => {},\r\n      identify: () => {},\r\n      clearUserId: () => {},\r\n      getUserId: () => null,\r\n    };\r\n    return;\r\n  }\r\n\r\n  if (!ANALYTICS_HOST) {\r\n    console.error(\"Please provide a valid analytics host\");\r\n    return;\r\n  }\r\n\r\n  const SITE_ID =\r\n    scriptTag.getAttribute(\"data-site-id\") || scriptTag.getAttribute(\"site-id\");\r\n\r\n  if (!SITE_ID || isNaN(Number(SITE_ID))) {\r\n    console.error(\r\n      \"Please provide a valid site ID using the data-site-id attribute\"\r\n    );\r\n    return;\r\n  }\r\n\r\n  // Parse configuration from script attributes\r\n  const config: RybbitConfig = {\r\n    siteId: SITE_ID,\r\n    analyticsHost: ANALYTICS_HOST,\r\n    debounceDuration: scriptTag.getAttribute(\"data-debounce\")\r\n      ? Math.max(0, parseInt(scriptTag.getAttribute(\"data-debounce\") || \"0\"))\r\n      : 500,\r\n    autoTrackPageview:\r\n      scriptTag.getAttribute(\"data-auto-track-pageview\") !== \"false\",\r\n    autoTrackSpa: scriptTag.getAttribute(\"data-track-spa\") !== \"false\",\r\n    trackQuerystring: scriptTag.getAttribute(\"data-track-query\") !== \"false\",\r\n    trackOutbound: scriptTag.getAttribute(\"data-track-outbound\") !== \"false\",\r\n    // Temporarily enabled for testing - in production this would be:\r\n    // enableWebVitals: scriptTag.getAttribute('data-web-vitals') === 'true',\r\n    enableWebVitals: true,\r\n    skipPatterns: [],\r\n    maskPatterns: [],\r\n  };\r\n\r\n  // Parse skip patterns\r\n  try {\r\n    const skipAttr = scriptTag.getAttribute(\"data-skip-patterns\");\r\n    if (skipAttr) {\r\n      const parsed = safeJsonParse(skipAttr, []);\r\n      if (Array.isArray(parsed)) {\r\n        config.skipPatterns = parsed;\r\n      }\r\n    }\r\n  } catch (e) {\r\n    console.error(\"Error parsing data-skip-patterns:\", e);\r\n  }\r\n\r\n  // Parse mask patterns\r\n  try {\r\n    const maskAttr = scriptTag.getAttribute(\"data-mask-patterns\");\r\n    if (maskAttr) {\r\n      const parsed = safeJsonParse(maskAttr, []);\r\n      if (Array.isArray(parsed)) {\r\n        config.maskPatterns = parsed;\r\n      }\r\n    }\r\n  } catch (e) {\r\n    console.error(\"Error parsing data-mask-patterns:\", e);\r\n  }\r\n\r\n  // User ID management\r\n  let customUserId: string | null = null;\r\n\r\n  // Load stored user ID from localStorage on script initialization\r\n  const storedUserId = safeLocalStorageGet(\"rybbit-user-id\");\r\n  if (storedUserId) {\r\n    customUserId = storedUserId;\r\n  }\r\n\r\n  // Helper function to create base payload with pattern matching\r\n  const createBasePayload = (): TrackingPayload | null => {\r\n    const url = new URL(window.location.href);\r\n    let pathname = url.pathname;\r\n\r\n    // Always handle hash-based SPA routing\r\n    if (url.hash && url.hash.startsWith(\"#/\")) {\r\n      // For #/path format, replace pathname with just /path\r\n      pathname = url.hash.substring(1);\r\n    }\r\n\r\n    // Check skip patterns\r\n    if (findMatchingPattern(pathname, config.skipPatterns)) {\r\n      return null; // Indicates tracking should be skipped\r\n    }\r\n\r\n    // Apply mask patterns\r\n    const maskMatch = findMatchingPattern(pathname, config.maskPatterns);\r\n    if (maskMatch) {\r\n      pathname = maskMatch;\r\n    }\r\n\r\n    const payload: TrackingPayload = {\r\n      site_id: config.siteId,\r\n      hostname: url.hostname,\r\n      pathname: pathname,\r\n      querystring: config.trackQuerystring ? url.search : \"\",\r\n      screenWidth: window.innerWidth,\r\n      screenHeight: window.innerHeight,\r\n      language: navigator.language,\r\n      page_title: document.title,\r\n      referrer: document.referrer,\r\n      type: \"pageview\", // Default type, will be overridden\r\n    };\r\n\r\n    // Add custom user ID only if it's set\r\n    if (customUserId) {\r\n      payload.user_id = customUserId;\r\n    }\r\n\r\n    return payload;\r\n  };\r\n\r\n  // Helper function to send tracking data\r\n  const sendTrackingData = (payload: Partial<TrackingPayload>): void => {\r\n    fetch(`${config.analyticsHost}/track`, {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify(payload),\r\n      mode: \"cors\",\r\n      keepalive: true,\r\n    }).catch(console.error);\r\n  };\r\n\r\n  // Main tracking function\r\n  const track = (\r\n    eventType: TrackingPayload[\"type\"] = \"pageview\",\r\n    eventName = \"\",\r\n    properties: CustomEventProperties = {}\r\n  ): void => {\r\n    if (\r\n      eventType === \"custom_event\" &&\r\n      (!eventName || typeof eventName !== \"string\")\r\n    ) {\r\n      console.error(\r\n        \"Event name is required and must be a string for custom events\"\r\n      );\r\n      return;\r\n    }\r\n\r\n    const basePayload = createBasePayload();\r\n    if (!basePayload) {\r\n      return; // Skip tracking due to pattern match\r\n    }\r\n\r\n    const payload: Partial<TrackingPayload> = {\r\n      ...basePayload,\r\n      type: eventType,\r\n      event_name: eventName,\r\n      properties:\r\n        eventType === \"custom_event\" || eventType === \"outbound\"\r\n          ? JSON.stringify(properties)\r\n          : undefined,\r\n    };\r\n\r\n    sendTrackingData(payload);\r\n  };\r\n\r\n  // Initialize Web Vitals if enabled\r\n  let webVitalsCollector: WebVitalsCollector | null = null;\r\n  if (config.enableWebVitals) {\r\n    webVitalsCollector = new WebVitalsCollector(sendTrackingData);\r\n    webVitalsCollector.init();\r\n  }\r\n\r\n  // Pageview tracking\r\n  const trackPageview = (): void => track(\"pageview\");\r\n\r\n  const debouncedTrackPageview =\r\n    config.debounceDuration > 0\r\n      ? debounce(trackPageview, config.debounceDuration)\r\n      : trackPageview;\r\n\r\n  // Track outbound link clicks and custom data-attribute events\r\n  document.addEventListener(\"click\", function (e: MouseEvent): void {\r\n    // First check for custom events via data attributes\r\n    let target = e.target as Element | null;\r\n    while (target && target !== document.documentElement) {\r\n      if (target.hasAttribute(\"data-rybbit-event\")) {\r\n        const eventName = target.getAttribute(\"data-rybbit-event\");\r\n        if (eventName) {\r\n          // Collect additional properties from data-rybbit-prop-* attributes\r\n          const properties = collectCustomEventProperties(target);\r\n          track(\"custom_event\", eventName, properties);\r\n        }\r\n        break;\r\n      }\r\n      target = target.parentElement;\r\n    }\r\n\r\n    // Then check for outbound links\r\n    if (config.trackOutbound) {\r\n      const link = (e.target as Element).closest(\"a\") as HTMLAnchorElement;\r\n      if (!link || !link.href) return;\r\n\r\n      if (isOutboundLink(link.href)) {\r\n        track(\"outbound\", \"\", {\r\n          url: link.href,\r\n          text: link.innerText || link.textContent || \"\",\r\n          target: link.target || \"_self\",\r\n        });\r\n      }\r\n    }\r\n  });\r\n\r\n  // SPA tracking setup\r\n  if (config.autoTrackSpa) {\r\n    const originalPushState = history.pushState;\r\n    const originalReplaceState = history.replaceState;\r\n\r\n    history.pushState = function (\r\n      ...args: Parameters<typeof history.pushState>\r\n    ): void {\r\n      originalPushState.apply(this, args);\r\n      debouncedTrackPageview();\r\n    };\r\n\r\n    history.replaceState = function (\r\n      ...args: Parameters<typeof history.replaceState>\r\n    ): void {\r\n      originalReplaceState.apply(this, args);\r\n      debouncedTrackPageview();\r\n    };\r\n\r\n    window.addEventListener(\"popstate\", debouncedTrackPageview);\r\n    // Always listen for hashchange events for hash-based routing\r\n    window.addEventListener(\"hashchange\", debouncedTrackPageview);\r\n  }\r\n\r\n  // Create the public API\r\n  const rybbitAPI: RybbitAPI = {\r\n    pageview: trackPageview,\r\n    event: (name: string, properties: CustomEventProperties = {}): void =>\r\n      track(\"custom_event\", name, properties),\r\n    trackOutbound: (url: string, text = \"\", target = \"_self\"): void =>\r\n      track(\"outbound\", \"\", { url, text, target }),\r\n\r\n    // User identification methods\r\n    identify: (userId: string): void => {\r\n      if (typeof userId !== \"string\" || userId.trim() === \"\") {\r\n        console.error(\"User ID must be a non-empty string\");\r\n        return;\r\n      }\r\n      customUserId = userId.trim();\r\n      safeLocalStorageSet(\"rybbit-user-id\", customUserId);\r\n    },\r\n\r\n    clearUserId: (): void => {\r\n      customUserId = null;\r\n      safeLocalStorageRemove(\"rybbit-user-id\");\r\n    },\r\n\r\n    getUserId: (): string | null => customUserId,\r\n  };\r\n\r\n  // Expose the API globally\r\n  window.rybbit = rybbitAPI;\r\n\r\n  // Auto-track initial pageview if enabled\r\n  if (config.autoTrackPageview) {\r\n    trackPageview();\r\n  }\r\n})();\r\n"],"names":["e","r","a","o","n","i","c","t","u","m","getLCP","getCLS","getINP","getFCP","getTTFB"],"mappings":"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","x_google_ignoreList":[0]}