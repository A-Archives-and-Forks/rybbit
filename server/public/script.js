"use strict";(()=>{var Yi=Object.defineProperty;var Ki=(t,e,r)=>e in t?Yi(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var ji=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var be=(t,e,r)=>Ki(t,typeof e!="symbol"?e+"":e,r);var Ri=ji(re=>{"use strict";Object.defineProperty(re,"__esModule",{value:!0});var x;(function(t){t[t.Document=0]="Document",t[t.DocumentType=1]="DocumentType",t[t.Element=2]="Element",t[t.Text=3]="Text",t[t.CDATA=4]="CDATA",t[t.Comment=5]="Comment"})(x||(x={}));function Bn(t){return t.nodeType===t.ELEMENT_NODE}function it(t){var e=t?.host;return e?.shadowRoot===t}function st(t){return Object.prototype.toString.call(t)==="[object ShadowRoot]"}function Xi(t){return t.includes(" background-clip: text;")&&!t.includes(" -webkit-background-clip: text;")&&(t=t.replace(" background-clip: text;"," -webkit-background-clip: text; background-clip: text;")),t}function Qi(t){var e=t.cssText;if(e.split('"').length<3)return e;var r=["@import","url(".concat(JSON.stringify(t.href),")")];return t.layerName===""?r.push("layer"):t.layerName&&r.push("layer(".concat(t.layerName,")")),t.supportsText&&r.push("supports(".concat(t.supportsText,")")),t.media.length&&r.push(t.media.mediaText),r.join(" ")+";"}function Et(t){try{var e=t.rules||t.cssRules;return e?Xi(Array.from(e).map(Pn).join("")):null}catch{return null}}function Pn(t){var e;if($i(t))try{e=Et(t.styleSheet)||Qi(t)}catch{}return qi(e||t.cssText)}function qi(t){if(t.includes(":")){var e=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm;return t.replace(e,"$1\\$2")}return t}function $i(t){return"styleSheet"in t}var Ar=function(){function t(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}return t.prototype.getId=function(e){var r;if(!e)return-1;var n=(r=this.getMeta(e))===null||r===void 0?void 0:r.id;return n??-1},t.prototype.getNode=function(e){return this.idNodeMap.get(e)||null},t.prototype.getIds=function(){return Array.from(this.idNodeMap.keys())},t.prototype.getMeta=function(e){return this.nodeMetaMap.get(e)||null},t.prototype.removeNodeFromMap=function(e){var r=this,n=this.getId(e);this.idNodeMap.delete(n),e.childNodes&&e.childNodes.forEach(function(i){return r.removeNodeFromMap(i)})},t.prototype.has=function(e){return this.idNodeMap.has(e)},t.prototype.hasNode=function(e){return this.nodeMetaMap.has(e)},t.prototype.add=function(e,r){var n=r.id;this.idNodeMap.set(n,e),this.nodeMetaMap.set(e,r)},t.prototype.replace=function(e,r){var n=this.getNode(e);if(n){var i=this.nodeMetaMap.get(n);i&&this.nodeMetaMap.set(r,i)}this.idNodeMap.set(e,r)},t.prototype.reset=function(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap},t}();function Wn(){return new Ar}function Nr(t){var e=t.element,r=t.maskInputOptions,n=t.tagName,i=t.type,s=t.value,o=t.maskInputFn,l=s||"",a=i&&xe(i);return(r[n.toLowerCase()]||a&&r[a])&&(o?l=o(l,e):l="*".repeat(l.length)),l}function xe(t){return t.toLowerCase()}var on="__rrweb_original__";function es(t){var e=t.getContext("2d");if(!e)return!0;for(var r=50,n=0;n<t.width;n+=r)for(var i=0;i<t.height;i+=r){var s=e.getImageData,o=on in s?s[on]:s,l=new Uint32Array(o.call(e,n,i,Math.min(r,t.width-n),Math.min(r,t.height-i)).data.buffer);if(l.some(function(a){return a!==0}))return!1}return!0}function ts(t,e){return!t||!e||t.type!==e.type?!1:t.type===x.Document?t.compatMode===e.compatMode:t.type===x.DocumentType?t.name===e.name&&t.publicId===e.publicId&&t.systemId===e.systemId:t.type===x.Comment||t.type===x.Text||t.type===x.CDATA?t.textContent===e.textContent:t.type===x.Element?t.tagName===e.tagName&&JSON.stringify(t.attributes)===JSON.stringify(e.attributes)&&t.isSVG===e.isSVG&&t.needBlock===e.needBlock:!1}function Tr(t){var e=t.type;return t.hasAttribute("data-rr-is-password")?"password":e?xe(e):null}var rs=1,ns=new RegExp("[^a-z0-9-_:]"),lt=-2;function Un(){return rs++}function is(t){if(t instanceof HTMLFormElement)return"form";var e=xe(t.tagName);return ns.test(e)?"div":e}function ss(t){var e="";return t.indexOf("//")>-1?e=t.split("/").slice(0,3).join("/"):e=t.split("/")[0],e=e.split("?")[0],e}var We,an,os=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,as=/^(?:[a-z+]+:)?\/\//i,ls=/^www\..*/i,cs=/^(data:)([^,]*),(.*)/i;function At(t,e){return(t||"").replace(os,function(r,n,i,s,o,l){var a=i||o||l,c=n||s||"";if(!a)return r;if(as.test(a)||ls.test(a)||cs.test(a))return"url(".concat(c).concat(a).concat(c,")");if(a[0]==="/")return"url(".concat(c).concat(ss(e)+a).concat(c,")");var u=e.split("/"),d=a.split("/");u.pop();for(var h=0,f=d;h<f.length;h++){var p=f[h];p!=="."&&(p===".."?u.pop():u.push(p))}return"url(".concat(c).concat(u.join("/")).concat(c,")")})}var us=/^[^ \t\n\r\u000c]+/,ds=/^[, \t\n\r\u000c]+/;function hs(t,e){if(e.trim()==="")return e;var r=0;function n(c){var u,d=c.exec(e.substring(r));return d?(u=d[0],r+=u.length,u):""}for(var i=[];n(ds),!(r>=e.length);){var s=n(us);if(s.slice(-1)===",")s=Ze(t,s.substring(0,s.length-1)),i.push(s);else{var o="";s=Ze(t,s);for(var l=!1;;){var a=e.charAt(r);if(a===""){i.push((s+o).trim());break}else if(l)a===")"&&(l=!1);else if(a===","){r+=1,i.push((s+o).trim());break}else a==="("&&(l=!0);o+=a,r+=1}}}return i.join(", ")}function Ze(t,e){if(!e||e.trim()==="")return e;var r=t.createElement("a");return r.href=e,r.href}function fs(t){return!!(t.tagName==="svg"||t.ownerSVGElement)}function Rr(){var t=document.createElement("a");return t.href="",t.href}function Vn(t,e,r,n){return n&&(r==="src"||r==="href"&&!(e==="use"&&n[0]==="#")||r==="xlink:href"&&n[0]!=="#"||r==="background"&&(e==="table"||e==="td"||e==="th")?Ze(t,n):r==="srcset"?hs(t,n):r==="style"?At(n,Rr()):e==="object"&&r==="data"?Ze(t,n):n)}function Gn(t,e,r){return(t==="video"||t==="audio")&&e==="autoplay"}function ps(t,e,r){try{if(typeof e=="string"){if(t.classList.contains(e))return!0}else for(var n=t.classList.length;n--;){var i=t.classList[n];if(e.test(i))return!0}if(r)return t.matches(r)}catch{}return!1}function Nt(t,e,r){if(!t)return!1;if(t.nodeType!==t.ELEMENT_NODE)return r?Nt(t.parentNode,e,r):!1;for(var n=t.classList.length;n--;){var i=t.classList[n];if(e.test(i))return!0}return r?Nt(t.parentNode,e,r):!1}function Hn(t,e,r){try{var n=t.nodeType===t.ELEMENT_NODE?t:t.parentElement;if(n===null)return!1;if(typeof e=="string"){if(n.classList.contains(e)||n.closest(".".concat(e)))return!0}else if(Nt(n,e,!0))return!0;if(r&&(n.matches(r)||n.closest(r)))return!0}catch{}return!1}function ms(t,e,r){var n=t.contentWindow;if(n){var i=!1,s;try{s=n.document.readyState}catch{return}if(s!=="complete"){var o=setTimeout(function(){i||(e(),i=!0)},r);t.addEventListener("load",function(){clearTimeout(o),i=!0,e()});return}var l="about:blank";if(n.location.href!==l||t.src===l||t.src==="")return setTimeout(e,0),t.addEventListener("load",e);t.addEventListener("load",e)}}function gs(t,e,r){var n=!1,i;try{i=t.sheet}catch{return}if(!i){var s=setTimeout(function(){n||(e(),n=!0)},r);t.addEventListener("load",function(){clearTimeout(s),n=!0,e()})}}function vs(t,e){var r=e.doc,n=e.mirror,i=e.blockClass,s=e.blockSelector,o=e.maskTextClass,l=e.maskTextSelector,a=e.inlineStylesheet,c=e.maskInputOptions,u=c===void 0?{}:c,d=e.maskTextFn,h=e.maskInputFn,f=e.dataURLOptions,p=f===void 0?{}:f,m=e.inlineImages,I=e.recordCanvas,y=e.keepIframeSrcFn,v=e.newlyAddedElement,g=v===void 0?!1:v,b=ys(r,n);switch(t.nodeType){case t.DOCUMENT_NODE:return t.compatMode!=="CSS1Compat"?{type:x.Document,childNodes:[],compatMode:t.compatMode}:{type:x.Document,childNodes:[]};case t.DOCUMENT_TYPE_NODE:return{type:x.DocumentType,name:t.name,publicId:t.publicId,systemId:t.systemId,rootId:b};case t.ELEMENT_NODE:return Is(t,{doc:r,blockClass:i,blockSelector:s,inlineStylesheet:a,maskInputOptions:u,maskInputFn:h,dataURLOptions:p,inlineImages:m,recordCanvas:I,keepIframeSrcFn:y,newlyAddedElement:g,rootId:b});case t.TEXT_NODE:return Cs(t,{maskTextClass:o,maskTextSelector:l,maskTextFn:d,rootId:b});case t.CDATA_SECTION_NODE:return{type:x.CDATA,textContent:"",rootId:b};case t.COMMENT_NODE:return{type:x.Comment,textContent:t.textContent||"",rootId:b};default:return!1}}function ys(t,e){if(e.hasNode(t)){var r=e.getId(t);return r===1?void 0:r}}function Cs(t,e){var r,n=e.maskTextClass,i=e.maskTextSelector,s=e.maskTextFn,o=e.rootId,l=t.parentNode&&t.parentNode.tagName,a=t.textContent,c=l==="STYLE"?!0:void 0,u=l==="SCRIPT"?!0:void 0;if(c&&a){try{t.nextSibling||t.previousSibling||!((r=t.parentNode.sheet)===null||r===void 0)&&r.cssRules&&(a=Et(t.parentNode.sheet))}catch(d){console.warn("Cannot get CSS styles from text's parentNode. Error: ".concat(d),t)}a=At(a,Rr())}return u&&(a="SCRIPT_PLACEHOLDER"),!c&&!u&&a&&Hn(t,n,i)&&(a=s?s(a):a.replace(/[\S]/g,"*")),{type:x.Text,textContent:a||"",isStyle:c,rootId:o}}function Is(t,e){for(var r=e.doc,n=e.blockClass,i=e.blockSelector,s=e.inlineStylesheet,o=e.maskInputOptions,l=o===void 0?{}:o,a=e.maskInputFn,c=e.dataURLOptions,u=c===void 0?{}:c,d=e.inlineImages,h=e.recordCanvas,f=e.keepIframeSrcFn,p=e.newlyAddedElement,m=p===void 0?!1:p,I=e.rootId,y=ps(t,n,i),v=is(t),g={},b=t.attributes.length,E=0;E<b;E++){var T=t.attributes[E];Gn(v,T.name,T.value)||(g[T.name]=Vn(r,v,xe(T.name),T.value))}if(v==="link"&&s){var D=Array.from(r.styleSheets).find(function(N){return N.href===t.href}),w=null;D&&(w=Et(D)),w&&(delete g.rel,delete g.href,g._cssText=At(w,D.href))}if(v==="style"&&t.sheet&&!(t.innerText||t.textContent||"").trim().length){var w=Et(t.sheet);w&&(g._cssText=At(w,Rr()))}if(v==="input"||v==="textarea"||v==="select"){var j=t.value,_=t.checked;if(g.type!=="radio"&&g.type!=="checkbox"&&g.type!=="submit"&&g.type!=="button"&&j){var J=Tr(t);g.value=Nr({element:t,type:J,tagName:v,value:j,maskInputOptions:l,maskInputFn:a})}else _&&(g.checked=_)}if(v==="option"&&(t.selected&&!l.select?g.selected=!0:delete g.selected),v==="canvas"&&h){if(t.__context==="2d")es(t)||(g.rr_dataURL=t.toDataURL(u.type,u.quality));else if(!("__context"in t)){var W=t.toDataURL(u.type,u.quality),G=document.createElement("canvas");G.width=t.width,G.height=t.height;var K=G.toDataURL(u.type,u.quality);W!==K&&(g.rr_dataURL=W)}}if(v==="img"&&d){We||(We=r.createElement("canvas"),an=We.getContext("2d"));var L=t,F=L.crossOrigin;L.crossOrigin="anonymous";var k=function(){L.removeEventListener("load",k);try{We.width=L.naturalWidth,We.height=L.naturalHeight,an.drawImage(L,0,0),g.rr_dataURL=We.toDataURL(u.type,u.quality)}catch(N){console.warn("Cannot inline img src=".concat(L.currentSrc,"! Error: ").concat(N))}F?g.crossOrigin=F:L.removeAttribute("crossorigin")};L.complete&&L.naturalWidth!==0?k():L.addEventListener("load",k)}if((v==="audio"||v==="video")&&(g.rr_mediaState=t.paused?"paused":"played",g.rr_mediaCurrentTime=t.currentTime),m||(t.scrollLeft&&(g.rr_scrollLeft=t.scrollLeft),t.scrollTop&&(g.rr_scrollTop=t.scrollTop)),y){var H=t.getBoundingClientRect(),S=H.width,C=H.height;g={class:g.class,rr_width:"".concat(S,"px"),rr_height:"".concat(C,"px")}}return v==="iframe"&&!f(g.src)&&(t.contentDocument||(g.rr_src=g.src),delete g.src),{type:x.Element,tagName:v,attributes:g,childNodes:[],isSVG:fs(t)||void 0,needBlock:y,rootId:I}}function X(t){return t==null?"":t.toLowerCase()}function Ss(t,e){if(e.comment&&t.type===x.Comment)return!0;if(t.type===x.Element){if(e.script&&(t.tagName==="script"||t.tagName==="link"&&(t.attributes.rel==="preload"||t.attributes.rel==="modulepreload")&&t.attributes.as==="script"||t.tagName==="link"&&t.attributes.rel==="prefetch"&&typeof t.attributes.href=="string"&&t.attributes.href.endsWith(".js")))return!0;if(e.headFavicon&&(t.tagName==="link"&&t.attributes.rel==="shortcut icon"||t.tagName==="meta"&&(X(t.attributes.name).match(/^msapplication-tile(image|color)$/)||X(t.attributes.name)==="application-name"||X(t.attributes.rel)==="icon"||X(t.attributes.rel)==="apple-touch-icon"||X(t.attributes.rel)==="shortcut icon")))return!0;if(t.tagName==="meta"){if(e.headMetaDescKeywords&&X(t.attributes.name).match(/^description|keywords$/))return!0;if(e.headMetaSocial&&(X(t.attributes.property).match(/^(og|twitter|fb):/)||X(t.attributes.name).match(/^(og|twitter):/)||X(t.attributes.name)==="pinterest"))return!0;if(e.headMetaRobots&&(X(t.attributes.name)==="robots"||X(t.attributes.name)==="googlebot"||X(t.attributes.name)==="bingbot"))return!0;if(e.headMetaHttpEquiv&&t.attributes["http-equiv"]!==void 0)return!0;if(e.headMetaAuthorship&&(X(t.attributes.name)==="author"||X(t.attributes.name)==="generator"||X(t.attributes.name)==="framework"||X(t.attributes.name)==="publisher"||X(t.attributes.name)==="progid"||X(t.attributes.property).match(/^article:/)||X(t.attributes.property).match(/^product:/)))return!0;if(e.headMetaVerification&&(X(t.attributes.name)==="google-site-verification"||X(t.attributes.name)==="yandex-verification"||X(t.attributes.name)==="csrf-token"||X(t.attributes.name)==="p:domain_verify"||X(t.attributes.name)==="verify-v1"||X(t.attributes.name)==="verification"||X(t.attributes.name)==="shopify-checkout-api-token"))return!0}}return!1}function ze(t,e){var r=e.doc,n=e.mirror,i=e.blockClass,s=e.blockSelector,o=e.maskTextClass,l=e.maskTextSelector,a=e.skipChild,c=a===void 0?!1:a,u=e.inlineStylesheet,d=u===void 0?!0:u,h=e.maskInputOptions,f=h===void 0?{}:h,p=e.maskTextFn,m=e.maskInputFn,I=e.slimDOMOptions,y=e.dataURLOptions,v=y===void 0?{}:y,g=e.inlineImages,b=g===void 0?!1:g,E=e.recordCanvas,T=E===void 0?!1:E,D=e.onSerialize,w=e.onIframeLoad,j=e.iframeLoadTimeout,_=j===void 0?5e3:j,J=e.onStylesheetLoad,W=e.stylesheetLoadTimeout,G=W===void 0?5e3:W,K=e.keepIframeSrcFn,L=K===void 0?function(){return!1}:K,F=e.newlyAddedElement,k=F===void 0?!1:F,H=e.preserveWhiteSpace,S=H===void 0?!0:H,C=vs(t,{doc:r,mirror:n,blockClass:i,blockSelector:s,maskTextClass:o,maskTextSelector:l,inlineStylesheet:d,maskInputOptions:f,maskTextFn:p,maskInputFn:m,dataURLOptions:v,inlineImages:b,recordCanvas:T,keepIframeSrcFn:L,newlyAddedElement:k});if(!C)return console.warn(t,"not serialized"),null;var N;n.hasNode(t)?N=n.getId(t):Ss(C,I)||!S&&C.type===x.Text&&!C.isStyle&&!C.textContent.replace(/^\s+|\s+$/gm,"").length?N=lt:N=Un();var R=Object.assign(C,{id:N});if(n.add(t,R),N===lt)return null;D&&D(t);var Y=!c;if(R.type===x.Element){Y=Y&&!R.needBlock,delete R.needBlock;var Q=t.shadowRoot;Q&&st(Q)&&(R.isShadowHost=!0)}if((R.type===x.Document||R.type===x.Element)&&Y){I.headWhitespace&&R.type===x.Element&&R.tagName==="head"&&(S=!1);for(var ee={doc:r,mirror:n,blockClass:i,blockSelector:s,maskTextClass:o,maskTextSelector:l,skipChild:c,inlineStylesheet:d,maskInputOptions:f,maskTextFn:p,maskInputFn:m,slimDOMOptions:I,dataURLOptions:v,inlineImages:b,recordCanvas:T,preserveWhiteSpace:S,onSerialize:D,onIframeLoad:w,iframeLoadTimeout:_,onStylesheetLoad:J,stylesheetLoadTimeout:G,keepIframeSrcFn:L},ae=0,le=Array.from(t.childNodes);ae<le.length;ae++){var he=le[ae],fe=ze(he,ee);fe&&R.childNodes.push(fe)}if(Bn(t)&&t.shadowRoot)for(var O=0,se=Array.from(t.shadowRoot.childNodes);O<se.length;O++){var he=se[O],fe=ze(he,ee);fe&&(st(t.shadowRoot)&&(fe.isShadow=!0),R.childNodes.push(fe))}}return t.parentNode&&it(t.parentNode)&&st(t.parentNode)&&(R.isShadow=!0),R.type===x.Element&&R.tagName==="iframe"&&ms(t,function(){var U=t.contentDocument;if(U&&w){var ie=ze(U,{doc:U,mirror:n,blockClass:i,blockSelector:s,maskTextClass:o,maskTextSelector:l,skipChild:!1,inlineStylesheet:d,maskInputOptions:f,maskTextFn:p,maskInputFn:m,slimDOMOptions:I,dataURLOptions:v,inlineImages:b,recordCanvas:T,preserveWhiteSpace:S,onSerialize:D,onIframeLoad:w,iframeLoadTimeout:_,onStylesheetLoad:J,stylesheetLoadTimeout:G,keepIframeSrcFn:L});ie&&w(t,ie)}},_),R.type===x.Element&&R.tagName==="link"&&R.attributes.rel==="stylesheet"&&gs(t,function(){if(J){var U=ze(t,{doc:r,mirror:n,blockClass:i,blockSelector:s,maskTextClass:o,maskTextSelector:l,skipChild:!1,inlineStylesheet:d,maskInputOptions:f,maskTextFn:p,maskInputFn:m,slimDOMOptions:I,dataURLOptions:v,inlineImages:b,recordCanvas:T,preserveWhiteSpace:S,onSerialize:D,onIframeLoad:w,iframeLoadTimeout:_,onStylesheetLoad:J,stylesheetLoadTimeout:G,keepIframeSrcFn:L});U&&J(t,U)}},G),R}function bs(t,e){var r=e||{},n=r.mirror,i=n===void 0?new Ar:n,s=r.blockClass,o=s===void 0?"rr-block":s,l=r.blockSelector,a=l===void 0?null:l,c=r.maskTextClass,u=c===void 0?"rr-mask":c,d=r.maskTextSelector,h=d===void 0?null:d,f=r.inlineStylesheet,p=f===void 0?!0:f,m=r.inlineImages,I=m===void 0?!1:m,y=r.recordCanvas,v=y===void 0?!1:y,g=r.maskAllInputs,b=g===void 0?!1:g,E=r.maskTextFn,T=r.maskInputFn,D=r.slimDOM,w=D===void 0?!1:D,j=r.dataURLOptions,_=r.preserveWhiteSpace,J=r.onSerialize,W=r.onIframeLoad,G=r.iframeLoadTimeout,K=r.onStylesheetLoad,L=r.stylesheetLoadTimeout,F=r.keepIframeSrcFn,k=F===void 0?function(){return!1}:F,H=b===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:b===!1?{password:!0}:b,S=w===!0||w==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:w==="all",headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:w===!1?{}:w;return ze(t,{doc:t,mirror:i,blockClass:o,blockSelector:a,maskTextClass:u,maskTextSelector:h,skipChild:!1,inlineStylesheet:p,maskInputOptions:H,maskTextFn:E,maskInputFn:T,slimDOMOptions:S,dataURLOptions:j,inlineImages:I,recordCanvas:v,preserveWhiteSpace:_,onSerialize:J,onIframeLoad:W,iframeLoadTimeout:G,onStylesheetLoad:K,stylesheetLoadTimeout:L,keepIframeSrcFn:k,newlyAddedElement:!1})}var ln=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g;function ws(t,e){e===void 0&&(e={});var r=1,n=1;function i(S){var C=S.match(/\n/g);C&&(r+=C.length);var N=S.lastIndexOf(`
`);n=N===-1?n+S.length:S.length-N}function s(){var S={line:r,column:n};return function(C){return C.position=new o(S),p(),C}}var o=function(){function S(C){this.start=C,this.end={line:r,column:n},this.source=e.source}return S}();o.prototype.content=t;var l=[];function a(S){var C=new Error("".concat(e.source||"",":").concat(r,":").concat(n,": ").concat(S));if(C.reason=S,C.filename=e.source,C.line=r,C.column=n,C.source=t,e.silent)l.push(C);else throw C}function c(){var S=h();return{type:"stylesheet",stylesheet:{source:e.source,rules:S,parsingErrors:l}}}function u(){return f(/^{\s*/)}function d(){return f(/^}/)}function h(){var S,C=[];for(p(),m(C);t.length&&t.charAt(0)!=="}"&&(S=k()||H());)S&&(C.push(S),m(C));return C}function f(S){var C=S.exec(t);if(C){var N=C[0];return i(N),t=t.slice(N.length),C}}function p(){f(/^\s*/)}function m(S){S===void 0&&(S=[]);for(var C;C=I();)C&&S.push(C),C=I();return S}function I(){var S=s();if(!(t.charAt(0)!=="/"||t.charAt(1)!=="*")){for(var C=2;t.charAt(C)!==""&&(t.charAt(C)!=="*"||t.charAt(C+1)!=="/");)++C;if(C+=2,t.charAt(C-1)==="")return a("End of comment missing");var N=t.slice(2,C-2);return n+=2,i(N),t=t.slice(C),n+=2,S({type:"comment",comment:N})}}function y(){var S=f(/^([^{]+)/);if(S)return we(S[0]).replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g,"").replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,function(C){return C.replace(/,/g,"\u200C")}).split(/\s*(?![^(]*\)),\s*/).map(function(C){return C.replace(/\u200C/g,",")})}function v(){var S=s(),C=f(/^(\*?[-#\/\*\\\w]+(\[[0-9a-z_-]+\])?)\s*/);if(C){var N=we(C[0]);if(!f(/^:\s*/))return a("property missing ':'");var R=f(/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^\)]*?\)|[^};])+)/),Y=S({type:"declaration",property:N.replace(ln,""),value:R?we(R[0]).replace(ln,""):""});return f(/^[;\s]*/),Y}}function g(){var S=[];if(!u())return a("missing '{'");m(S);for(var C;C=v();)C!==!1&&(S.push(C),m(S)),C=v();return d()?S:a("missing '}'")}function b(){for(var S,C=[],N=s();S=f(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)C.push(S[1]),f(/^,\s*/);if(C.length)return N({type:"keyframe",values:C,declarations:g()})}function E(){var S=s(),C=f(/^@([-\w]+)?keyframes\s*/);if(C){var N=C[1];if(C=f(/^([-\w]+)\s*/),!C)return a("@keyframes missing name");var R=C[1];if(!u())return a("@keyframes missing '{'");for(var Y,Q=m();Y=b();)Q.push(Y),Q=Q.concat(m());return d()?S({type:"keyframes",name:R,vendor:N,keyframes:Q}):a("@keyframes missing '}'")}}function T(){var S=s(),C=f(/^@supports *([^{]+)/);if(C){var N=we(C[1]);if(!u())return a("@supports missing '{'");var R=m().concat(h());return d()?S({type:"supports",supports:N,rules:R}):a("@supports missing '}'")}}function D(){var S=s(),C=f(/^@host\s*/);if(C){if(!u())return a("@host missing '{'");var N=m().concat(h());return d()?S({type:"host",rules:N}):a("@host missing '}'")}}function w(){var S=s(),C=f(/^@media *([^{]+)/);if(C){var N=we(C[1]);if(!u())return a("@media missing '{'");var R=m().concat(h());return d()?S({type:"media",media:N,rules:R}):a("@media missing '}'")}}function j(){var S=s(),C=f(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(C)return S({type:"custom-media",name:we(C[1]),media:we(C[2])})}function _(){var S=s(),C=f(/^@page */);if(C){var N=y()||[];if(!u())return a("@page missing '{'");for(var R=m(),Y;Y=v();)R.push(Y),R=R.concat(m());return d()?S({type:"page",selectors:N,declarations:R}):a("@page missing '}'")}}function J(){var S=s(),C=f(/^@([-\w]+)?document *([^{]+)/);if(C){var N=we(C[1]),R=we(C[2]);if(!u())return a("@document missing '{'");var Y=m().concat(h());return d()?S({type:"document",document:R,vendor:N,rules:Y}):a("@document missing '}'")}}function W(){var S=s(),C=f(/^@font-face\s*/);if(C){if(!u())return a("@font-face missing '{'");for(var N=m(),R;R=v();)N.push(R),N=N.concat(m());return d()?S({type:"font-face",declarations:N}):a("@font-face missing '}'")}}var G=F("import"),K=F("charset"),L=F("namespace");function F(S){var C=new RegExp("^@"+S+"\\s*([^;]+);");return function(){var N=s(),R=f(C);if(R){var Y={type:S};return Y[S]=R[1].trim(),N(Y)}}}function k(){if(t[0]==="@")return E()||w()||j()||T()||G()||K()||L()||J()||_()||D()||W()}function H(){var S=s(),C=y();return C?(m(),S({type:"rule",selectors:C,declarations:g()})):a("selector missing")}return qt(c())}function we(t){return t?t.replace(/^\s+|\s+$/g,""):""}function qt(t,e){for(var r=t&&typeof t.type=="string",n=r?t:e,i=0,s=Object.keys(t);i<s.length;i++){var o=s[i],l=t[o];Array.isArray(l)?l.forEach(function(a){qt(a,n)}):l&&typeof l=="object"&&qt(l,n)}return r&&Object.defineProperty(t,"parent",{configurable:!0,writable:!0,enumerable:!1,value:e||null}),t}var cn={script:"noscript",altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"};function Es(t){var e=cn[t.tagName]?cn[t.tagName]:t.tagName;return e==="link"&&t.attributes._cssText&&(e="style"),e}function As(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var Zn=/([^\\]):hover/,Ns=new RegExp(Zn.source,"g");function un(t,e){var r=e?.stylesWithHoverClass.get(t);if(r)return r;var n=ws(t,{silent:!0});if(!n.stylesheet)return t;var i=[];if(n.stylesheet.rules.forEach(function(l){"selectors"in l&&(l.selectors||[]).forEach(function(a){Zn.test(a)&&i.push(a)})}),i.length===0)return t;var s=new RegExp(i.filter(function(l,a){return i.indexOf(l)===a}).sort(function(l,a){return a.length-l.length}).map(function(l){return As(l)}).join("|"),"g"),o=t.replace(s,function(l){var a=l.replace(Ns,"$1.\\:hover");return"".concat(l,", ").concat(a)});return e?.stylesWithHoverClass.set(t,o),o}function dn(){var t=new Map;return{stylesWithHoverClass:t}}function Ts(t,e){var r=e.doc,n=e.hackCss,i=e.cache;switch(t.type){case x.Document:return r.implementation.createDocument(null,"",null);case x.DocumentType:return r.implementation.createDocumentType(t.name||"html",t.publicId,t.systemId);case x.Element:{var s=Es(t),o;t.isSVG?o=r.createElementNS("http://www.w3.org/2000/svg",s):o=r.createElement(s);var l={};for(var a in t.attributes)if(Object.prototype.hasOwnProperty.call(t.attributes,a)){var c=t.attributes[a];if(!(s==="option"&&a==="selected"&&c===!1)&&c!==null){if(c===!0&&(c=""),a.startsWith("rr_")){l[a]=c;continue}var u=s==="textarea"&&a==="value",d=s==="style"&&a==="_cssText";if(d&&n&&typeof c=="string"&&(c=un(c,i)),(u||d)&&typeof c=="string"){for(var h=r.createTextNode(c),f=0,p=Array.from(o.childNodes);f<p.length;f++){var m=p[f];m.nodeType===o.TEXT_NODE&&o.removeChild(m)}o.appendChild(h);continue}try{if(t.isSVG&&a==="xlink:href")o.setAttributeNS("http://www.w3.org/1999/xlink",a,c.toString());else if(a==="onload"||a==="onclick"||a.substring(0,7)==="onmouse")o.setAttribute("_"+a,c.toString());else if(s==="meta"&&t.attributes["http-equiv"]==="Content-Security-Policy"&&a==="content"){o.setAttribute("csp-content",c.toString());continue}else s==="link"&&(t.attributes.rel==="preload"||t.attributes.rel==="modulepreload")&&t.attributes.as==="script"||s==="link"&&t.attributes.rel==="prefetch"&&typeof t.attributes.href=="string"&&t.attributes.href.endsWith(".js")||(s==="img"&&t.attributes.srcset&&t.attributes.rr_dataURL?o.setAttribute("rrweb-original-srcset",t.attributes.srcset):o.setAttribute(a,c.toString()))}catch{}}}var I=function(v){var g=l[v];if(s==="canvas"&&v==="rr_dataURL"){var b=document.createElement("img");b.onload=function(){var T=o.getContext("2d");T&&T.drawImage(b,0,0,b.width,b.height)},b.src=g.toString(),o.RRNodeType&&(o.rr_dataURL=g.toString())}else if(s==="img"&&v==="rr_dataURL"){var E=o;E.currentSrc.startsWith("data:")||(E.setAttribute("rrweb-original-src",t.attributes.src),E.src=g.toString())}if(v==="rr_width")o.style.width=g.toString();else if(v==="rr_height")o.style.height=g.toString();else if(v==="rr_mediaCurrentTime"&&typeof g=="number")o.currentTime=g;else if(v==="rr_mediaState")switch(g){case"played":o.play().catch(function(T){return console.warn("media playback error",T)});break;case"paused":o.pause();break}};for(var y in l)I(y);if(t.isShadowHost)if(!o.shadowRoot)o.attachShadow({mode:"open"});else for(;o.shadowRoot.firstChild;)o.shadowRoot.removeChild(o.shadowRoot.firstChild);return o}case x.Text:return r.createTextNode(t.isStyle&&n?un(t.textContent,i):t.textContent);case x.CDATA:return r.createCDATASection(t.textContent);case x.Comment:return r.createComment(t.textContent);default:return null}}function ot(t,e){var r=e.doc,n=e.mirror,i=e.skipChild,s=i===void 0?!1:i,o=e.hackCss,l=o===void 0?!0:o,a=e.afterAppend,c=e.cache;if(n.has(t.id)){var u=n.getNode(t.id),d=n.getMeta(u);if(ts(d,t))return n.getNode(t.id)}var h=Ts(t,{doc:r,hackCss:l,cache:c});if(!h)return null;if(t.rootId&&n.getNode(t.rootId)!==r&&n.replace(t.rootId,r),t.type===x.Document&&(r.close(),r.open(),t.compatMode==="BackCompat"&&t.childNodes&&t.childNodes[0].type!==x.DocumentType&&(t.childNodes[0].type===x.Element&&"xmlns"in t.childNodes[0].attributes&&t.childNodes[0].attributes.xmlns==="http://www.w3.org/1999/xhtml"?r.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'):r.write('<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">')),h=r),n.add(h,t),(t.type===x.Document||t.type===x.Element)&&!s)for(var f=function(y){var v=ot(y,{doc:r,mirror:n,skipChild:!1,hackCss:l,afterAppend:a,cache:c});if(!v)return console.warn("Failed to rebuild",y),"continue";if(y.isShadow&&Bn(h)&&h.shadowRoot)h.shadowRoot.appendChild(v);else if(t.type===x.Document&&y.type==x.Element){var g=v,b=null;g.childNodes.forEach(function(E){E.nodeName==="BODY"&&(b=E)}),b?(g.removeChild(b),h.appendChild(v),g.appendChild(b)):h.appendChild(v)}else h.appendChild(v);a&&a(v,y.id)},p=0,m=t.childNodes;p<m.length;p++){var I=m[p];f(I)}return h}function Rs(t,e){function r(o){e(o)}for(var n=0,i=t.getIds();n<i.length;n++){var s=i[n];t.has(s)&&r(t.getNode(s))}}function Ms(t,e){var r=e.getMeta(t);if(r?.type===x.Element){var n=t;for(var i in r.attributes)if(Object.prototype.hasOwnProperty.call(r.attributes,i)&&i.startsWith("rr_")){var s=r.attributes[i];i==="rr_scrollLeft"&&(n.scrollLeft=s),i==="rr_scrollTop"&&(n.scrollTop=s)}}}function ks(t,e){var r=e.doc,n=e.onVisit,i=e.hackCss,s=i===void 0?!0:i,o=e.afterAppend,l=e.cache,a=e.mirror,c=a===void 0?new Ar:a,u=ot(t,{doc:r,mirror:c,skipChild:!1,hackCss:s,afterAppend:o,cache:l});return Rs(c,function(d){n&&n(d),Ms(d,c)}),u}function ce(t,e,r=document){let n={capture:!0,passive:!0};return r.addEventListener(t,e,n),()=>r.removeEventListener(t,e,n)}var Ve=`Please stop import mirror directly. Instead of that,\r
now you can use replayer.getMirror() to access the mirror instance of a replayer,\r
or you can use record.mirror to access the mirror instance during recording.`;re.mirror={map:{},getId(){return console.error(Ve),-1},getNode(){return console.error(Ve),null},removeNodeFromMap(){console.error(Ve)},has(){return console.error(Ve),!1},reset(){console.error(Ve)}};typeof window<"u"&&window.Proxy&&window.Reflect&&(re.mirror=new Proxy(re.mirror,{get(t,e,r){return e==="map"&&console.error(Ve),Reflect.get(t,e,r)}}));function Xe(t,e,r={}){let n=null,i=0;return function(...s){let o=Date.now();!i&&r.leading===!1&&(i=o);let l=e-(o-i),a=this;l<=0||l>e?(n&&(clearTimeout(n),n=null),i=o,t.apply(a,s)):!n&&r.trailing!==!1&&(n=setTimeout(()=>{i=r.leading===!1?0:Date.now(),n=null,t.apply(a,s)},l))}}function ft(t,e,r,n,i=window){let s=i.Object.getOwnPropertyDescriptor(t,e);return i.Object.defineProperty(t,e,n?r:{set(o){setTimeout(()=>{r.set.call(this,o)},0),s&&s.set&&s.set.call(this,o)}}),()=>ft(t,e,s||{},!0)}function Be(t,e,r){try{if(!(e in t))return()=>{};let n=t[e],i=r(n);return typeof i=="function"&&(i.prototype=i.prototype||{},Object.defineProperties(i,{__rrweb_original__:{enumerable:!1,value:n}})),t[e]=i,()=>{t[e]=n}}catch{return()=>{}}}var ct=Date.now;/[1-9][0-9]{12}/.test(Date.now().toString())||(ct=()=>new Date().getTime());function Mr(t){var e,r,n,i,s,o;let l=t.document;return{left:l.scrollingElement?l.scrollingElement.scrollLeft:t.pageXOffset!==void 0?t.pageXOffset:l?.documentElement.scrollLeft||((r=(e=l?.body)===null||e===void 0?void 0:e.parentElement)===null||r===void 0?void 0:r.scrollLeft)||((n=l?.body)===null||n===void 0?void 0:n.scrollLeft)||0,top:l.scrollingElement?l.scrollingElement.scrollTop:t.pageYOffset!==void 0?t.pageYOffset:l?.documentElement.scrollTop||((s=(i=l?.body)===null||i===void 0?void 0:i.parentElement)===null||s===void 0?void 0:s.scrollTop)||((o=l?.body)===null||o===void 0?void 0:o.scrollTop)||0}}function kr(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function Dr(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function ue(t,e,r,n){if(!t)return!1;let i=t.nodeType===t.ELEMENT_NODE?t:t.parentElement;if(!i)return!1;try{if(typeof e=="string"){if(i.classList.contains(e)||n&&i.closest("."+e)!==null)return!0}else if(Nt(i,e,n))return!0}catch{}return!!(r&&(i.matches(r)||n&&i.closest(r)!==null))}function zn(t,e){return e.getId(t)!==-1}function It(t,e){return e.getId(t)===lt}function Or(t,e){if(it(t))return!1;let r=e.getId(t);return e.has(r)?t.parentNode&&t.parentNode.nodeType===t.DOCUMENT_NODE?!1:t.parentNode?Or(t.parentNode,e):!0:!0}function Tt(t){return!!t.changedTouches}function xr(t=window){"NodeList"in t&&!t.NodeList.prototype.forEach&&(t.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in t&&!t.DOMTokenList.prototype.forEach&&(t.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...e)=>{let r=e[0];if(!(0 in e))throw new TypeError("1 argument is required");do if(this===r)return!0;while(r=r&&r.parentNode);return!1})}function Yn(t){let e={},r=(i,s)=>{let o={value:i,parent:s,children:[]};return e[i.node.id]=o,o},n=[];for(let i of t){let{nextId:s,parentId:o}=i;if(s&&s in e){let l=e[s];if(l.parent){let a=l.parent.children.indexOf(l);l.parent.children.splice(a,0,r(i,l.parent))}else{let a=n.indexOf(l);n.splice(a,0,r(i,null))}continue}if(o in e){let l=e[o];l.children.push(r(i,l));continue}n.push(r(i,null))}return n}function Lr(t,e){e(t.value);for(let r=t.children.length-1;r>=0;r--)Lr(t.children[r],e)}function Je(t,e){return!!(t.nodeName==="IFRAME"&&e.getMeta(t))}function Fr(t,e){return!!(t.nodeName==="LINK"&&t.nodeType===t.ELEMENT_NODE&&t.getAttribute&&t.getAttribute("rel")==="stylesheet"&&e.getMeta(t))}function _r(t,e){var r,n;let i=(n=(r=t.ownerDocument)===null||r===void 0?void 0:r.defaultView)===null||n===void 0?void 0:n.frameElement;if(!i||i===e)return{x:0,y:0,relativeScale:1,absoluteScale:1};let s=i.getBoundingClientRect(),o=_r(i,e),l=s.height/i.clientHeight;return{x:s.x*o.relativeScale+o.x,y:s.y*o.relativeScale+o.y,relativeScale:l,absoluteScale:o.absoluteScale*l}}function De(t){return!!t?.shadowRoot}function Ye(t,e){let r=t[e[0]];return e.length===1?r:Ye(r.cssRules[e[1]].cssRules,e.slice(2))}function $t(t){let e=[...t],r=e.pop();return{positions:e,index:r}}function Kn(t){let e=new Set,r=[];for(let n=t.length;n--;){let i=t[n];e.has(i.id)||(r.push(i),e.add(i.id))}return r}var ut=class{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(e){var r;return(r=this.styleIDMap.get(e))!==null&&r!==void 0?r:-1}has(e){return this.styleIDMap.has(e)}add(e,r){if(this.has(e))return this.getId(e);let n;return r===void 0?n=this.id++:n=r,this.styleIDMap.set(e,n),this.idStyleMap.set(n,e),n}getStyle(e){return this.idStyleMap.get(e)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}};function Br(t){var e,r;let n=null;return((r=(e=t.getRootNode)===null||e===void 0?void 0:e.call(t))===null||r===void 0?void 0:r.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&t.getRootNode().host&&(n=t.getRootNode().host),n}function jn(t){let e=t,r;for(;r=Br(e);)e=r;return e}function Jn(t){let e=t.ownerDocument;if(!e)return!1;let r=jn(t);return e.contains(r)}function Pr(t){let e=t.ownerDocument;return e?e.contains(t)||Jn(t):!1}var Ds=Object.freeze({__proto__:null,on:ce,get _mirror(){return re.mirror},throttle:Xe,hookSetter:ft,patch:Be,get nowTimestamp(){return ct},getWindowScroll:Mr,getWindowHeight:kr,getWindowWidth:Dr,isBlocked:ue,isSerialized:zn,isIgnored:It,isAncestorRemoved:Or,legacy_isTouchEvent:Tt,polyfill:xr,queueToResolveTrees:Yn,iterateResolveTree:Lr,isSerializedIframe:Je,isSerializedStylesheet:Fr,getBaseDimension:_r,hasShadowRoot:De,getNestedRule:Ye,getPositionsAndIndex:$t,uniqueTextMutations:Kn,StyleSheetMirror:ut,getShadowHost:Br,getRootShadowHost:jn,shadowHostInDom:Jn,inDom:Pr}),M=(t=>(t[t.DomContentLoaded=0]="DomContentLoaded",t[t.Load=1]="Load",t[t.FullSnapshot=2]="FullSnapshot",t[t.IncrementalSnapshot=3]="IncrementalSnapshot",t[t.Meta=4]="Meta",t[t.Custom=5]="Custom",t[t.Plugin=6]="Plugin",t))(M||{}),A=(t=>(t[t.Mutation=0]="Mutation",t[t.MouseMove=1]="MouseMove",t[t.MouseInteraction=2]="MouseInteraction",t[t.Scroll=3]="Scroll",t[t.ViewportResize=4]="ViewportResize",t[t.Input=5]="Input",t[t.TouchMove=6]="TouchMove",t[t.MediaInteraction=7]="MediaInteraction",t[t.StyleSheetRule=8]="StyleSheetRule",t[t.CanvasMutation=9]="CanvasMutation",t[t.Font=10]="Font",t[t.Log=11]="Log",t[t.Drag=12]="Drag",t[t.StyleDeclaration=13]="StyleDeclaration",t[t.Selection=14]="Selection",t[t.AdoptedStyleSheet=15]="AdoptedStyleSheet",t))(A||{}),V=(t=>(t[t.MouseUp=0]="MouseUp",t[t.MouseDown=1]="MouseDown",t[t.Click=2]="Click",t[t.ContextMenu=3]="ContextMenu",t[t.DblClick=4]="DblClick",t[t.Focus=5]="Focus",t[t.Blur=6]="Blur",t[t.TouchStart=7]="TouchStart",t[t.TouchMove_Departed=8]="TouchMove_Departed",t[t.TouchEnd=9]="TouchEnd",t[t.TouchCancel=10]="TouchCancel",t))(V||{}),Ne=(t=>(t[t.Mouse=0]="Mouse",t[t.Pen=1]="Pen",t[t.Touch=2]="Touch",t))(Ne||{}),Re=(t=>(t[t["2D"]=0]="2D",t[t.WebGL=1]="WebGL",t[t.WebGL2=2]="WebGL2",t))(Re||{}),Z=(t=>(t.Start="start",t.Pause="pause",t.Resume="resume",t.Resize="resize",t.Finish="finish",t.FullsnapshotRebuilded="fullsnapshot-rebuilded",t.LoadStylesheetStart="load-stylesheet-start",t.LoadStylesheetEnd="load-stylesheet-end",t.SkipStart="skip-start",t.SkipEnd="skip-end",t.MouseInteraction="mouse-interaction",t.EventCast="event-cast",t.CustomEvent="custom-event",t.Flush="flush",t.StateChange="state-change",t.PlayBack="play-back",t.Destroy="destroy",t))(Z||{});function hn(t){return"__ln"in t}var er=class{constructor(){this.length=0,this.head=null,this.tail=null}get(e){if(e>=this.length)throw new Error("Position outside of list range");let r=this.head;for(let n=0;n<e;n++)r=r?.next||null;return r}addNode(e){let r={value:e,previous:null,next:null};if(e.__ln=r,e.previousSibling&&hn(e.previousSibling)){let n=e.previousSibling.__ln.next;r.next=n,r.previous=e.previousSibling.__ln,e.previousSibling.__ln.next=r,n&&(n.previous=r)}else if(e.nextSibling&&hn(e.nextSibling)&&e.nextSibling.__ln.previous){let n=e.nextSibling.__ln.previous;r.previous=n,r.next=e.nextSibling.__ln,e.nextSibling.__ln.previous=r,n&&(n.next=r)}else this.head&&(this.head.previous=r),r.next=this.head,this.head=r;r.next===null&&(this.tail=r),this.length++}removeNode(e){let r=e.__ln;this.head&&(r.previous?(r.previous.next=r.next,r.next?r.next.previous=r.previous:this.tail=r.previous):(this.head=r.next,this.head?this.head.previous=null:this.tail=null),e.__ln&&delete e.__ln,this.length--)}},fn=(t,e)=>`${t}@${e}`,tr=class{constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=e=>{e.forEach(this.processMutation),this.emit()},this.emit=()=>{if(this.frozen||this.locked)return;let e=[],r=new Set,n=new er,i=a=>{let c=a,u=lt;for(;u===lt;)c=c&&c.nextSibling,u=c&&this.mirror.getId(c);return u},s=a=>{if(!a.parentNode||!Pr(a))return;let c=it(a.parentNode)?this.mirror.getId(Br(a)):this.mirror.getId(a.parentNode),u=i(a);if(c===-1||u===-1)return n.addNode(a);let d=ze(a,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskTextClass:this.maskTextClass,maskTextSelector:this.maskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:h=>{Je(h,this.mirror)&&this.iframeManager.addIframe(h),Fr(h,this.mirror)&&this.stylesheetManager.trackLinkElement(h),De(a)&&this.shadowDomManager.addShadowRoot(a.shadowRoot,this.doc)},onIframeLoad:(h,f)=>{this.iframeManager.attachIframe(h,f),this.shadowDomManager.observeAttachShadow(h)},onStylesheetLoad:(h,f)=>{this.stylesheetManager.attachLinkElement(h,f)}});d&&(e.push({parentId:c,nextId:u,node:d}),r.add(d.id))};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(let a of this.movedSet)pn(this.removes,a,this.mirror)&&!this.movedSet.has(a.parentNode)||s(a);for(let a of this.addedSet)!mn(this.droppedSet,a)&&!pn(this.removes,a,this.mirror)||mn(this.movedSet,a)?s(a):this.droppedSet.add(a);let o=null;for(;n.length;){let a=null;if(o){let c=this.mirror.getId(o.value.parentNode),u=i(o.value);c!==-1&&u!==-1&&(a=o)}if(!a){let c=n.tail;for(;c;){let u=c;if(c=c.previous,u){let d=this.mirror.getId(u.value.parentNode);if(i(u.value)===-1)continue;if(d!==-1){a=u;break}else{let f=u.value;if(f.parentNode&&f.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){let p=f.parentNode.host;if(this.mirror.getId(p)!==-1){a=u;break}}}}}}if(!a){for(;n.head;)n.removeNode(n.head.value);break}o=a.previous,n.removeNode(a.value),s(a.value)}let l={texts:this.texts.map(a=>({id:this.mirror.getId(a.node),value:a.value})).filter(a=>!r.has(a.id)).filter(a=>this.mirror.has(a.id)),attributes:this.attributes.map(a=>{let{attributes:c}=a;if(typeof c.style=="string"){let u=JSON.stringify(a.styleDiff),d=JSON.stringify(a._unchangedStyles);u.length<c.style.length&&(u+d).split("var(").length===c.style.split("var(").length&&(c.style=a.styleDiff)}return{id:this.mirror.getId(a.node),attributes:c}}).filter(a=>!r.has(a.id)).filter(a=>this.mirror.has(a.id)),removes:this.removes,adds:e};!l.texts.length&&!l.attributes.length&&!l.removes.length&&!l.adds.length||(this.texts=[],this.attributes=[],this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(l))},this.processMutation=e=>{if(It(e.target,this.mirror))return;let r;try{r=document.implementation.createHTMLDocument()}catch{r=this.doc}switch(e.type){case"characterData":{let n=e.target.textContent;!ue(e.target,this.blockClass,this.blockSelector,!1)&&n!==e.oldValue&&this.texts.push({value:Hn(e.target,this.maskTextClass,this.maskTextSelector)&&n?this.maskTextFn?this.maskTextFn(n):n.replace(/[\S]/g,"*"):n,node:e.target});break}case"attributes":{let n=e.target,i=e.attributeName,s=e.target.getAttribute(i);if(i==="value"){let l=Tr(n);s=Nr({element:n,maskInputOptions:this.maskInputOptions,tagName:n.tagName,type:l,value:s,maskInputFn:this.maskInputFn})}if(ue(e.target,this.blockClass,this.blockSelector,!1)||s===e.oldValue)return;let o=this.attributes.find(l=>l.node===e.target);if(n.tagName==="IFRAME"&&i==="src"&&!this.keepIframeSrcFn(s))if(!n.contentDocument)i="rr_src";else return;if(o||(o={node:e.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(o)),i==="type"&&n.tagName==="INPUT"&&(e.oldValue||"").toLowerCase()==="password"&&n.setAttribute("data-rr-is-password","true"),!Gn(n.tagName,i)&&(o.attributes[i]=Vn(this.doc,xe(n.tagName),xe(i),s),i==="style")){let l=r.createElement("span");e.oldValue&&l.setAttribute("style",e.oldValue);for(let a of Array.from(n.style)){let c=n.style.getPropertyValue(a),u=n.style.getPropertyPriority(a);c!==l.style.getPropertyValue(a)||u!==l.style.getPropertyPriority(a)?u===""?o.styleDiff[a]=c:o.styleDiff[a]=[c,u]:o._unchangedStyles[a]=[c,u]}for(let a of Array.from(l.style))n.style.getPropertyValue(a)===""&&(o.styleDiff[a]=!1)}break}case"childList":{if(ue(e.target,this.blockClass,this.blockSelector,!0))return;e.addedNodes.forEach(n=>this.genAdds(n,e.target)),e.removedNodes.forEach(n=>{let i=this.mirror.getId(n),s=it(e.target)?this.mirror.getId(e.target.host):this.mirror.getId(e.target);ue(e.target,this.blockClass,this.blockSelector,!1)||It(n,this.mirror)||!zn(n,this.mirror)||(this.addedSet.has(n)?(rr(this.addedSet,n),this.droppedSet.add(n)):this.addedSet.has(e.target)&&i===-1||Or(e.target,this.mirror)||(this.movedSet.has(n)&&this.movedMap[fn(i,s)]?rr(this.movedSet,n):this.removes.push({parentId:s,id:i,isShadow:it(e.target)&&st(e.target)?!0:void 0})),this.mapRemoves.push(n))});break}}},this.genAdds=(e,r)=>{if(!this.processedNodeManager.inOtherBuffer(e,this)&&!(this.addedSet.has(e)||this.movedSet.has(e))){if(this.mirror.hasNode(e)){if(It(e,this.mirror))return;this.movedSet.add(e);let n=null;r&&this.mirror.hasNode(r)&&(n=this.mirror.getId(r)),n&&n!==-1&&(this.movedMap[fn(this.mirror.getId(e),n)]=!0)}else this.addedSet.add(e),this.droppedSet.delete(e);ue(e,this.blockClass,this.blockSelector,!1)||(e.childNodes.forEach(n=>this.genAdds(n)),De(e)&&e.shadowRoot.childNodes.forEach(n=>{this.processedNodeManager.add(n,this),this.genAdds(n,e)}))}}}init(e){["mutationCb","blockClass","blockSelector","maskTextClass","maskTextSelector","inlineStylesheet","maskInputOptions","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach(r=>{this[r]=e[r]})}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}};function rr(t,e){t.delete(e),e.childNodes.forEach(r=>rr(t,r))}function pn(t,e,r){return t.length===0?!1:Xn(t,e,r)}function Xn(t,e,r){let{parentNode:n}=e;if(!n)return!1;let i=r.getId(n);return t.some(s=>s.id===i)?!0:Xn(t,n,r)}function mn(t,e){return t.size===0?!1:Qn(t,e)}function Qn(t,e){let{parentNode:r}=e;return r?t.has(r)?!0:Qn(t,r):!1}var at;function Os(t){at=t}function xs(){at=void 0}var P=t=>at?(...r)=>{try{return t(...r)}catch(n){if(at&&at(n)===!0)return;throw n}}:t,Fe=[];function pt(t){try{if("composedPath"in t){let e=t.composedPath();if(e.length)return e[0]}else if("path"in t&&t.path.length)return t.path[0]}catch{}return t&&t.target}function qn(t,e){var r,n;let i=new tr;Fe.push(i),i.init(t);let s=window.MutationObserver||window.__rrMutationObserver,o=(n=(r=window?.Zone)===null||r===void 0?void 0:r.__symbol__)===null||n===void 0?void 0:n.call(r,"MutationObserver");o&&window[o]&&(s=window[o]);let l=new s(P(i.processMutations.bind(i)));return l.observe(e,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),l}function Ls({mousemoveCb:t,sampling:e,doc:r,mirror:n}){if(e.mousemove===!1)return()=>{};let i=typeof e.mousemove=="number"?e.mousemove:50,s=typeof e.mousemoveCallback=="number"?e.mousemoveCallback:500,o=[],l,a=Xe(P(d=>{let h=Date.now()-l;t(o.map(f=>(f.timeOffset-=h,f)),d),o=[],l=null}),s),c=P(Xe(P(d=>{let h=pt(d),{clientX:f,clientY:p}=Tt(d)?d.changedTouches[0]:d;l||(l=ct()),o.push({x:f,y:p,id:n.getId(h),timeOffset:ct()-l}),a(typeof DragEvent<"u"&&d instanceof DragEvent?A.Drag:d instanceof MouseEvent?A.MouseMove:A.TouchMove)}),i,{trailing:!1})),u=[ce("mousemove",c,r),ce("touchmove",c,r),ce("drag",c,r)];return P(()=>{u.forEach(d=>d())})}function Fs({mouseInteractionCb:t,doc:e,mirror:r,blockClass:n,blockSelector:i,sampling:s}){if(s.mouseInteraction===!1)return()=>{};let o=s.mouseInteraction===!0||s.mouseInteraction===void 0?{}:s.mouseInteraction,l=[],a=null,c=u=>d=>{let h=pt(d);if(ue(h,n,i,!0))return;let f=null,p=u;if("pointerType"in d){switch(d.pointerType){case"mouse":f=Ne.Mouse;break;case"touch":f=Ne.Touch;break;case"pen":f=Ne.Pen;break}f===Ne.Touch?V[u]===V.MouseDown?p="TouchStart":V[u]===V.MouseUp&&(p="TouchEnd"):Ne.Pen}else Tt(d)&&(f=Ne.Touch);f!==null?(a=f,(p.startsWith("Touch")&&f===Ne.Touch||p.startsWith("Mouse")&&f===Ne.Mouse)&&(f=null)):V[u]===V.Click&&(f=a,a=null);let m=Tt(d)?d.changedTouches[0]:d;if(!m)return;let I=r.getId(h),{clientX:y,clientY:v}=m;P(t)(Object.assign({type:V[p],id:I,x:y,y:v},f!==null&&{pointerType:f}))};return Object.keys(V).filter(u=>Number.isNaN(Number(u))&&!u.endsWith("_Departed")&&o[u]!==!1).forEach(u=>{let d=xe(u),h=c(u);if(window.PointerEvent)switch(V[u]){case V.MouseDown:case V.MouseUp:d=d.replace("mouse","pointer");break;case V.TouchStart:case V.TouchEnd:return}l.push(ce(d,h,e))}),P(()=>{l.forEach(u=>u())})}function $n({scrollCb:t,doc:e,mirror:r,blockClass:n,blockSelector:i,sampling:s}){let o=P(Xe(P(l=>{let a=pt(l);if(!a||ue(a,n,i,!0))return;let c=r.getId(a);if(a===e&&e.defaultView){let u=Mr(e.defaultView);t({id:c,x:u.left,y:u.top})}else t({id:c,x:a.scrollLeft,y:a.scrollTop})}),s.scroll||100));return ce("scroll",o,e)}function _s({viewportResizeCb:t},{win:e}){let r=-1,n=-1,i=P(Xe(P(()=>{let s=kr(),o=Dr();(r!==s||n!==o)&&(t({width:Number(o),height:Number(s)}),r=s,n=o)}),200));return ce("resize",i,e)}function gn(t,e){let r=Object.assign({},t);return e||delete r.userTriggered,r}var Bs=["INPUT","TEXTAREA","SELECT"],vn=new WeakMap;function Ps({inputCb:t,doc:e,mirror:r,blockClass:n,blockSelector:i,ignoreClass:s,ignoreSelector:o,maskInputOptions:l,maskInputFn:a,sampling:c,userTriggeredOnInput:u}){function d(v){let g=pt(v),b=v.isTrusted,E=g&&g.tagName;if(g&&E==="OPTION"&&(g=g.parentElement),!g||!E||Bs.indexOf(E)<0||ue(g,n,i,!0)||g.classList.contains(s)||o&&g.matches(o))return;let T=g.value,D=!1,w=Tr(g)||"";w==="radio"||w==="checkbox"?D=g.checked:(l[E.toLowerCase()]||l[w])&&(T=Nr({element:g,maskInputOptions:l,tagName:E,type:w,value:T,maskInputFn:a})),h(g,P(gn)({text:T,isChecked:D,userTriggered:b},u));let j=g.name;w==="radio"&&j&&D&&e.querySelectorAll(`input[type="radio"][name="${j}"]`).forEach(_=>{_!==g&&h(_,P(gn)({text:_.value,isChecked:!D,userTriggered:!1},u))})}function h(v,g){let b=vn.get(v);if(!b||b.text!==g.text||b.isChecked!==g.isChecked){vn.set(v,g);let E=r.getId(v);P(t)(Object.assign(Object.assign({},g),{id:E}))}}let p=(c.input==="last"?["change"]:["input","change"]).map(v=>ce(v,P(d),e)),m=e.defaultView;if(!m)return()=>{p.forEach(v=>v())};let I=m.Object.getOwnPropertyDescriptor(m.HTMLInputElement.prototype,"value"),y=[[m.HTMLInputElement.prototype,"value"],[m.HTMLInputElement.prototype,"checked"],[m.HTMLSelectElement.prototype,"value"],[m.HTMLTextAreaElement.prototype,"value"],[m.HTMLSelectElement.prototype,"selectedIndex"],[m.HTMLOptionElement.prototype,"selected"]];return I&&I.set&&p.push(...y.map(v=>ft(v[0],v[1],{set(){P(d)({target:this,isTrusted:!1})}},!1,m))),P(()=>{p.forEach(v=>v())})}function Rt(t){let e=[];function r(n,i){if(vt("CSSGroupingRule")&&n.parentRule instanceof CSSGroupingRule||vt("CSSMediaRule")&&n.parentRule instanceof CSSMediaRule||vt("CSSSupportsRule")&&n.parentRule instanceof CSSSupportsRule||vt("CSSConditionRule")&&n.parentRule instanceof CSSConditionRule){let o=Array.from(n.parentRule.cssRules).indexOf(n);i.unshift(o)}else if(n.parentStyleSheet){let o=Array.from(n.parentStyleSheet.cssRules).indexOf(n);i.unshift(o)}return i}return r(t,e)}function Me(t,e,r){let n,i;return t?(t.ownerNode?n=e.getId(t.ownerNode):i=r.getId(t),{styleId:i,id:n}):{}}function Ws({styleSheetRuleCb:t,mirror:e,stylesheetManager:r},{win:n}){if(!n.CSSStyleSheet||!n.CSSStyleSheet.prototype)return()=>{};let i=n.CSSStyleSheet.prototype.insertRule;n.CSSStyleSheet.prototype.insertRule=new Proxy(i,{apply:P((u,d,h)=>{let[f,p]=h,{id:m,styleId:I}=Me(d,e,r.styleMirror);return(m&&m!==-1||I&&I!==-1)&&t({id:m,styleId:I,adds:[{rule:f,index:p}]}),u.apply(d,h)})});let s=n.CSSStyleSheet.prototype.deleteRule;n.CSSStyleSheet.prototype.deleteRule=new Proxy(s,{apply:P((u,d,h)=>{let[f]=h,{id:p,styleId:m}=Me(d,e,r.styleMirror);return(p&&p!==-1||m&&m!==-1)&&t({id:p,styleId:m,removes:[{index:f}]}),u.apply(d,h)})});let o;n.CSSStyleSheet.prototype.replace&&(o=n.CSSStyleSheet.prototype.replace,n.CSSStyleSheet.prototype.replace=new Proxy(o,{apply:P((u,d,h)=>{let[f]=h,{id:p,styleId:m}=Me(d,e,r.styleMirror);return(p&&p!==-1||m&&m!==-1)&&t({id:p,styleId:m,replace:f}),u.apply(d,h)})}));let l;n.CSSStyleSheet.prototype.replaceSync&&(l=n.CSSStyleSheet.prototype.replaceSync,n.CSSStyleSheet.prototype.replaceSync=new Proxy(l,{apply:P((u,d,h)=>{let[f]=h,{id:p,styleId:m}=Me(d,e,r.styleMirror);return(p&&p!==-1||m&&m!==-1)&&t({id:p,styleId:m,replaceSync:f}),u.apply(d,h)})}));let a={};yt("CSSGroupingRule")?a.CSSGroupingRule=n.CSSGroupingRule:(yt("CSSMediaRule")&&(a.CSSMediaRule=n.CSSMediaRule),yt("CSSConditionRule")&&(a.CSSConditionRule=n.CSSConditionRule),yt("CSSSupportsRule")&&(a.CSSSupportsRule=n.CSSSupportsRule));let c={};return Object.entries(a).forEach(([u,d])=>{c[u]={insertRule:d.prototype.insertRule,deleteRule:d.prototype.deleteRule},d.prototype.insertRule=new Proxy(c[u].insertRule,{apply:P((h,f,p)=>{let[m,I]=p,{id:y,styleId:v}=Me(f.parentStyleSheet,e,r.styleMirror);return(y&&y!==-1||v&&v!==-1)&&t({id:y,styleId:v,adds:[{rule:m,index:[...Rt(f),I||0]}]}),h.apply(f,p)})}),d.prototype.deleteRule=new Proxy(c[u].deleteRule,{apply:P((h,f,p)=>{let[m]=p,{id:I,styleId:y}=Me(f.parentStyleSheet,e,r.styleMirror);return(I&&I!==-1||y&&y!==-1)&&t({id:I,styleId:y,removes:[{index:[...Rt(f),m]}]}),h.apply(f,p)})})}),P(()=>{n.CSSStyleSheet.prototype.insertRule=i,n.CSSStyleSheet.prototype.deleteRule=s,o&&(n.CSSStyleSheet.prototype.replace=o),l&&(n.CSSStyleSheet.prototype.replaceSync=l),Object.entries(a).forEach(([u,d])=>{d.prototype.insertRule=c[u].insertRule,d.prototype.deleteRule=c[u].deleteRule})})}function ei({mirror:t,stylesheetManager:e},r){var n,i,s;let o=null;r.nodeName==="#document"?o=t.getId(r):o=t.getId(r.host);let l=r.nodeName==="#document"?(n=r.defaultView)===null||n===void 0?void 0:n.Document:(s=(i=r.ownerDocument)===null||i===void 0?void 0:i.defaultView)===null||s===void 0?void 0:s.ShadowRoot,a=Object.getOwnPropertyDescriptor(l?.prototype,"adoptedStyleSheets");return o===null||o===-1||!l||!a?()=>{}:(Object.defineProperty(r,"adoptedStyleSheets",{configurable:a.configurable,enumerable:a.enumerable,get(){var c;return(c=a.get)===null||c===void 0?void 0:c.call(this)},set(c){var u;let d=(u=a.set)===null||u===void 0?void 0:u.call(this,c);if(o!==null&&o!==-1)try{e.adoptStyleSheets(c,o)}catch{}return d}}),P(()=>{Object.defineProperty(r,"adoptedStyleSheets",{configurable:a.configurable,enumerable:a.enumerable,get:a.get,set:a.set})}))}function Us({styleDeclarationCb:t,mirror:e,ignoreCSSAttributes:r,stylesheetManager:n},{win:i}){let s=i.CSSStyleDeclaration.prototype.setProperty;i.CSSStyleDeclaration.prototype.setProperty=new Proxy(s,{apply:P((l,a,c)=>{var u;let[d,h,f]=c;if(r.has(d))return s.apply(a,[d,h,f]);let{id:p,styleId:m}=Me((u=a.parentRule)===null||u===void 0?void 0:u.parentStyleSheet,e,n.styleMirror);return(p&&p!==-1||m&&m!==-1)&&t({id:p,styleId:m,set:{property:d,value:h,priority:f},index:Rt(a.parentRule)}),l.apply(a,c)})});let o=i.CSSStyleDeclaration.prototype.removeProperty;return i.CSSStyleDeclaration.prototype.removeProperty=new Proxy(o,{apply:P((l,a,c)=>{var u;let[d]=c;if(r.has(d))return o.apply(a,[d]);let{id:h,styleId:f}=Me((u=a.parentRule)===null||u===void 0?void 0:u.parentStyleSheet,e,n.styleMirror);return(h&&h!==-1||f&&f!==-1)&&t({id:h,styleId:f,remove:{property:d},index:Rt(a.parentRule)}),l.apply(a,c)})}),P(()=>{i.CSSStyleDeclaration.prototype.setProperty=s,i.CSSStyleDeclaration.prototype.removeProperty=o})}function Vs({mediaInteractionCb:t,blockClass:e,blockSelector:r,mirror:n,sampling:i,doc:s}){let o=P(a=>Xe(P(c=>{let u=pt(c);if(!u||ue(u,e,r,!0))return;let{currentTime:d,volume:h,muted:f,playbackRate:p}=u;t({type:a,id:n.getId(u),currentTime:d,volume:h,muted:f,playbackRate:p})}),i.media||500)),l=[ce("play",o(0),s),ce("pause",o(1),s),ce("seeked",o(2),s),ce("volumechange",o(3),s),ce("ratechange",o(4),s)];return P(()=>{l.forEach(a=>a())})}function Gs({fontCb:t,doc:e}){let r=e.defaultView;if(!r)return()=>{};let n=[],i=new WeakMap,s=r.FontFace;r.FontFace=function(a,c,u){let d=new s(a,c,u);return i.set(d,{family:a,buffer:typeof c!="string",descriptors:u,fontSource:typeof c=="string"?c:JSON.stringify(Array.from(new Uint8Array(c)))}),d};let o=Be(e.fonts,"add",function(l){return function(a){return setTimeout(P(()=>{let c=i.get(a);c&&(t(c),i.delete(a))}),0),l.apply(this,[a])}});return n.push(()=>{r.FontFace=s}),n.push(o),P(()=>{n.forEach(l=>l())})}function Hs(t){let{doc:e,mirror:r,blockClass:n,blockSelector:i,selectionCb:s}=t,o=!0,l=P(()=>{let a=e.getSelection();if(!a||o&&a?.isCollapsed)return;o=a.isCollapsed||!1;let c=[],u=a.rangeCount||0;for(let d=0;d<u;d++){let h=a.getRangeAt(d),{startContainer:f,startOffset:p,endContainer:m,endOffset:I}=h;ue(f,n,i,!0)||ue(m,n,i,!0)||c.push({start:r.getId(f),startOffset:p,end:r.getId(m),endOffset:I})}s({ranges:c})});return l(),ce("selectionchange",l)}function Zs(t,e){let{mutationCb:r,mousemoveCb:n,mouseInteractionCb:i,scrollCb:s,viewportResizeCb:o,inputCb:l,mediaInteractionCb:a,styleSheetRuleCb:c,styleDeclarationCb:u,canvasMutationCb:d,fontCb:h,selectionCb:f}=t;t.mutationCb=(...p)=>{e.mutation&&e.mutation(...p),r(...p)},t.mousemoveCb=(...p)=>{e.mousemove&&e.mousemove(...p),n(...p)},t.mouseInteractionCb=(...p)=>{e.mouseInteraction&&e.mouseInteraction(...p),i(...p)},t.scrollCb=(...p)=>{e.scroll&&e.scroll(...p),s(...p)},t.viewportResizeCb=(...p)=>{e.viewportResize&&e.viewportResize(...p),o(...p)},t.inputCb=(...p)=>{e.input&&e.input(...p),l(...p)},t.mediaInteractionCb=(...p)=>{e.mediaInteaction&&e.mediaInteaction(...p),a(...p)},t.styleSheetRuleCb=(...p)=>{e.styleSheetRule&&e.styleSheetRule(...p),c(...p)},t.styleDeclarationCb=(...p)=>{e.styleDeclaration&&e.styleDeclaration(...p),u(...p)},t.canvasMutationCb=(...p)=>{e.canvasMutation&&e.canvasMutation(...p),d(...p)},t.fontCb=(...p)=>{e.font&&e.font(...p),h(...p)},t.selectionCb=(...p)=>{e.selection&&e.selection(...p),f(...p)}}function zs(t,e={}){let r=t.doc.defaultView;if(!r)return()=>{};Zs(t,e);let n=qn(t,t.doc),i=Ls(t),s=Fs(t),o=$n(t),l=_s(t,{win:r}),a=Ps(t),c=Vs(t),u=Ws(t,{win:r}),d=ei(t,t.doc),h=Us(t,{win:r}),f=t.collectFonts?Gs(t):()=>{},p=Hs(t),m=[];for(let I of t.plugins)m.push(I.observer(I.callback,r,I.options));return P(()=>{Fe.forEach(I=>I.reset()),n.disconnect(),i(),s(),o(),l(),a(),c(),u(),d(),h(),f(),p(),m.forEach(I=>I())})}function vt(t){return typeof window[t]<"u"}function yt(t){return!!(typeof window[t]<"u"&&window[t].prototype&&"insertRule"in window[t].prototype&&"deleteRule"in window[t].prototype)}var Mt=class{constructor(e){this.generateIdFn=e,this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap}getId(e,r,n,i){let s=n||this.getIdToRemoteIdMap(e),o=i||this.getRemoteIdToIdMap(e),l=s.get(r);return l||(l=this.generateIdFn(),s.set(r,l),o.set(l,r)),l}getIds(e,r){let n=this.getIdToRemoteIdMap(e),i=this.getRemoteIdToIdMap(e);return r.map(s=>this.getId(e,s,n,i))}getRemoteId(e,r,n){let i=n||this.getRemoteIdToIdMap(e);if(typeof r!="number")return r;let s=i.get(r);return s||-1}getRemoteIds(e,r){let n=this.getRemoteIdToIdMap(e);return r.map(i=>this.getRemoteId(e,i,n))}reset(e){if(!e){this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap;return}this.iframeIdToRemoteIdMap.delete(e),this.iframeRemoteIdToIdMap.delete(e)}getIdToRemoteIdMap(e){let r=this.iframeIdToRemoteIdMap.get(e);return r||(r=new Map,this.iframeIdToRemoteIdMap.set(e,r)),r}getRemoteIdToIdMap(e){let r=this.iframeRemoteIdToIdMap.get(e);return r||(r=new Map,this.iframeRemoteIdToIdMap.set(e,r)),r}},nr=class{constructor(e){this.iframes=new WeakMap,this.crossOriginIframeMap=new WeakMap,this.crossOriginIframeMirror=new Mt(Un),this.crossOriginIframeRootIdMap=new WeakMap,this.mutationCb=e.mutationCb,this.wrappedEmit=e.wrappedEmit,this.stylesheetManager=e.stylesheetManager,this.recordCrossOriginIframes=e.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new Mt(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=e.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(e){this.iframes.set(e,!0),e.contentWindow&&this.crossOriginIframeMap.set(e.contentWindow,e)}addLoadListener(e){this.loadListener=e}attachIframe(e,r){var n;this.mutationCb({adds:[{parentId:this.mirror.getId(e),nextId:null,node:r}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),(n=this.loadListener)===null||n===void 0||n.call(this,e),e.contentDocument&&e.contentDocument.adoptedStyleSheets&&e.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(e.contentDocument.adoptedStyleSheets,this.mirror.getId(e.contentDocument))}handleMessage(e){let r=e;if(r.data.type!=="rrweb"||r.origin!==r.data.origin||!e.source)return;let i=this.crossOriginIframeMap.get(e.source);if(!i)return;let s=this.transformCrossOriginEvent(i,r.data.event);s&&this.wrappedEmit(s,r.data.isCheckout)}transformCrossOriginEvent(e,r){var n;switch(r.type){case M.FullSnapshot:{this.crossOriginIframeMirror.reset(e),this.crossOriginIframeStyleMirror.reset(e),this.replaceIdOnNode(r.data.node,e);let i=r.data.node.id;return this.crossOriginIframeRootIdMap.set(e,i),this.patchRootIdOnNode(r.data.node,i),{timestamp:r.timestamp,type:M.IncrementalSnapshot,data:{source:A.Mutation,adds:[{parentId:this.mirror.getId(e),nextId:null,node:r.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}}}case M.Meta:case M.Load:case M.DomContentLoaded:return!1;case M.Plugin:return r;case M.Custom:return this.replaceIds(r.data.payload,e,["id","parentId","previousId","nextId"]),r;case M.IncrementalSnapshot:switch(r.data.source){case A.Mutation:return r.data.adds.forEach(i=>{this.replaceIds(i,e,["parentId","nextId","previousId"]),this.replaceIdOnNode(i.node,e);let s=this.crossOriginIframeRootIdMap.get(e);s&&this.patchRootIdOnNode(i.node,s)}),r.data.removes.forEach(i=>{this.replaceIds(i,e,["parentId","id"])}),r.data.attributes.forEach(i=>{this.replaceIds(i,e,["id"])}),r.data.texts.forEach(i=>{this.replaceIds(i,e,["id"])}),r;case A.Drag:case A.TouchMove:case A.MouseMove:return r.data.positions.forEach(i=>{this.replaceIds(i,e,["id"])}),r;case A.ViewportResize:return!1;case A.MediaInteraction:case A.MouseInteraction:case A.Scroll:case A.CanvasMutation:case A.Input:return this.replaceIds(r.data,e,["id"]),r;case A.StyleSheetRule:case A.StyleDeclaration:return this.replaceIds(r.data,e,["id"]),this.replaceStyleIds(r.data,e,["styleId"]),r;case A.Font:return r;case A.Selection:return r.data.ranges.forEach(i=>{this.replaceIds(i,e,["start","end"])}),r;case A.AdoptedStyleSheet:return this.replaceIds(r.data,e,["id"]),this.replaceStyleIds(r.data,e,["styleIds"]),(n=r.data.styles)===null||n===void 0||n.forEach(i=>{this.replaceStyleIds(i,e,["styleId"])}),r}}}replace(e,r,n,i){for(let s of i)!Array.isArray(r[s])&&typeof r[s]!="number"||(Array.isArray(r[s])?r[s]=e.getIds(n,r[s]):r[s]=e.getId(n,r[s]));return r}replaceIds(e,r,n){return this.replace(this.crossOriginIframeMirror,e,r,n)}replaceStyleIds(e,r,n){return this.replace(this.crossOriginIframeStyleMirror,e,r,n)}replaceIdOnNode(e,r){this.replaceIds(e,r,["id","rootId"]),"childNodes"in e&&e.childNodes.forEach(n=>{this.replaceIdOnNode(n,r)})}patchRootIdOnNode(e,r){e.type!==x.Document&&!e.rootId&&(e.rootId=r),"childNodes"in e&&e.childNodes.forEach(n=>{this.patchRootIdOnNode(n,r)})}},ir=class{constructor(e){this.shadowDoms=new WeakSet,this.restoreHandlers=[],this.mutationCb=e.mutationCb,this.scrollCb=e.scrollCb,this.bypassOptions=e.bypassOptions,this.mirror=e.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(e,r){if(!st(e)||this.shadowDoms.has(e))return;this.shadowDoms.add(e);let n=qn(Object.assign(Object.assign({},this.bypassOptions),{doc:r,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),e);this.restoreHandlers.push(()=>n.disconnect()),this.restoreHandlers.push($n(Object.assign(Object.assign({},this.bypassOptions),{scrollCb:this.scrollCb,doc:e,mirror:this.mirror}))),setTimeout(()=>{e.adoptedStyleSheets&&e.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(e.adoptedStyleSheets,this.mirror.getId(e.host)),this.restoreHandlers.push(ei({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},e))},0)}observeAttachShadow(e){!e.contentWindow||!e.contentDocument||this.patchAttachShadow(e.contentWindow.Element,e.contentDocument)}patchAttachShadow(e,r){let n=this;this.restoreHandlers.push(Be(e.prototype,"attachShadow",function(i){return function(s){let o=i.call(this,s);return this.shadowRoot&&Pr(this)&&n.addShadowRoot(this.shadowRoot,r),o}}))}reset(){this.restoreHandlers.forEach(e=>{try{e()}catch{}}),this.restoreHandlers=[],this.shadowDoms=new WeakSet}};function Ys(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function Te(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(u){try{c(n.next(u))}catch(d){o(d)}}function a(u){try{c(n.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):i(u.value).then(l,a)}c((n=n.apply(t,e||[])).next())})}var Ke="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",nt=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(et=0;et<Ke.length;et++)nt[Ke.charCodeAt(et)]=et;var et,Ks=function(t){var e=new Uint8Array(t),r,n=e.length,i="";for(r=0;r<n;r+=3)i+=Ke[e[r]>>2],i+=Ke[(e[r]&3)<<4|e[r+1]>>4],i+=Ke[(e[r+1]&15)<<2|e[r+2]>>6],i+=Ke[e[r+2]&63];return n%3===2?i=i.substring(0,i.length-1)+"=":n%3===1&&(i=i.substring(0,i.length-2)+"=="),i},js=function(t){var e=t.length*.75,r=t.length,n,i=0,s,o,l,a;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);var c=new ArrayBuffer(e),u=new Uint8Array(c);for(n=0;n<r;n+=4)s=nt[t.charCodeAt(n)],o=nt[t.charCodeAt(n+1)],l=nt[t.charCodeAt(n+2)],a=nt[t.charCodeAt(n+3)],u[i++]=s<<2|o>>4,u[i++]=(o&15)<<4|l>>2,u[i++]=(l&3)<<6|a&63;return c},yn=new Map;function Js(t,e){let r=yn.get(t);return r||(r=new Map,yn.set(t,r)),r.has(e)||r.set(e,[]),r.get(e)}var ti=(t,e,r)=>{if(!t||!(ni(t,e)||typeof t=="object"))return;let n=t.constructor.name,i=Js(r,n),s=i.indexOf(t);return s===-1&&(s=i.length,i.push(t)),s};function St(t,e,r){if(t instanceof Array)return t.map(n=>St(n,e,r));if(t===null)return t;if(t instanceof Float32Array||t instanceof Float64Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Int16Array||t instanceof Int8Array||t instanceof Uint8ClampedArray)return{rr_type:t.constructor.name,args:[Object.values(t)]};if(t instanceof ArrayBuffer){let n=t.constructor.name,i=Ks(t);return{rr_type:n,base64:i}}else{if(t instanceof DataView)return{rr_type:t.constructor.name,args:[St(t.buffer,e,r),t.byteOffset,t.byteLength]};if(t instanceof HTMLImageElement){let n=t.constructor.name,{src:i}=t;return{rr_type:n,src:i}}else if(t instanceof HTMLCanvasElement){let n="HTMLImageElement",i=t.toDataURL();return{rr_type:n,src:i}}else{if(t instanceof ImageData)return{rr_type:t.constructor.name,args:[St(t.data,e,r),t.width,t.height]};if(ni(t,e)||typeof t=="object"){let n=t.constructor.name,i=ti(t,e,r);return{rr_type:n,index:i}}}}return t}var ri=(t,e,r)=>[...t].map(n=>St(n,e,r)),ni=(t,e)=>!!["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter(i=>typeof e[i]=="function").find(i=>t instanceof e[i]);function Xs(t,e,r,n){let i=[],s=Object.getOwnPropertyNames(e.CanvasRenderingContext2D.prototype);for(let o of s)try{if(typeof e.CanvasRenderingContext2D.prototype[o]!="function")continue;let l=Be(e.CanvasRenderingContext2D.prototype,o,function(a){return function(...c){return ue(this.canvas,r,n,!0)||setTimeout(()=>{let u=ri([...c],e,this);t(this.canvas,{type:Re["2D"],property:o,args:u})},0),a.apply(this,c)}});i.push(l)}catch{let a=ft(e.CanvasRenderingContext2D.prototype,o,{set(c){t(this.canvas,{type:Re["2D"],property:o,args:[c],setter:!0})}});i.push(a)}return()=>{i.forEach(o=>o())}}function Qs(t){return t==="experimental-webgl"?"webgl":t}function Cn(t,e,r,n){let i=[];try{let s=Be(t.HTMLCanvasElement.prototype,"getContext",function(o){return function(l,...a){if(!ue(this,e,r,!0)){let c=Qs(l);if("__context"in this||(this.__context=c),n&&["webgl","webgl2"].includes(c))if(a[0]&&typeof a[0]=="object"){let u=a[0];u.preserveDrawingBuffer||(u.preserveDrawingBuffer=!0)}else a.splice(0,1,{preserveDrawingBuffer:!0})}return o.apply(this,[l,...a])}});i.push(s)}catch{console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{i.forEach(s=>s())}}function In(t,e,r,n,i,s,o){let l=[],a=Object.getOwnPropertyNames(t);for(let c of a)if(!["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(c))try{if(typeof t[c]!="function")continue;let u=Be(t,c,function(d){return function(...h){let f=d.apply(this,h);if(ti(f,o,this),"tagName"in this.canvas&&!ue(this.canvas,n,i,!0)){let p=ri([...h],o,this),m={type:e,property:c,args:p};r(this.canvas,m)}return f}});l.push(u)}catch{let d=ft(t,c,{set(h){r(this.canvas,{type:e,property:c,args:[h],setter:!0})}});l.push(d)}return l}function qs(t,e,r,n,i){let s=[];return s.push(...In(e.WebGLRenderingContext.prototype,Re.WebGL,t,r,n,i,e)),typeof e.WebGL2RenderingContext<"u"&&s.push(...In(e.WebGL2RenderingContext.prototype,Re.WebGL2,t,r,n,i,e)),()=>{s.forEach(o=>o())}}function $s(t,e){var r=atob(t);if(e){for(var n=new Uint8Array(r.length),i=0,s=r.length;i<s;++i)n[i]=r.charCodeAt(i);return String.fromCharCode.apply(null,new Uint16Array(n.buffer))}return r}function eo(t,e,r){var n=e===void 0?null:e,i=r===void 0?!1:r,s=$s(t,i),o=s.indexOf(`
`,10)+1,l=s.substring(o)+(n?"//# sourceMappingURL="+n:""),a=new Blob([l],{type:"application/javascript"});return URL.createObjectURL(a)}function to(t,e,r){var n;return function(s){return n=n||eo(t,e,r),new Worker(n,s)}}var ro=to("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICAgJ3VzZSBzdHJpY3QnOwoKICAgIC8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KICAgIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLg0KDQogICAgUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgYW5kL29yIGRpc3RyaWJ1dGUgdGhpcyBzb2Z0d2FyZSBmb3IgYW55DQogICAgcHVycG9zZSB3aXRoIG9yIHdpdGhvdXQgZmVlIGlzIGhlcmVieSBncmFudGVkLg0KDQogICAgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIgQU5EIFRIRSBBVVRIT1IgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEgNCiAgICBSRUdBUkQgVE8gVEhJUyBTT0ZUV0FSRSBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFkNCiAgICBBTkQgRklUTkVTUy4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUiBCRSBMSUFCTEUgRk9SIEFOWSBTUEVDSUFMLCBESVJFQ1QsDQogICAgSU5ESVJFQ1QsIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NDQogICAgTE9TUyBPRiBVU0UsIERBVEEgT1IgUFJPRklUUywgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1INCiAgICBPVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFSSVNJTkcgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SDQogICAgUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS4NCiAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqLw0KDQogICAgZnVuY3Rpb24gX19hd2FpdGVyKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikgew0KICAgICAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH0NCiAgICAgICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7DQogICAgICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9DQogICAgICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvclsidGhyb3ciXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9DQogICAgICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfQ0KICAgICAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpOw0KICAgICAgICB9KTsNCiAgICB9CgogICAgLyoKICAgICAqIGJhc2U2NC1hcnJheWJ1ZmZlciAxLjAuMSA8aHR0cHM6Ly9naXRodWIuY29tL25pa2xhc3ZoL2Jhc2U2NC1hcnJheWJ1ZmZlcj4KICAgICAqIENvcHlyaWdodCAoYykgMjAyMSBOaWtsYXMgdm9uIEhlcnR6ZW4gPGh0dHBzOi8vaGVydHplbi5jb20+CiAgICAgKiBSZWxlYXNlZCB1bmRlciBNSVQgTGljZW5zZQogICAgICovCiAgICB2YXIgY2hhcnMgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyc7CiAgICAvLyBVc2UgYSBsb29rdXAgdGFibGUgdG8gZmluZCB0aGUgaW5kZXguCiAgICB2YXIgbG9va3VwID0gdHlwZW9mIFVpbnQ4QXJyYXkgPT09ICd1bmRlZmluZWQnID8gW10gOiBuZXcgVWludDhBcnJheSgyNTYpOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGFycy5sZW5ndGg7IGkrKykgewogICAgICAgIGxvb2t1cFtjaGFycy5jaGFyQ29kZUF0KGkpXSA9IGk7CiAgICB9CiAgICB2YXIgZW5jb2RlID0gZnVuY3Rpb24gKGFycmF5YnVmZmVyKSB7CiAgICAgICAgdmFyIGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXlidWZmZXIpLCBpLCBsZW4gPSBieXRlcy5sZW5ndGgsIGJhc2U2NCA9ICcnOwogICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkgKz0gMykgewogICAgICAgICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaV0gPj4gMl07CiAgICAgICAgICAgIGJhc2U2NCArPSBjaGFyc1soKGJ5dGVzW2ldICYgMykgPDwgNCkgfCAoYnl0ZXNbaSArIDFdID4+IDQpXTsKICAgICAgICAgICAgYmFzZTY0ICs9IGNoYXJzWygoYnl0ZXNbaSArIDFdICYgMTUpIDw8IDIpIHwgKGJ5dGVzW2kgKyAyXSA+PiA2KV07CiAgICAgICAgICAgIGJhc2U2NCArPSBjaGFyc1tieXRlc1tpICsgMl0gJiA2M107CiAgICAgICAgfQogICAgICAgIGlmIChsZW4gJSAzID09PSAyKSB7CiAgICAgICAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDEpICsgJz0nOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChsZW4gJSAzID09PSAxKSB7CiAgICAgICAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDIpICsgJz09JzsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGJhc2U2NDsKICAgIH07CgogICAgY29uc3QgbGFzdEJsb2JNYXAgPSBuZXcgTWFwKCk7DQogICAgY29uc3QgdHJhbnNwYXJlbnRCbG9iTWFwID0gbmV3IE1hcCgpOw0KICAgIGZ1bmN0aW9uIGdldFRyYW5zcGFyZW50QmxvYkZvcih3aWR0aCwgaGVpZ2h0LCBkYXRhVVJMT3B0aW9ucykgew0KICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkgew0KICAgICAgICAgICAgY29uc3QgaWQgPSBgJHt3aWR0aH0tJHtoZWlnaHR9YDsNCiAgICAgICAgICAgIGlmICgnT2Zmc2NyZWVuQ2FudmFzJyBpbiBnbG9iYWxUaGlzKSB7DQogICAgICAgICAgICAgICAgaWYgKHRyYW5zcGFyZW50QmxvYk1hcC5oYXMoaWQpKQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNwYXJlbnRCbG9iTWFwLmdldChpZCk7DQogICAgICAgICAgICAgICAgY29uc3Qgb2Zmc2NyZWVuID0gbmV3IE9mZnNjcmVlbkNhbnZhcyh3aWR0aCwgaGVpZ2h0KTsNCiAgICAgICAgICAgICAgICBvZmZzY3JlZW4uZ2V0Q29udGV4dCgnMmQnKTsNCiAgICAgICAgICAgICAgICBjb25zdCBibG9iID0geWllbGQgb2Zmc2NyZWVuLmNvbnZlcnRUb0Jsb2IoZGF0YVVSTE9wdGlvbnMpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGFycmF5QnVmZmVyID0geWllbGQgYmxvYi5hcnJheUJ1ZmZlcigpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGJhc2U2NCA9IGVuY29kZShhcnJheUJ1ZmZlcik7DQogICAgICAgICAgICAgICAgdHJhbnNwYXJlbnRCbG9iTWFwLnNldChpZCwgYmFzZTY0KTsNCiAgICAgICAgICAgICAgICByZXR1cm4gYmFzZTY0Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICcnOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9DQogICAgY29uc3Qgd29ya2VyID0gc2VsZjsNCiAgICB3b3JrZXIub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHsNCiAgICAgICAgICAgIGlmICgnT2Zmc2NyZWVuQ2FudmFzJyBpbiBnbG9iYWxUaGlzKSB7DQogICAgICAgICAgICAgICAgY29uc3QgeyBpZCwgYml0bWFwLCB3aWR0aCwgaGVpZ2h0LCBkYXRhVVJMT3B0aW9ucyB9ID0gZS5kYXRhOw0KICAgICAgICAgICAgICAgIGNvbnN0IHRyYW5zcGFyZW50QmFzZTY0ID0gZ2V0VHJhbnNwYXJlbnRCbG9iRm9yKHdpZHRoLCBoZWlnaHQsIGRhdGFVUkxPcHRpb25zKTsNCiAgICAgICAgICAgICAgICBjb25zdCBvZmZzY3JlZW4gPSBuZXcgT2Zmc2NyZWVuQ2FudmFzKHdpZHRoLCBoZWlnaHQpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGN0eCA9IG9mZnNjcmVlbi5nZXRDb250ZXh0KCcyZCcpOw0KICAgICAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoYml0bWFwLCAwLCAwKTsNCiAgICAgICAgICAgICAgICBiaXRtYXAuY2xvc2UoKTsNCiAgICAgICAgICAgICAgICBjb25zdCBibG9iID0geWllbGQgb2Zmc2NyZWVuLmNvbnZlcnRUb0Jsb2IoZGF0YVVSTE9wdGlvbnMpOw0KICAgICAgICAgICAgICAgIGNvbnN0IHR5cGUgPSBibG9iLnR5cGU7DQogICAgICAgICAgICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSB5aWVsZCBibG9iLmFycmF5QnVmZmVyKCk7DQogICAgICAgICAgICAgICAgY29uc3QgYmFzZTY0ID0gZW5jb2RlKGFycmF5QnVmZmVyKTsNCiAgICAgICAgICAgICAgICBpZiAoIWxhc3RCbG9iTWFwLmhhcyhpZCkgJiYgKHlpZWxkIHRyYW5zcGFyZW50QmFzZTY0KSA9PT0gYmFzZTY0KSB7DQogICAgICAgICAgICAgICAgICAgIGxhc3RCbG9iTWFwLnNldChpZCwgYmFzZTY0KTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkIH0pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAobGFzdEJsb2JNYXAuZ2V0KGlkKSA9PT0gYmFzZTY0KQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQgfSk7DQogICAgICAgICAgICAgICAgd29ya2VyLnBvc3RNZXNzYWdlKHsNCiAgICAgICAgICAgICAgICAgICAgaWQsDQogICAgICAgICAgICAgICAgICAgIHR5cGUsDQogICAgICAgICAgICAgICAgICAgIGJhc2U2NCwNCiAgICAgICAgICAgICAgICAgICAgd2lkdGgsDQogICAgICAgICAgICAgICAgICAgIGhlaWdodCwNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICBsYXN0QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQ6IGUuZGF0YS5pZCB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfTsKCn0pKCk7Cgo=",null,!1),sr=class{reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}constructor(e){this.pendingCanvasMutations=new Map,this.rafStamps={latestId:0,invokeId:null},this.frozen=!1,this.locked=!1,this.processMutation=(a,c)=>{(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId||!this.rafStamps.invokeId)&&(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(a)||this.pendingCanvasMutations.set(a,[]),this.pendingCanvasMutations.get(a).push(c)};let{sampling:r="all",win:n,blockClass:i,blockSelector:s,recordCanvas:o,dataURLOptions:l}=e;this.mutationCb=e.mutationCb,this.mirror=e.mirror,o&&r==="all"&&this.initCanvasMutationObserver(n,i,s),o&&typeof r=="number"&&this.initCanvasFPSObserver(r,n,i,s,{dataURLOptions:l})}initCanvasFPSObserver(e,r,n,i,s){let o=Cn(r,n,i,!0),l=new Map,a=new ro;a.onmessage=p=>{let{id:m}=p.data;if(l.set(m,!1),!("base64"in p.data))return;let{base64:I,type:y,width:v,height:g}=p.data;this.mutationCb({id:m,type:Re["2D"],commands:[{property:"clearRect",args:[0,0,v,g]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:I}],type:y}]},0,0]}]})};let c=1e3/e,u=0,d,h=()=>{let p=[];return r.document.querySelectorAll("canvas").forEach(m=>{ue(m,n,i,!0)||p.push(m)}),p},f=p=>{if(u&&p-u<c){d=requestAnimationFrame(f);return}u=p,h().forEach(m=>Te(this,void 0,void 0,function*(){var I;let y=this.mirror.getId(m);if(l.get(y))return;if(l.set(y,!0),["webgl","webgl2"].includes(m.__context)){let g=m.getContext(m.__context);((I=g?.getContextAttributes())===null||I===void 0?void 0:I.preserveDrawingBuffer)===!1&&g.clear(g.COLOR_BUFFER_BIT)}let v=yield createImageBitmap(m);a.postMessage({id:y,bitmap:v,width:m.width,height:m.height,dataURLOptions:s.dataURLOptions},[v])})),d=requestAnimationFrame(f)};d=requestAnimationFrame(f),this.resetObservers=()=>{o(),cancelAnimationFrame(d)}}initCanvasMutationObserver(e,r,n){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();let i=Cn(e,r,n,!1),s=Xs(this.processMutation.bind(this),e,r,n),o=qs(this.processMutation.bind(this),e,r,n,this.mirror);this.resetObservers=()=>{i(),s(),o()}}startPendingCanvasMutationFlusher(){requestAnimationFrame(()=>this.flushPendingCanvasMutations())}startRAFTimestamping(){let e=r=>{this.rafStamps.latestId=r,requestAnimationFrame(e)};requestAnimationFrame(e)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach((e,r)=>{let n=this.mirror.getId(r);this.flushPendingCanvasMutationFor(r,n)}),requestAnimationFrame(()=>this.flushPendingCanvasMutations())}flushPendingCanvasMutationFor(e,r){if(this.frozen||this.locked)return;let n=this.pendingCanvasMutations.get(e);if(!n||r===-1)return;let i=n.map(o=>Ys(o,["type"])),{type:s}=n[0];this.mutationCb({id:r,type:s,commands:i}),this.pendingCanvasMutations.delete(e)}},or=class{constructor(e){this.trackedLinkElements=new WeakSet,this.styleMirror=new ut,this.mutationCb=e.mutationCb,this.adoptedStyleSheetCb=e.adoptedStyleSheetCb}attachLinkElement(e,r){"_cssText"in r.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:r.id,attributes:r.attributes}]}),this.trackLinkElement(e)}trackLinkElement(e){this.trackedLinkElements.has(e)||(this.trackedLinkElements.add(e),this.trackStylesheetInLinkElement(e))}adoptStyleSheets(e,r){if(e.length===0)return;let n={id:r,styleIds:[]},i=[];for(let s of e){let o;if(this.styleMirror.has(s))o=this.styleMirror.getId(s);else{o=this.styleMirror.add(s);let l=Array.from(s.rules||CSSRule);i.push({styleId:o,rules:l.map((a,c)=>({rule:Pn(a),index:c}))})}n.styleIds.push(o)}i.length>0&&(n.styles=i),this.adoptedStyleSheetCb(n)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(e){}},ar=class{constructor(){this.nodeMap=new WeakMap,this.loop=!0,this.periodicallyClear()}periodicallyClear(){requestAnimationFrame(()=>{this.clear(),this.loop&&this.periodicallyClear()})}inOtherBuffer(e,r){let n=this.nodeMap.get(e);return n&&Array.from(n).some(i=>i!==r)}add(e,r){this.nodeMap.set(e,(this.nodeMap.get(e)||new Set).add(r))}clear(){this.nodeMap=new WeakMap}destroy(){this.loop=!1}};function ne(t){return Object.assign(Object.assign({},t),{timestamp:ct()})}var te,bt,zt,kt=!1,ye=Wn();function Pe(t={}){let{emit:e,checkoutEveryNms:r,checkoutEveryNth:n,blockClass:i="rr-block",blockSelector:s=null,ignoreClass:o="rr-ignore",ignoreSelector:l=null,maskTextClass:a="rr-mask",maskTextSelector:c=null,inlineStylesheet:u=!0,maskAllInputs:d,maskInputOptions:h,slimDOMOptions:f,maskInputFn:p,maskTextFn:m,hooks:I,packFn:y,sampling:v={},dataURLOptions:g={},mousemoveWait:b,recordCanvas:E=!1,recordCrossOriginIframes:T=!1,recordAfter:D=t.recordAfter==="DOMContentLoaded"?t.recordAfter:"load",userTriggeredOnInput:w=!1,collectFonts:j=!1,inlineImages:_=!1,plugins:J,keepIframeSrcFn:W=()=>!1,ignoreCSSAttributes:G=new Set([]),errorHandler:K}=t;Os(K);let L=T?window.parent===window:!0,F=!1;if(!L)try{window.parent.document&&(F=!1)}catch{F=!0}if(L&&!e)throw new Error("emit function is required");b!==void 0&&v.mousemove===void 0&&(v.mousemove=b),ye.reset();let k=d===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:h!==void 0?h:{password:!0},H=f===!0||f==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:f==="all",headMetaDescKeywords:f==="all"}:f||{};xr();let S,C=0,N=O=>{for(let se of J||[])se.eventProcessor&&(O=se.eventProcessor(O));return y&&!F&&(O=y(O)),O};te=(O,se)=>{var U;if(!((U=Fe[0])===null||U===void 0)&&U.isFrozen()&&O.type!==M.FullSnapshot&&!(O.type===M.IncrementalSnapshot&&O.data.source===A.Mutation)&&Fe.forEach(ie=>ie.unfreeze()),L)e?.(N(O),se);else if(F){let ie={type:"rrweb",event:N(O),origin:window.location.origin,isCheckout:se};window.parent.postMessage(ie,"*")}if(O.type===M.FullSnapshot)S=O,C=0;else if(O.type===M.IncrementalSnapshot){if(O.data.source===A.Mutation&&O.data.isAttachIframe)return;C++;let ie=n&&C>=n,ge=r&&O.timestamp-S.timestamp>r;(ie||ge)&&bt(!0)}};let R=O=>{te(ne({type:M.IncrementalSnapshot,data:Object.assign({source:A.Mutation},O)}))},Y=O=>te(ne({type:M.IncrementalSnapshot,data:Object.assign({source:A.Scroll},O)})),Q=O=>te(ne({type:M.IncrementalSnapshot,data:Object.assign({source:A.CanvasMutation},O)})),ee=O=>te(ne({type:M.IncrementalSnapshot,data:Object.assign({source:A.AdoptedStyleSheet},O)})),ae=new or({mutationCb:R,adoptedStyleSheetCb:ee}),le=new nr({mirror:ye,mutationCb:R,stylesheetManager:ae,recordCrossOriginIframes:T,wrappedEmit:te});for(let O of J||[])O.getMirror&&O.getMirror({nodeMirror:ye,crossOriginIframeMirror:le.crossOriginIframeMirror,crossOriginIframeStyleMirror:le.crossOriginIframeStyleMirror});let he=new ar;zt=new sr({recordCanvas:E,mutationCb:Q,win:window,blockClass:i,blockSelector:s,mirror:ye,sampling:v.canvas,dataURLOptions:g});let fe=new ir({mutationCb:R,scrollCb:Y,bypassOptions:{blockClass:i,blockSelector:s,maskTextClass:a,maskTextSelector:c,inlineStylesheet:u,maskInputOptions:k,dataURLOptions:g,maskTextFn:m,maskInputFn:p,recordCanvas:E,inlineImages:_,sampling:v,slimDOMOptions:H,iframeManager:le,stylesheetManager:ae,canvasManager:zt,keepIframeSrcFn:W,processedNodeManager:he},mirror:ye});bt=(O=!1)=>{te(ne({type:M.Meta,data:{href:window.location.href,width:Dr(),height:kr()}}),O),ae.reset(),fe.init(),Fe.forEach(U=>U.lock());let se=bs(document,{mirror:ye,blockClass:i,blockSelector:s,maskTextClass:a,maskTextSelector:c,inlineStylesheet:u,maskAllInputs:k,maskTextFn:m,slimDOM:H,dataURLOptions:g,recordCanvas:E,inlineImages:_,onSerialize:U=>{Je(U,ye)&&le.addIframe(U),Fr(U,ye)&&ae.trackLinkElement(U),De(U)&&fe.addShadowRoot(U.shadowRoot,document)},onIframeLoad:(U,ie)=>{le.attachIframe(U,ie),fe.observeAttachShadow(U)},onStylesheetLoad:(U,ie)=>{ae.attachLinkElement(U,ie)},keepIframeSrcFn:W});if(!se)return console.warn("Failed to snapshot the document");te(ne({type:M.FullSnapshot,data:{node:se,initialOffset:Mr(window)}}),O),Fe.forEach(U=>U.unlock()),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&ae.adoptStyleSheets(document.adoptedStyleSheets,ye.getId(document))};try{let O=[],se=ie=>{var ge;return P(zs)({mutationCb:R,mousemoveCb:(q,Gt)=>te(ne({type:M.IncrementalSnapshot,data:{source:Gt,positions:q}})),mouseInteractionCb:q=>te(ne({type:M.IncrementalSnapshot,data:Object.assign({source:A.MouseInteraction},q)})),scrollCb:Y,viewportResizeCb:q=>te(ne({type:M.IncrementalSnapshot,data:Object.assign({source:A.ViewportResize},q)})),inputCb:q=>te(ne({type:M.IncrementalSnapshot,data:Object.assign({source:A.Input},q)})),mediaInteractionCb:q=>te(ne({type:M.IncrementalSnapshot,data:Object.assign({source:A.MediaInteraction},q)})),styleSheetRuleCb:q=>te(ne({type:M.IncrementalSnapshot,data:Object.assign({source:A.StyleSheetRule},q)})),styleDeclarationCb:q=>te(ne({type:M.IncrementalSnapshot,data:Object.assign({source:A.StyleDeclaration},q)})),canvasMutationCb:Q,fontCb:q=>te(ne({type:M.IncrementalSnapshot,data:Object.assign({source:A.Font},q)})),selectionCb:q=>{te(ne({type:M.IncrementalSnapshot,data:Object.assign({source:A.Selection},q)}))},blockClass:i,ignoreClass:o,ignoreSelector:l,maskTextClass:a,maskTextSelector:c,maskInputOptions:k,inlineStylesheet:u,sampling:v,recordCanvas:E,inlineImages:_,userTriggeredOnInput:w,collectFonts:j,doc:ie,maskInputFn:p,maskTextFn:m,keepIframeSrcFn:W,blockSelector:s,slimDOMOptions:H,dataURLOptions:g,mirror:ye,iframeManager:le,stylesheetManager:ae,shadowDomManager:fe,processedNodeManager:he,canvasManager:zt,ignoreCSSAttributes:G,plugins:((ge=J?.filter(q=>q.observer))===null||ge===void 0?void 0:ge.map(q=>({observer:q.observer,options:q.options,callback:Gt=>te(ne({type:M.Plugin,data:{plugin:q.name,payload:Gt}}))})))||[]},I)};le.addLoadListener(ie=>{try{O.push(se(ie.contentDocument))}catch(ge){console.warn(ge)}});let U=()=>{bt(),O.push(se(document)),kt=!0};return document.readyState==="interactive"||document.readyState==="complete"?U():(O.push(ce("DOMContentLoaded",()=>{te(ne({type:M.DomContentLoaded,data:{}})),D==="DOMContentLoaded"&&U()})),O.push(ce("load",()=>{te(ne({type:M.Load,data:{}})),D==="load"&&U()},window))),()=>{O.forEach(ie=>ie()),he.destroy(),kt=!1,xs()}}catch(O){console.warn(O)}}Pe.addCustomEvent=(t,e)=>{if(!kt)throw new Error("please add custom event after start recording");te(ne({type:M.Custom,data:{tag:t,payload:e}}))};Pe.freezePage=()=>{Fe.forEach(t=>t.freeze())};Pe.takeFullSnapshot=t=>{if(!kt)throw new Error("please take full snapshot after start recording");bt(t)};Pe.mirror=ye;var B;(function(t){t[t.Document=0]="Document",t[t.DocumentType=1]="DocumentType",t[t.Element=2]="Element",t[t.Text=3]="Text",t[t.CDATA=4]="CDATA",t[t.Comment=5]="Comment"})(B||(B={}));var no=function(){function t(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}return t.prototype.getId=function(e){var r;if(!e)return-1;var n=(r=this.getMeta(e))===null||r===void 0?void 0:r.id;return n??-1},t.prototype.getNode=function(e){return this.idNodeMap.get(e)||null},t.prototype.getIds=function(){return Array.from(this.idNodeMap.keys())},t.prototype.getMeta=function(e){return this.nodeMetaMap.get(e)||null},t.prototype.removeNodeFromMap=function(e){var r=this,n=this.getId(e);this.idNodeMap.delete(n),e.childNodes&&e.childNodes.forEach(function(i){return r.removeNodeFromMap(i)})},t.prototype.has=function(e){return this.idNodeMap.has(e)},t.prototype.hasNode=function(e){return this.nodeMetaMap.has(e)},t.prototype.add=function(e,r){var n=r.id;this.idNodeMap.set(n,e),this.nodeMetaMap.set(e,r)},t.prototype.replace=function(e,r){var n=this.getNode(e);if(n){var i=this.nodeMetaMap.get(n);i&&this.nodeMetaMap.set(r,i)}this.idNodeMap.set(e,r)},t.prototype.reset=function(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap},t}();function io(){return new no}function so(t){let e={},r=/;(?![^(]*\))/g,n=/:(.+)/,i=/\/\*.*?\*\//g;return t.replace(i,"").split(r).forEach(function(s){if(s){let o=s.split(n);o.length>1&&(e[lr(o[0].trim())]=o[1].trim())}}),e}function Sn(t){let e=[];for(let r in t){let n=t[r];if(typeof n!="string")continue;let i=co(r);e.push(`${i}: ${n};`)}return e.join(" ")}var oo=/-([a-z])/g,ao=/^--[a-zA-Z0-9-]+$/,lr=t=>ao.test(t)?t:t.replace(oo,(e,r)=>r?r.toUpperCase():""),lo=/\B([A-Z])/g,co=t=>t.replace(lo,"-$1").toLowerCase(),me=class t{constructor(...e){this.parentElement=null,this.parentNode=null,this.firstChild=null,this.lastChild=null,this.previousSibling=null,this.nextSibling=null,this.ELEMENT_NODE=$.ELEMENT_NODE,this.TEXT_NODE=$.TEXT_NODE}get childNodes(){let e=[],r=this.firstChild;for(;r;)e.push(r),r=r.nextSibling;return e}contains(e){if(e instanceof t){if(e.ownerDocument!==this.ownerDocument)return!1;if(e===this)return!0}else return!1;for(;e.parentNode;){if(e.parentNode===this)return!0;e=e.parentNode}return!1}appendChild(e){throw new Error("RRDomException: Failed to execute 'appendChild' on 'RRNode': This RRNode type does not support this method.")}insertBefore(e,r){throw new Error("RRDomException: Failed to execute 'insertBefore' on 'RRNode': This RRNode type does not support this method.")}removeChild(e){throw new Error("RRDomException: Failed to execute 'removeChild' on 'RRNode': This RRNode type does not support this method.")}toString(){return"RRNode"}};function uo(t){return class ii extends t{constructor(...r){super(r),this.nodeType=$.DOCUMENT_NODE,this.nodeName="#document",this.compatMode="CSS1Compat",this.RRNodeType=B.Document,this.textContent=null,this.ownerDocument=this}get documentElement(){return this.childNodes.find(r=>r.RRNodeType===B.Element&&r.tagName==="HTML")||null}get body(){var r;return((r=this.documentElement)===null||r===void 0?void 0:r.childNodes.find(n=>n.RRNodeType===B.Element&&n.tagName==="BODY"))||null}get head(){var r;return((r=this.documentElement)===null||r===void 0?void 0:r.childNodes.find(n=>n.RRNodeType===B.Element&&n.tagName==="HEAD"))||null}get implementation(){return this}get firstElementChild(){return this.documentElement}appendChild(r){let n=r.RRNodeType;if((n===B.Element||n===B.DocumentType)&&this.childNodes.some(s=>s.RRNodeType===n))throw new Error(`RRDomException: Failed to execute 'appendChild' on 'RRNode': Only one ${n===B.Element?"RRElement":"RRDoctype"} on RRDocument allowed.`);let i=Wr(this,r);return i.parentElement=null,i}insertBefore(r,n){let i=r.RRNodeType;if((i===B.Element||i===B.DocumentType)&&this.childNodes.some(o=>o.RRNodeType===i))throw new Error(`RRDomException: Failed to execute 'insertBefore' on 'RRNode': Only one ${i===B.Element?"RRElement":"RRDoctype"} on RRDocument allowed.`);let s=ui(this,r,n);return s.parentElement=null,s}removeChild(r){return di(this,r)}open(){this.firstChild=null,this.lastChild=null}close(){}write(r){let n;if(r==='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'?n="-//W3C//DTD XHTML 1.0 Transitional//EN":r==='<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">'&&(n="-//W3C//DTD HTML 4.0 Transitional//EN"),n){let i=this.createDocumentType("html",n,"");this.open(),this.appendChild(i)}}createDocument(r,n,i){return new ii}createDocumentType(r,n,i){let s=new(si(me))(r,n,i);return s.ownerDocument=this,s}createElement(r){let n=new(oi(me))(r);return n.ownerDocument=this,n}createElementNS(r,n){return this.createElement(n)}createTextNode(r){let n=new(ai(me))(r);return n.ownerDocument=this,n}createComment(r){let n=new(li(me))(r);return n.ownerDocument=this,n}createCDATASection(r){let n=new(ci(me))(r);return n.ownerDocument=this,n}toString(){return"RRDocument"}}}function si(t){return class extends t{constructor(r,n,i){super(),this.nodeType=$.DOCUMENT_TYPE_NODE,this.RRNodeType=B.DocumentType,this.name=r,this.publicId=n,this.systemId=i,this.nodeName=r,this.textContent=null}toString(){return"RRDocumentType"}}}function oi(t){return class extends t{constructor(r){super(),this.nodeType=$.ELEMENT_NODE,this.RRNodeType=B.Element,this.attributes={},this.shadowRoot=null,this.tagName=r.toUpperCase(),this.nodeName=r.toUpperCase()}get textContent(){let r="";return this.childNodes.forEach(n=>r+=n.textContent),r}set textContent(r){this.firstChild=null,this.lastChild=null,this.appendChild(this.ownerDocument.createTextNode(r))}get classList(){return new cr(this.attributes.class,r=>{this.attributes.class=r})}get id(){return this.attributes.id||""}get className(){return this.attributes.class||""}get style(){let r=this.attributes.style?so(this.attributes.style):{},n=/\B([A-Z])/g;return r.setProperty=(i,s,o)=>{if(n.test(i))return;let l=lr(i);s?r[l]=s:delete r[l],o==="important"&&(r[l]+=" !important"),this.attributes.style=Sn(r)},r.removeProperty=i=>{if(n.test(i))return"";let s=lr(i),o=r[s]||"";return delete r[s],this.attributes.style=Sn(r),o},r}getAttribute(r){return this.attributes[r]||null}setAttribute(r,n){this.attributes[r]=n}setAttributeNS(r,n,i){this.setAttribute(n,i)}removeAttribute(r){delete this.attributes[r]}appendChild(r){return Wr(this,r)}insertBefore(r,n){return ui(this,r,n)}removeChild(r){return di(this,r)}attachShadow(r){let n=this.ownerDocument.createElement("SHADOWROOT");return this.shadowRoot=n,n}dispatchEvent(r){return!0}toString(){let r="";for(let n in this.attributes)r+=`${n}="${this.attributes[n]}" `;return`${this.tagName} ${r}`}}}function ho(t){return class extends t{attachShadow(r){throw new Error("RRDomException: Failed to execute 'attachShadow' on 'RRElement': This RRElement does not support attachShadow")}play(){this.paused=!1}pause(){this.paused=!0}}}function ai(t){return class extends t{constructor(r){super(),this.nodeType=$.TEXT_NODE,this.nodeName="#text",this.RRNodeType=B.Text,this.data=r}get textContent(){return this.data}set textContent(r){this.data=r}toString(){return`RRText text=${JSON.stringify(this.data)}`}}}function li(t){return class extends t{constructor(r){super(),this.nodeType=$.COMMENT_NODE,this.nodeName="#comment",this.RRNodeType=B.Comment,this.data=r}get textContent(){return this.data}set textContent(r){this.data=r}toString(){return`RRComment text=${JSON.stringify(this.data)}`}}}function ci(t){return class extends t{constructor(r){super(),this.nodeName="#cdata-section",this.nodeType=$.CDATA_SECTION_NODE,this.RRNodeType=B.CDATA,this.data=r}get textContent(){return this.data}set textContent(r){this.data=r}toString(){return`RRCDATASection data=${JSON.stringify(this.data)}`}}}var cr=class{constructor(e,r){if(this.classes=[],this.add=(...n)=>{for(let i of n){let s=String(i);this.classes.indexOf(s)>=0||this.classes.push(s)}this.onChange&&this.onChange(this.classes.join(" "))},this.remove=(...n)=>{this.classes=this.classes.filter(i=>n.indexOf(i)===-1),this.onChange&&this.onChange(this.classes.join(" "))},e){let n=e.trim().split(/\s+/);this.classes.push(...n)}this.onChange=r}};function Wr(t,e){return e.parentNode&&e.parentNode.removeChild(e),t.lastChild?(t.lastChild.nextSibling=e,e.previousSibling=t.lastChild):(t.firstChild=e,e.previousSibling=null),t.lastChild=e,e.nextSibling=null,e.parentNode=t,e.parentElement=t,e.ownerDocument=t.ownerDocument,e}function ui(t,e,r){if(!r)return Wr(t,e);if(r.parentNode!==t)throw new Error("Failed to execute 'insertBefore' on 'RRNode': The RRNode before which the new node is to be inserted is not a child of this RRNode.");return e===r||(e.parentNode&&e.parentNode.removeChild(e),e.previousSibling=r.previousSibling,r.previousSibling=e,e.nextSibling=r,e.previousSibling?e.previousSibling.nextSibling=e:t.firstChild=e,e.parentElement=t,e.parentNode=t,e.ownerDocument=t.ownerDocument),e}function di(t,e){if(e.parentNode!==t)throw new Error("Failed to execute 'removeChild' on 'RRNode': The RRNode to be removed is not a child of this RRNode.");return e.previousSibling?e.previousSibling.nextSibling=e.nextSibling:t.firstChild=e.nextSibling,e.nextSibling?e.nextSibling.previousSibling=e.previousSibling:t.lastChild=e.previousSibling,e.previousSibling=null,e.nextSibling=null,e.parentElement=null,e.parentNode=null,e}var $;(function(t){t[t.PLACEHOLDER=0]="PLACEHOLDER",t[t.ELEMENT_NODE=1]="ELEMENT_NODE",t[t.ATTRIBUTE_NODE=2]="ATTRIBUTE_NODE",t[t.TEXT_NODE=3]="TEXT_NODE",t[t.CDATA_SECTION_NODE=4]="CDATA_SECTION_NODE",t[t.ENTITY_REFERENCE_NODE=5]="ENTITY_REFERENCE_NODE",t[t.ENTITY_NODE=6]="ENTITY_NODE",t[t.PROCESSING_INSTRUCTION_NODE=7]="PROCESSING_INSTRUCTION_NODE",t[t.COMMENT_NODE=8]="COMMENT_NODE",t[t.DOCUMENT_NODE=9]="DOCUMENT_NODE",t[t.DOCUMENT_TYPE_NODE=10]="DOCUMENT_TYPE_NODE",t[t.DOCUMENT_FRAGMENT_NODE=11]="DOCUMENT_FRAGMENT_NODE"})($||($={}));var ur={svg:"http://www.w3.org/2000/svg","xlink:href":"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/2000/xmlns/"},fo={altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"},pe=null;function Dt(t,e,r,n=e.mirror||e.ownerDocument.mirror){t=po(t,e,r,n),hi(t,e,r,n),mo(t,e,r,n)}function po(t,e,r,n){var i;if(r.afterAppend&&!pe&&(pe=new WeakSet,setTimeout(()=>{pe=null},0)),!Ur(t,e)){let s=Ot(e,r.mirror,n);(i=t.parentNode)===null||i===void 0||i.replaceChild(s,t),t=s}switch(e.RRNodeType){case B.Document:{if(!Ge(t,e,r.mirror,n)){let s=n.getMeta(e);s&&(r.mirror.removeNodeFromMap(t),t.close(),t.open(),r.mirror.add(t,s),pe?.add(t))}break}case B.Element:{let s=t,o=e;switch(o.tagName){case"IFRAME":{let l=t.contentDocument;if(!l)break;Dt(l,e.contentDocument,r,n);break}}o.shadowRoot&&(s.shadowRoot||s.attachShadow({mode:"open"}),hi(s.shadowRoot,o.shadowRoot,r,n));break}}return t}function mo(t,e,r,n){var i;switch(e.RRNodeType){case B.Document:{let s=e.scrollData;s&&r.applyScroll(s,!0);break}case B.Element:{let s=t,o=e;switch(go(s,o,n),o.scrollData&&r.applyScroll(o.scrollData,!0),o.inputData&&r.applyInput(o.inputData),o.tagName){case"AUDIO":case"VIDEO":{let l=t,a=o;a.paused!==void 0&&(a.paused?l.pause():l.play()),a.muted!==void 0&&(l.muted=a.muted),a.volume!==void 0&&(l.volume=a.volume),a.currentTime!==void 0&&(l.currentTime=a.currentTime),a.playbackRate!==void 0&&(l.playbackRate=a.playbackRate);break}case"CANVAS":{let l=e;if(l.rr_dataURL!==null){let a=document.createElement("img");a.onload=()=>{let c=s.getContext("2d");c&&c.drawImage(a,0,0,a.width,a.height)},a.src=l.rr_dataURL}l.canvasMutations.forEach(a=>r.applyCanvas(a.event,a.mutation,t));break}case"STYLE":{let l=s.sheet;l&&e.rules.forEach(a=>r.applyStyleSheetMutation(a,l));break}}break}case B.Text:case B.Comment:case B.CDATA:{t.textContent!==e.data&&(t.textContent=e.data);break}}pe?.has(t)&&(pe.delete(t),(i=r.afterAppend)===null||i===void 0||i.call(r,t,r.mirror.getId(t)))}function go(t,e,r){let n=t.attributes,i=e.attributes;for(let s in i){let o=i[s],l=r.getMeta(e);if(l?.isSVG&&ur[s])t.setAttributeNS(ur[s],s,o);else if(e.tagName==="CANVAS"&&s==="rr_dataURL"){let a=document.createElement("img");a.src=o,a.onload=()=>{let c=t.getContext("2d");c&&c.drawImage(a,0,0,a.width,a.height)}}else{if(e.tagName==="IFRAME"&&s==="srcdoc")continue;t.setAttribute(s,o)}}for(let{name:s}of Array.from(n))s in i||t.removeAttribute(s);e.scrollLeft&&(t.scrollLeft=e.scrollLeft),e.scrollTop&&(t.scrollTop=e.scrollTop)}function hi(t,e,r,n){let i=Array.from(t.childNodes),s=e.childNodes;if(i.length===0&&s.length===0)return;let o=0,l=i.length-1,a=0,c=s.length-1,u=i[o],d=i[l],h=s[a],f=s[c],p,m;for(;o<=l&&a<=c;)if(u===void 0)u=i[++o];else if(d===void 0)d=i[--l];else if(Ge(u,h,r.mirror,n))u=i[++o],h=s[++a];else if(Ge(d,f,r.mirror,n))d=i[--l],f=s[--c];else if(Ge(u,f,r.mirror,n)){try{t.insertBefore(u,d.nextSibling)}catch(v){console.warn(v)}u=i[++o],f=s[--c]}else if(Ge(d,h,r.mirror,n)){try{t.insertBefore(d,u)}catch(v){console.warn(v)}d=i[--l],h=s[++a]}else{if(!p){p={};for(let g=o;g<=l;g++){let b=i[g];b&&r.mirror.hasNode(b)&&(p[r.mirror.getId(b)]=g)}}m=p[n.getId(h)];let v=i[m];if(m!==void 0&&v&&Ge(v,h,r.mirror,n)){try{t.insertBefore(v,u)}catch(g){console.warn(g)}i[m]=void 0}else{let g=Ot(h,r.mirror,n);t.nodeName==="#document"&&u&&(g.nodeType===g.DOCUMENT_TYPE_NODE&&u.nodeType===u.DOCUMENT_TYPE_NODE||g.nodeType===g.ELEMENT_NODE&&u.nodeType===u.ELEMENT_NODE)&&(t.removeChild(u),r.mirror.removeNodeFromMap(u),u=i[++o]);try{t.insertBefore(g,u||null)}catch(b){console.warn(b)}}h=s[++a]}if(o>l){let v=s[c+1],g=null;for(v&&(g=r.mirror.getNode(n.getId(v)));a<=c;++a){let b=Ot(s[a],r.mirror,n);try{t.insertBefore(b,g)}catch(E){console.warn(E)}}}else if(a>c)for(;o<=l;o++){let v=i[o];if(!(!v||v.parentNode!==t))try{t.removeChild(v),r.mirror.removeNodeFromMap(v)}catch(g){console.warn(g)}}let I=t.firstChild,y=e.firstChild;for(;I!==null&&y!==null;)Dt(I,y,r,n),I=I.nextSibling,y=y.nextSibling}function Ot(t,e,r){let n=r.getId(t),i=r.getMeta(t),s=null;if(n>-1&&(s=e.getNode(n)),s!==null&&Ur(s,t))return s;switch(t.RRNodeType){case B.Document:s=new Document;break;case B.DocumentType:s=document.implementation.createDocumentType(t.name,t.publicId,t.systemId);break;case B.Element:{let o=t.tagName.toLowerCase();o=fo[o]||o,i&&"isSVG"in i&&i?.isSVG?s=document.createElementNS(ur.svg,o):s=document.createElement(t.tagName);break}case B.Text:s=document.createTextNode(t.data);break;case B.Comment:s=document.createComment(t.data);break;case B.CDATA:s=document.createCDATASection(t.data);break}i&&e.add(s,Object.assign({},i));try{pe?.add(s)}catch{}return s}function Ur(t,e){return t.nodeType!==e.nodeType?!1:t.nodeType!==t.ELEMENT_NODE||t.tagName.toUpperCase()===e.tagName}function Ge(t,e,r,n){let i=r.getId(t),s=n.getId(e);return i===-1||i!==s?!1:Ur(t,e)}var Qe=class t extends uo(me){get unserializedId(){return this._unserializedId--}constructor(e){super(),this.UNSERIALIZED_STARTING_ID=-2,this._unserializedId=this.UNSERIALIZED_STARTING_ID,this.mirror=wo(),this.scrollData=null,e&&(this.mirror=e)}createDocument(e,r,n){return new t}createDocumentType(e,r,n){let i=new vo(e,r,n);return i.ownerDocument=this,i}createElement(e){let r=e.toUpperCase(),n;switch(r){case"AUDIO":case"VIDEO":n=new dr(r);break;case"IFRAME":n=new pr(r,this.mirror);break;case"CANVAS":n=new hr(r);break;case"STYLE":n=new fr(r);break;default:n=new _e(r);break}return n.ownerDocument=this,n}createComment(e){let r=new Co(e);return r.ownerDocument=this,r}createCDATASection(e){let r=new Io(e);return r.ownerDocument=this,r}createTextNode(e){let r=new yo(e);return r.ownerDocument=this,r}destroyTree(){this.firstChild=null,this.lastChild=null,this.mirror.reset()}open(){super.open(),this._unserializedId=this.UNSERIALIZED_STARTING_ID}},vo=si(me),_e=class extends oi(me){constructor(){super(...arguments),this.inputData=null,this.scrollData=null}},dr=class extends ho(_e){},hr=class extends _e{constructor(){super(...arguments),this.rr_dataURL=null,this.canvasMutations=[]}getContext(){return null}},fr=class extends _e{constructor(){super(...arguments),this.rules=[]}},pr=class extends _e{constructor(e,r){super(e),this.contentDocument=new Qe,this.contentDocument.mirror=r}},yo=ai(me),Co=li(me),Io=ci(me);function So(t){return t instanceof HTMLFormElement?"FORM":t.tagName.toUpperCase()}function fi(t,e,r,n){let i;switch(t.nodeType){case $.DOCUMENT_NODE:n&&n.nodeName==="IFRAME"?i=n.contentDocument:(i=e,i.compatMode=t.compatMode);break;case $.DOCUMENT_TYPE_NODE:{let o=t;i=e.createDocumentType(o.name,o.publicId,o.systemId);break}case $.ELEMENT_NODE:{let o=t,l=So(o);i=e.createElement(l);let a=i;for(let{name:c,value:u}of Array.from(o.attributes))a.attributes[c]=u;o.scrollLeft&&(a.scrollLeft=o.scrollLeft),o.scrollTop&&(a.scrollTop=o.scrollTop);break}case $.TEXT_NODE:i=e.createTextNode(t.textContent||"");break;case $.CDATA_SECTION_NODE:i=e.createCDATASection(t.data);break;case $.COMMENT_NODE:i=e.createComment(t.textContent||"");break;case $.DOCUMENT_FRAGMENT_NODE:i=n.attachShadow({mode:"open"});break;default:return null}let s=r.getMeta(t);return e instanceof Qe&&(s||(s=pi(i,e.unserializedId),r.add(t,s)),e.mirror.add(i,Object.assign({},s))),i}function bo(t,e=io(),r=new Qe){function n(i,s){let o=fi(i,r,e,s);if(o!==null)if(s?.nodeName!=="IFRAME"&&i.nodeType!==$.DOCUMENT_FRAGMENT_NODE&&(s?.appendChild(o),o.parentNode=s,o.parentElement=s),i.nodeName==="IFRAME"){let l=i.contentDocument;l&&n(l,o)}else(i.nodeType===$.DOCUMENT_NODE||i.nodeType===$.ELEMENT_NODE||i.nodeType===$.DOCUMENT_FRAGMENT_NODE)&&(i.nodeType===$.ELEMENT_NODE&&i.shadowRoot&&n(i.shadowRoot,o),i.childNodes.forEach(l=>n(l,o)))}return n(t,null),r}function wo(){return new mr}var mr=class{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(e){var r;if(!e)return-1;let n=(r=this.getMeta(e))===null||r===void 0?void 0:r.id;return n??-1}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){let r=this.getId(e);this.idNodeMap.delete(r),e.childNodes&&e.childNodes.forEach(n=>this.removeNodeFromMap(n))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,r){let n=r.id;this.idNodeMap.set(n,e),this.nodeMetaMap.set(e,r)}replace(e,r){let n=this.getNode(e);if(n){let i=this.nodeMetaMap.get(n);i&&this.nodeMetaMap.set(r,i)}this.idNodeMap.set(e,r)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}};function pi(t,e){switch(t.RRNodeType){case B.Document:return{id:e,type:t.RRNodeType,childNodes:[]};case B.DocumentType:{let r=t;return{id:e,type:t.RRNodeType,name:r.name,publicId:r.publicId,systemId:r.systemId}}case B.Element:return{id:e,type:t.RRNodeType,tagName:t.tagName.toLowerCase(),attributes:{},childNodes:[]};case B.Text:return{id:e,type:t.RRNodeType,textContent:t.textContent||""};case B.Comment:return{id:e,type:t.RRNodeType,textContent:t.textContent||""};case B.CDATA:return{id:e,type:t.RRNodeType,textContent:""}}}function mi(t){return{all:t=t||new Map,on:function(e,r){var n=t.get(e);n?n.push(r):t.set(e,[r])},off:function(e,r){var n=t.get(e);n&&(r?n.splice(n.indexOf(r)>>>0,1):t.set(e,[]))},emit:function(e,r){var n=t.get(e);n&&n.slice().map(function(i){i(r)}),(n=t.get("*"))&&n.slice().map(function(i){i(e,r)})}}}var Eo=Object.freeze({__proto__:null,default:mi});function Ao(t=window,e=document){if("scrollBehavior"in e.documentElement.style&&t.__forceSmoothScrollPolyfill__!==!0)return;let r=t.HTMLElement||t.Element,n=468,i={scroll:t.scroll||t.scrollTo,scrollBy:t.scrollBy,elementScroll:r.prototype.scroll||a,scrollIntoView:r.prototype.scrollIntoView},s=t.performance&&t.performance.now?t.performance.now.bind(t.performance):Date.now;function o(y){let v=["MSIE ","Trident/","Edge/"];return new RegExp(v.join("|")).test(y)}let l=o(t.navigator.userAgent)?1:0;function a(y,v){this.scrollLeft=y,this.scrollTop=v}function c(y){return .5*(1-Math.cos(Math.PI*y))}function u(y){if(y===null||typeof y!="object"||y.behavior===void 0||y.behavior==="auto"||y.behavior==="instant")return!0;if(typeof y=="object"&&y.behavior==="smooth")return!1;throw new TypeError("behavior member of ScrollOptions "+y.behavior+" is not a valid value for enumeration ScrollBehavior.")}function d(y,v){if(v==="Y")return y.clientHeight+l<y.scrollHeight;if(v==="X")return y.clientWidth+l<y.scrollWidth}function h(y,v){let g=t.getComputedStyle(y,null)["overflow"+v];return g==="auto"||g==="scroll"}function f(y){let v=d(y,"Y")&&h(y,"Y"),g=d(y,"X")&&h(y,"X");return v||g}function p(y){for(;y!==e.body&&f(y)===!1;)y=y.parentNode||y.host;return y}function m(y){let v=s(),g,b,E,T=(v-y.startTime)/n;T=T>1?1:T,g=c(T),b=y.startX+(y.x-y.startX)*g,E=y.startY+(y.y-y.startY)*g,y.method.call(y.scrollable,b,E),(b!==y.x||E!==y.y)&&t.requestAnimationFrame(m.bind(t,y))}function I(y,v,g){let b,E,T,D,w=s();y===e.body?(b=t,E=t.scrollX||t.pageXOffset,T=t.scrollY||t.pageYOffset,D=i.scroll):(b=y,E=y.scrollLeft,T=y.scrollTop,D=a),m({scrollable:b,method:D,startTime:w,startX:E,startY:T,x:v,y:g})}t.scroll=t.scrollTo=function(){if(arguments[0]!==void 0){if(u(arguments[0])===!0){i.scroll.call(t,arguments[0].left!==void 0?arguments[0].left:typeof arguments[0]!="object"?arguments[0]:t.scrollX||t.pageXOffset,arguments[0].top!==void 0?arguments[0].top:arguments[1]!==void 0?arguments[1]:t.scrollY||t.pageYOffset);return}I.call(t,e.body,arguments[0].left!==void 0?~~arguments[0].left:t.scrollX||t.pageXOffset,arguments[0].top!==void 0?~~arguments[0].top:t.scrollY||t.pageYOffset)}},t.scrollBy=function(){if(arguments[0]!==void 0){if(u(arguments[0])){i.scrollBy.call(t,arguments[0].left!==void 0?arguments[0].left:typeof arguments[0]!="object"?arguments[0]:0,arguments[0].top!==void 0?arguments[0].top:arguments[1]!==void 0?arguments[1]:0);return}I.call(t,e.body,~~arguments[0].left+(t.scrollX||t.pageXOffset),~~arguments[0].top+(t.scrollY||t.pageYOffset))}},r.prototype.scroll=r.prototype.scrollTo=function(){if(arguments[0]===void 0)return;if(u(arguments[0])===!0){if(typeof arguments[0]=="number"&&arguments[1]===void 0)throw new SyntaxError("Value could not be converted");i.elementScroll.call(this,arguments[0].left!==void 0?~~arguments[0].left:typeof arguments[0]!="object"?~~arguments[0]:this.scrollLeft,arguments[0].top!==void 0?~~arguments[0].top:arguments[1]!==void 0?~~arguments[1]:this.scrollTop);return}let y=arguments[0].left,v=arguments[0].top;I.call(this,this,typeof y>"u"?this.scrollLeft:~~y,typeof v>"u"?this.scrollTop:~~v)},r.prototype.scrollBy=function(){if(arguments[0]!==void 0){if(u(arguments[0])===!0){i.elementScroll.call(this,arguments[0].left!==void 0?~~arguments[0].left+this.scrollLeft:~~arguments[0]+this.scrollLeft,arguments[0].top!==void 0?~~arguments[0].top+this.scrollTop:~~arguments[1]+this.scrollTop);return}this.scroll({left:~~arguments[0].left+this.scrollLeft,top:~~arguments[0].top+this.scrollTop,behavior:arguments[0].behavior})}},r.prototype.scrollIntoView=function(){if(u(arguments[0])===!0){i.scrollIntoView.call(this,arguments[0]===void 0?!0:arguments[0]);return}let y=p(this),v=y.getBoundingClientRect(),g=this.getBoundingClientRect();y!==e.body?(I.call(this,y,y.scrollLeft+g.left-v.left,y.scrollTop+g.top-v.top),t.getComputedStyle(y).position!=="fixed"&&t.scrollBy({left:v.left,top:v.top,behavior:"smooth"})):t.scrollBy({left:g.left,top:g.top,behavior:"smooth"})}}var gr=class{constructor(e=[],r){this.timeOffset=0,this.raf=null,this.actions=e,this.speed=r.speed}addAction(e){let r=this.raf===!0;if(!this.actions.length||this.actions[this.actions.length-1].delay<=e.delay)this.actions.push(e);else{let n=this.findActionIndex(e);this.actions.splice(n,0,e)}r&&(this.raf=requestAnimationFrame(this.rafCheck.bind(this)))}start(){this.timeOffset=0,this.lastTimestamp=performance.now(),this.raf=requestAnimationFrame(this.rafCheck.bind(this))}rafCheck(){let e=performance.now();for(this.timeOffset+=(e-this.lastTimestamp)*this.speed,this.lastTimestamp=e;this.actions.length;){let r=this.actions[0];if(this.timeOffset>=r.delay)this.actions.shift(),r.doAction();else break}this.actions.length>0?this.raf=requestAnimationFrame(this.rafCheck.bind(this)):this.raf=!0}clear(){this.raf&&(this.raf!==!0&&cancelAnimationFrame(this.raf),this.raf=null),this.actions.length=0}setSpeed(e){this.speed=e}isActive(){return this.raf!==null}findActionIndex(e){let r=0,n=this.actions.length-1;for(;r<=n;){let i=Math.floor((r+n)/2);if(this.actions[i].delay<e.delay)r=i+1;else if(this.actions[i].delay>e.delay)n=i-1;else return i+1}return r}};function bn(t,e){if(t.type===M.IncrementalSnapshot&&t.data.source===A.MouseMove&&t.data.positions&&t.data.positions.length){let r=t.data.positions[0].timeOffset,n=t.timestamp+r;return t.delay=n-e,n-e}return t.delay=t.timestamp-e,t.delay}function wn(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n,i,s=r.call(t),o=[];try{for(;(e===void 0||e-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(l){i={error:l}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o}var je;(function(t){t[t.NotStarted=0]="NotStarted",t[t.Running=1]="Running",t[t.Stopped=2]="Stopped"})(je||(je={}));var gi={type:"xstate.init"};function Yt(t){return t===void 0?[]:[].concat(t)}function He(t){return{type:"xstate.assign",assignment:t}}function En(t,e){return typeof(t=typeof t=="string"&&e&&e[t]?e[t]:t)=="string"?{type:t}:typeof t=="function"?{type:t.name,exec:t}:t}function xt(t){return function(e){return t===e}}function vi(t){return typeof t=="string"?{type:t}:t}function An(t,e){return{value:t,context:e,actions:[],changed:!1,matches:xt(t)}}function Nn(t,e,r){var n=e,i=!1;return[t.filter(function(s){if(s.type==="xstate.assign"){i=!0;var o=Object.assign({},n);return typeof s.assignment=="function"?o=s.assignment(n,r):Object.keys(s.assignment).forEach(function(l){o[l]=typeof s.assignment[l]=="function"?s.assignment[l](n,r):s.assignment[l]}),n=o,!1}return!0}),n,i]}function yi(t,e){e===void 0&&(e={});var r=wn(Nn(Yt(t.states[t.initial].entry).map(function(o){return En(o,e.actions)}),t.context,gi),2),n=r[0],i=r[1],s={config:t,_options:e,initialState:{value:t.initial,actions:n,context:i,matches:xt(t.initial)},transition:function(o,l){var a,c,u=typeof o=="string"?{value:o,context:t.context}:o,d=u.value,h=u.context,f=vi(l),p=t.states[d];if(p.on){var m=Yt(p.on[f.type]);try{for(var I=function(k){var H=typeof Symbol=="function"&&Symbol.iterator,S=H&&k[H],C=0;if(S)return S.call(k);if(k&&typeof k.length=="number")return{next:function(){return k&&C>=k.length&&(k=void 0),{value:k&&k[C++],done:!k}}};throw new TypeError(H?"Object is not iterable.":"Symbol.iterator is not defined.")}(m),y=I.next();!y.done;y=I.next()){var v=y.value;if(v===void 0)return An(d,h);var g=typeof v=="string"?{target:v}:v,b=g.target,E=g.actions,T=E===void 0?[]:E,D=g.cond,w=D===void 0?function(){return!0}:D,j=b===void 0,_=b??d,J=t.states[_];if(w(h,f)){var W=wn(Nn((j?Yt(T):[].concat(p.exit,T,J.entry).filter(function(k){return k})).map(function(k){return En(k,s._options.actions)}),h,f),3),G=W[0],K=W[1],L=W[2],F=b??d;return{value:F,context:K,actions:G,changed:b!==d||G.length>0||L,matches:xt(F)}}}}catch(k){a={error:k}}finally{try{y&&!y.done&&(c=I.return)&&c.call(I)}finally{if(a)throw a.error}}}return An(d,h)}};return s}var Tn=function(t,e){return t.actions.forEach(function(r){var n=r.exec;return n&&n(t.context,e)})};function Ci(t){var e=t.initialState,r=je.NotStarted,n=new Set,i={_machine:t,send:function(s){r===je.Running&&(e=t.transition(e,s),Tn(e,vi(s)),n.forEach(function(o){return o(e)}))},subscribe:function(s){return n.add(s),s(e),{unsubscribe:function(){return n.delete(s)}}},start:function(s){if(s){var o=typeof s=="object"?s:{context:t.config.context,value:s};e={value:o.value,actions:[],context:o.context,matches:xt(o.value)}}return r=je.Running,Tn(e,gi),i},stop:function(){return r=je.Stopped,n.clear(),i},get state(){return e},get status(){return r}};return i}function No(t,e){for(let r=t.length-1;r>=0;r--){let n=t[r];if(n.type===M.Meta&&n.timestamp<=e)return t.slice(r)}return t}function To(t,{getCastFn:e,applyEventsSynchronously:r,emitter:n}){let i=yi({id:"player",context:t,initial:"paused",states:{playing:{on:{PAUSE:{target:"paused",actions:["pause"]},CAST_EVENT:{target:"playing",actions:"castEvent"},END:{target:"paused",actions:["resetLastPlayedEvent","pause"]},ADD_EVENT:{target:"playing",actions:["addEvent"]}}},paused:{on:{PLAY:{target:"playing",actions:["recordTimeOffset","play"]},CAST_EVENT:{target:"paused",actions:"castEvent"},TO_LIVE:{target:"live",actions:["startLive"]},ADD_EVENT:{target:"paused",actions:["addEvent"]}}},live:{on:{ADD_EVENT:{target:"live",actions:["addEvent"]},CAST_EVENT:{target:"live",actions:["castEvent"]}}}}},{actions:{castEvent:He({lastPlayedEvent:(s,o)=>o.type==="CAST_EVENT"?o.payload.event:s.lastPlayedEvent}),recordTimeOffset:He((s,o)=>{let l=s.timeOffset;return"payload"in o&&"timeOffset"in o.payload&&(l=o.payload.timeOffset),Object.assign(Object.assign({},s),{timeOffset:l,baselineTime:s.events[0].timestamp+l})}),play(s){var o;let{timer:l,events:a,baselineTime:c,lastPlayedEvent:u}=s;l.clear();for(let p of a)bn(p,c);let d=No(a,c),h=u?.timestamp;u?.type===M.IncrementalSnapshot&&u.data.source===A.MouseMove&&(h=u.timestamp+((o=u.data.positions[0])===null||o===void 0?void 0:o.timeOffset)),c<(h||0)&&n.emit(Z.PlayBack);let f=new Array;for(let p of d)if(!(h&&h<c&&(p.timestamp<=h||p===u)))if(p.timestamp<c)f.push(p);else{let m=e(p,!1);l.addAction({doAction:()=>{m()},delay:p.delay})}r(f),n.emit(Z.Flush),l.start()},pause(s){s.timer.clear()},resetLastPlayedEvent:He(s=>Object.assign(Object.assign({},s),{lastPlayedEvent:null})),startLive:He({baselineTime:(s,o)=>(s.timer.start(),o.type==="TO_LIVE"&&o.payload.baselineTime?o.payload.baselineTime:Date.now())}),addEvent:He((s,o)=>{let{baselineTime:l,timer:a,events:c}=s;if(o.type==="ADD_EVENT"){let{event:u}=o.payload;bn(u,l);let d=c.length-1;if(!c[d]||c[d].timestamp<=u.timestamp)c.push(u);else{let p=-1,m=0;for(;m<=d;){let I=Math.floor((m+d)/2);c[I].timestamp<=u.timestamp?m=I+1:d=I-1}p===-1&&(p=m),c.splice(p,0,u)}let h=u.timestamp<l,f=e(u,h);h?f():a.isActive()&&a.addAction({doAction:()=>{f()},delay:u.delay})}return Object.assign(Object.assign({},s),{events:c})})}});return Ci(i)}function Ro(t){let e=yi({id:"speed",context:t,initial:"normal",states:{normal:{on:{FAST_FORWARD:{target:"skipping",actions:["recordSpeed","setSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}},skipping:{on:{BACK_TO_NORMAL:{target:"normal",actions:["restoreSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}}}},{actions:{setSpeed:(r,n)=>{"payload"in n&&r.timer.setSpeed(n.payload.speed)},recordSpeed:He({normalSpeed:r=>r.timer.speed}),restoreSpeed:r=>{r.timer.setSpeed(r.normalSpeed)}}});return Ci(e)}var Mo=t=>[`.${t} { background: currentColor }`,"noscript { display: none !important; }"],Rn=new Map;function Ii(t,e){let r=Rn.get(t);return r||(r=new Map,Rn.set(t,r)),r.has(e)||r.set(e,[]),r.get(e)}function Oe(t,e,r){return n=>Te(this,void 0,void 0,function*(){if(n&&typeof n=="object"&&"rr_type"in n)if(r&&(r.isUnchanged=!1),n.rr_type==="ImageBitmap"&&"args"in n){let i=yield Oe(t,e,r)(n.args);return yield createImageBitmap.apply(null,i)}else if("index"in n){if(r||e===null)return n;let{rr_type:i,index:s}=n;return Ii(e,i)[s]}else if("args"in n){let{rr_type:i,args:s}=n,o=window[i];return new o(...yield Promise.all(s.map(Oe(t,e,r))))}else{if("base64"in n)return js(n.base64);if("src"in n){let i=t.get(n.src);if(i)return i;{let s=new Image;return s.src=n.src,t.set(n.src,s),s}}else if("data"in n&&n.rr_type==="Blob"){let i=yield Promise.all(n.data.map(Oe(t,e,r)));return new Blob(i,{type:n.type})}}else if(Array.isArray(n))return yield Promise.all(n.map(Oe(t,e,r)));return n})}function ko(t,e){try{return e===Re.WebGL?t.getContext("webgl")||t.getContext("experimental-webgl"):t.getContext("webgl2")}catch{return null}}var Do=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject"];function Oo(t,e){if(!e?.constructor)return;let{name:r}=e.constructor;if(!Do.includes(r))return;let n=Ii(t,r);n.includes(e)||n.push(e)}function xo({mutation:t,target:e,type:r,imageMap:n,errorHandler:i}){return Te(this,void 0,void 0,function*(){try{let s=ko(e,r);if(!s)return;if(t.setter){s[t.property]=t.args[0];return}let o=s[t.property],l=yield Promise.all(t.args.map(Oe(n,s))),a=o.apply(s,l);Oo(s,a);let c=!1}catch(s){i(t,s)}})}function Lo({event:t,mutations:e,target:r,imageMap:n,errorHandler:i}){return Te(this,void 0,void 0,function*(){let s=r.getContext("2d");if(!s){i(e[0],new Error("Canvas context is null"));return}let o=e.map(a=>Te(this,void 0,void 0,function*(){return Promise.all(a.args.map(Oe(n,s)))}));(yield Promise.all(o)).forEach((a,c)=>{let u=e[c];try{if(u.setter){s[u.property]=u.args[0];return}let d=s[u.property];u.property==="drawImage"&&typeof u.args[0]=="string"?(n.get(t),d.apply(s,u.args)):d.apply(s,a)}catch(d){i(u,d)}})})}function Mn({event:t,mutation:e,target:r,imageMap:n,canvasEventMap:i,errorHandler:s}){return Te(this,void 0,void 0,function*(){try{let o=i.get(t)||e,l="commands"in o?o.commands:[o];if([Re.WebGL,Re.WebGL2].includes(e.type)){for(let a=0;a<l.length;a++){let c=l[a];yield xo({mutation:c,type:e.type,target:r,imageMap:n,errorHandler:s})}return}yield Lo({event:t,mutations:l,target:r,imageMap:n,errorHandler:s})}catch(o){s(e,o)}})}var Fo=10*1e3,_o=5*1e3,Bo=mi||Eo,kn="[replayer]",Kt={duration:500,lineCap:"round",lineWidth:3,strokeStyle:"red"};function Dn(t){return t.type==M.IncrementalSnapshot&&(t.data.source==A.TouchMove||t.data.source==A.MouseInteraction&&t.data.type==V.TouchStart)}var vr=class{get timer(){return this.service.state.context.timer}constructor(e,r){if(this.usingVirtualDom=!1,this.virtualDom=new Qe,this.mouseTail=null,this.tailPositions=[],this.emitter=Bo(),this.legacy_missingNodeRetryMap={},this.cache=dn(),this.imageMap=new Map,this.canvasEventMap=new Map,this.mirror=Wn(),this.styleMirror=new ut,this.firstFullSnapshot=null,this.newDocumentQueue=[],this.mousePos=null,this.touchActive=null,this.lastMouseDownEvent=null,this.lastSelectionData=null,this.constructedStyleMutations=[],this.adoptedStyleSheets=[],this.handleResize=l=>{this.iframe.style.display="inherit";for(let a of[this.mouseTail,this.iframe])a&&(a.setAttribute("width",String(l.width)),a.setAttribute("height",String(l.height)))},this.applyEventsSynchronously=l=>{for(let a of l){switch(a.type){case M.DomContentLoaded:case M.Load:case M.Custom:continue;case M.FullSnapshot:case M.Meta:case M.Plugin:case M.IncrementalSnapshot:break}this.getCastFn(a,!0)()}},this.getCastFn=(l,a=!1)=>{let c;switch(l.type){case M.DomContentLoaded:case M.Load:break;case M.Custom:c=()=>{this.emitter.emit(Z.CustomEvent,l)};break;case M.Meta:c=()=>this.emitter.emit(Z.Resize,{width:l.data.width,height:l.data.height});break;case M.FullSnapshot:c=()=>{var d;if(this.firstFullSnapshot){if(this.firstFullSnapshot===l){this.firstFullSnapshot=!0;return}}else this.firstFullSnapshot=!0;this.rebuildFullSnapshot(l,a),(d=this.iframe.contentWindow)===null||d===void 0||d.scrollTo(l.data.initialOffset),this.styleMirror.reset()};break;case M.IncrementalSnapshot:c=()=>{if(this.applyIncremental(l,a),!a&&(l===this.nextUserInteractionEvent&&(this.nextUserInteractionEvent=null,this.backToNormal()),this.config.skipInactive&&!this.nextUserInteractionEvent)){for(let d of this.service.state.context.events)if(!(d.timestamp<=l.timestamp)&&this.isUserInteraction(d)){d.delay-l.delay>Fo*this.speedService.state.context.timer.speed&&(this.nextUserInteractionEvent=d);break}if(this.nextUserInteractionEvent){let d=this.nextUserInteractionEvent.delay-l.delay,h={speed:Math.min(Math.round(d/_o),this.config.maxSpeed)};this.speedService.send({type:"FAST_FORWARD",payload:h}),this.emitter.emit(Z.SkipStart,h)}}};break}return()=>{c&&c();for(let h of this.config.plugins||[])h.handler&&h.handler(l,a,{replayer:this});this.service.send({type:"CAST_EVENT",payload:{event:l}});let d=this.service.state.context.events.length-1;if(!this.config.liveMode&&l===this.service.state.context.events[d]){let h=()=>{d<this.service.state.context.events.length-1||(this.backToNormal(),this.service.send("END"),this.emitter.emit(Z.Finish))},f=50;l.type===M.IncrementalSnapshot&&l.data.source===A.MouseMove&&l.data.positions.length&&(f+=Math.max(0,-l.data.positions[0].timeOffset)),setTimeout(h,f)}this.emitter.emit(Z.EventCast,l)}},!r?.liveMode&&e.length<2)throw new Error("Replayer need at least 2 events.");let n={speed:1,maxSpeed:360,root:document.body,loadTimeout:0,skipInactive:!1,showWarning:!0,showDebug:!1,blockClass:"rr-block",liveMode:!1,insertStyleRules:[],triggerFocus:!0,UNSAFE_replayCanvas:!1,pauseAnimation:!0,mouseTail:Kt,useVirtualDom:!0,logger:console};this.config=Object.assign({},n,r),this.handleResize=this.handleResize.bind(this),this.getCastFn=this.getCastFn.bind(this),this.applyEventsSynchronously=this.applyEventsSynchronously.bind(this),this.emitter.on(Z.Resize,this.handleResize),this.setupDom();for(let l of this.config.plugins||[])l.getMirror&&l.getMirror({nodeMirror:this.mirror});this.emitter.on(Z.Flush,()=>{if(this.usingVirtualDom){let l={mirror:this.mirror,applyCanvas:(a,c,u)=>{Mn({event:a,mutation:c,target:u,imageMap:this.imageMap,canvasEventMap:this.canvasEventMap,errorHandler:this.warnCanvasMutationFailed.bind(this)})},applyInput:this.applyInput.bind(this),applyScroll:this.applyScroll.bind(this),applyStyleSheetMutation:(a,c)=>{a.source===A.StyleSheetRule?this.applyStyleSheetRule(a,c):a.source===A.StyleDeclaration&&this.applyStyleDeclaration(a,c)},afterAppend:(a,c)=>{for(let u of this.config.plugins||[])u.onBuild&&u.onBuild(a,{id:c,replayer:this})}};if(this.iframe.contentDocument)try{Dt(this.iframe.contentDocument,this.virtualDom,l,this.virtualDom.mirror)}catch(a){console.warn(a)}if(this.virtualDom.destroyTree(),this.usingVirtualDom=!1,Object.keys(this.legacy_missingNodeRetryMap).length)for(let a in this.legacy_missingNodeRetryMap)try{let c=this.legacy_missingNodeRetryMap[a],u=Ot(c.node,this.mirror,this.virtualDom.mirror);Dt(u,c.node,l,this.virtualDom.mirror),c.node=u}catch(c){this.warn(c)}this.constructedStyleMutations.forEach(a=>{this.applyStyleSheetMutation(a)}),this.constructedStyleMutations=[],this.adoptedStyleSheets.forEach(a=>{this.applyAdoptedStyleSheet(a)}),this.adoptedStyleSheets=[]}if(this.mousePos&&(this.moveAndHover(this.mousePos.x,this.mousePos.y,this.mousePos.id,!0,this.mousePos.debugData),this.mousePos=null),this.touchActive===!0?this.mouse.classList.add("touch-active"):this.touchActive===!1&&this.mouse.classList.remove("touch-active"),this.touchActive=null,this.lastMouseDownEvent){let[l,a]=this.lastMouseDownEvent;l.dispatchEvent(a)}this.lastMouseDownEvent=null,this.lastSelectionData&&(this.applySelection(this.lastSelectionData),this.lastSelectionData=null)}),this.emitter.on(Z.PlayBack,()=>{this.firstFullSnapshot=null,this.mirror.reset(),this.styleMirror.reset()});let i=new gr([],{speed:this.config.speed});this.service=To({events:e.map(l=>r&&r.unpackFn?r.unpackFn(l):l).sort((l,a)=>l.timestamp-a.timestamp),timer:i,timeOffset:0,baselineTime:0,lastPlayedEvent:null},{getCastFn:this.getCastFn,applyEventsSynchronously:this.applyEventsSynchronously,emitter:this.emitter}),this.service.start(),this.service.subscribe(l=>{this.emitter.emit(Z.StateChange,{player:l})}),this.speedService=Ro({normalSpeed:-1,timer:i}),this.speedService.start(),this.speedService.subscribe(l=>{this.emitter.emit(Z.StateChange,{speed:l})});let s=this.service.state.context.events.find(l=>l.type===M.Meta),o=this.service.state.context.events.find(l=>l.type===M.FullSnapshot);if(s){let{width:l,height:a}=s.data;setTimeout(()=>{this.emitter.emit(Z.Resize,{width:l,height:a})},0)}o&&setTimeout(()=>{var l;this.firstFullSnapshot||(this.firstFullSnapshot=o,this.rebuildFullSnapshot(o),(l=this.iframe.contentWindow)===null||l===void 0||l.scrollTo(o.data.initialOffset))},1),this.service.state.context.events.find(Dn)&&this.mouse.classList.add("touch-device")}on(e,r){return this.emitter.on(e,r),this}off(e,r){return this.emitter.off(e,r),this}setConfig(e){Object.keys(e).forEach(r=>{e[r],this.config[r]=e[r]}),this.config.skipInactive||this.backToNormal(),typeof e.speed<"u"&&this.speedService.send({type:"SET_SPEED",payload:{speed:e.speed}}),typeof e.mouseTail<"u"&&(e.mouseTail===!1?this.mouseTail&&(this.mouseTail.style.display="none"):(this.mouseTail||(this.mouseTail=document.createElement("canvas"),this.mouseTail.width=Number.parseFloat(this.iframe.width),this.mouseTail.height=Number.parseFloat(this.iframe.height),this.mouseTail.classList.add("replayer-mouse-tail"),this.wrapper.insertBefore(this.mouseTail,this.iframe)),this.mouseTail.style.display="inherit"))}getMetaData(){let e=this.service.state.context.events[0],r=this.service.state.context.events[this.service.state.context.events.length-1];return{startTime:e.timestamp,endTime:r.timestamp,totalTime:r.timestamp-e.timestamp}}getCurrentTime(){return this.timer.timeOffset+this.getTimeOffset()}getTimeOffset(){let{baselineTime:e,events:r}=this.service.state.context;return e-r[0].timestamp}getMirror(){return this.mirror}play(e=0){var r,n;this.service.state.matches("paused")?this.service.send({type:"PLAY",payload:{timeOffset:e}}):(this.service.send({type:"PAUSE"}),this.service.send({type:"PLAY",payload:{timeOffset:e}})),(n=(r=this.iframe.contentDocument)===null||r===void 0?void 0:r.getElementsByTagName("html")[0])===null||n===void 0||n.classList.remove("rrweb-paused"),this.emitter.emit(Z.Start)}pause(e){var r,n;e===void 0&&this.service.state.matches("playing")&&this.service.send({type:"PAUSE"}),typeof e=="number"&&(this.play(e),this.service.send({type:"PAUSE"})),(n=(r=this.iframe.contentDocument)===null||r===void 0?void 0:r.getElementsByTagName("html")[0])===null||n===void 0||n.classList.add("rrweb-paused"),this.emitter.emit(Z.Pause)}resume(e=0){this.warn("The 'resume' was deprecated in 1.0. Please use 'play' method which has the same interface."),this.play(e),this.emitter.emit(Z.Resume)}destroy(){this.pause(),this.config.root.removeChild(this.wrapper),this.emitter.emit(Z.Destroy)}startLive(e){this.service.send({type:"TO_LIVE",payload:{baselineTime:e}})}addEvent(e){let r=this.config.unpackFn?this.config.unpackFn(e):e;Dn(r)&&this.mouse.classList.add("touch-device"),Promise.resolve().then(()=>this.service.send({type:"ADD_EVENT",payload:{event:r}}))}enableInteract(){this.iframe.setAttribute("scrolling","auto"),this.iframe.style.pointerEvents="auto"}disableInteract(){this.iframe.setAttribute("scrolling","no"),this.iframe.style.pointerEvents="none"}resetCache(){this.cache=dn()}setupDom(){this.wrapper=document.createElement("div"),this.wrapper.classList.add("replayer-wrapper"),this.config.root.appendChild(this.wrapper),this.mouse=document.createElement("div"),this.mouse.classList.add("replayer-mouse"),this.wrapper.appendChild(this.mouse),this.config.mouseTail!==!1&&(this.mouseTail=document.createElement("canvas"),this.mouseTail.classList.add("replayer-mouse-tail"),this.mouseTail.style.display="inherit",this.wrapper.appendChild(this.mouseTail)),this.iframe=document.createElement("iframe");let e=["allow-same-origin"];this.config.UNSAFE_replayCanvas&&e.push("allow-scripts"),this.iframe.style.display="none",this.iframe.setAttribute("sandbox",e.join(" ")),this.disableInteract(),this.wrapper.appendChild(this.iframe),this.iframe.contentWindow&&this.iframe.contentDocument&&(Ao(this.iframe.contentWindow,this.iframe.contentDocument),xr(this.iframe.contentWindow))}rebuildFullSnapshot(e,r=!1){if(!this.iframe.contentDocument)return this.warn("Looks like your replayer has been destroyed.");Object.keys(this.legacy_missingNodeRetryMap).length&&this.warn("Found unresolved missing node map",this.legacy_missingNodeRetryMap),this.legacy_missingNodeRetryMap={};let n=[],i=(l,a)=>{this.collectIframeAndAttachDocument(n,l);for(let c of this.config.plugins||[])c.onBuild&&c.onBuild(l,{id:a,replayer:this})};this.usingVirtualDom&&(this.virtualDom.destroyTree(),this.usingVirtualDom=!1),this.mirror.reset(),ks(e.data.node,{doc:this.iframe.contentDocument,afterAppend:i,cache:this.cache,mirror:this.mirror}),i(this.iframe.contentDocument,e.data.node.id);for(let{mutationInQueue:l,builtNode:a}of n)this.attachDocumentToIframe(l,a),this.newDocumentQueue=this.newDocumentQueue.filter(c=>c!==l);let{documentElement:s,head:o}=this.iframe.contentDocument;this.insertStyleRules(s,o),this.service.state.matches("playing")||this.iframe.contentDocument.getElementsByTagName("html")[0].classList.add("rrweb-paused"),this.emitter.emit(Z.FullsnapshotRebuilded,e),r||this.waitForStylesheetLoad(),this.config.UNSAFE_replayCanvas&&this.preloadAllImages()}insertStyleRules(e,r){var n;let i=Mo(this.config.blockClass).concat(this.config.insertStyleRules);if(this.config.pauseAnimation&&i.push("html.rrweb-paused *, html.rrweb-paused *:before, html.rrweb-paused *:after { animation-play-state: paused !important; }"),this.usingVirtualDom){let s=this.virtualDom.createElement("style");this.virtualDom.mirror.add(s,pi(s,this.virtualDom.unserializedId)),e.insertBefore(s,r),s.rules.push({source:A.StyleSheetRule,adds:i.map((o,l)=>({rule:o,index:l}))})}else{let s=document.createElement("style");e.insertBefore(s,r);for(let o=0;o<i.length;o++)(n=s.sheet)===null||n===void 0||n.insertRule(i[o],o)}}attachDocumentToIframe(e,r){let n=this.usingVirtualDom?this.virtualDom.mirror:this.mirror,i=[],s=(o,l)=>{this.collectIframeAndAttachDocument(i,o);let a=n.getMeta(o);if(a?.type===x.Element&&a?.tagName.toUpperCase()==="HTML"){let{documentElement:c,head:u}=r.contentDocument;this.insertStyleRules(c,u)}if(!this.usingVirtualDom)for(let c of this.config.plugins||[])c.onBuild&&c.onBuild(o,{id:l,replayer:this})};ot(e.node,{doc:r.contentDocument,mirror:n,hackCss:!0,skipChild:!1,afterAppend:s,cache:this.cache}),s(r.contentDocument,e.node.id);for(let{mutationInQueue:o,builtNode:l}of i)this.attachDocumentToIframe(o,l),this.newDocumentQueue=this.newDocumentQueue.filter(a=>a!==o)}collectIframeAndAttachDocument(e,r){if(Je(r,this.mirror)){let n=this.newDocumentQueue.find(i=>i.parentId===this.mirror.getId(r));n&&e.push({mutationInQueue:n,builtNode:r})}}waitForStylesheetLoad(){var e;let r=(e=this.iframe.contentDocument)===null||e===void 0?void 0:e.head;if(r){let n=new Set,i,s=this.service.state,o=()=>{s=this.service.state};this.emitter.on(Z.Start,o),this.emitter.on(Z.Pause,o);let l=()=>{this.emitter.off(Z.Start,o),this.emitter.off(Z.Pause,o)};r.querySelectorAll('link[rel="stylesheet"]').forEach(a=>{a.sheet||(n.add(a),a.addEventListener("load",()=>{n.delete(a),n.size===0&&i!==-1&&(s.matches("playing")&&this.play(this.getCurrentTime()),this.emitter.emit(Z.LoadStylesheetEnd),i&&clearTimeout(i),l())}))}),n.size>0&&(this.service.send({type:"PAUSE"}),this.emitter.emit(Z.LoadStylesheetStart),i=setTimeout(()=>{s.matches("playing")&&this.play(this.getCurrentTime()),i=-1,l()},this.config.loadTimeout))}}preloadAllImages(){return Te(this,void 0,void 0,function*(){this.service.state;let e=()=>{this.service.state};this.emitter.on(Z.Start,e),this.emitter.on(Z.Pause,e);let r=[];for(let n of this.service.state.context.events)n.type===M.IncrementalSnapshot&&n.data.source===A.CanvasMutation&&(r.push(this.deserializeAndPreloadCanvasEvents(n.data,n)),("commands"in n.data?n.data.commands:[n.data]).forEach(s=>{this.preloadImages(s,n)}));return Promise.all(r)})}preloadImages(e,r){if(e.property==="drawImage"&&typeof e.args[0]=="string"&&!this.imageMap.has(r)){let n=document.createElement("canvas"),i=n.getContext("2d"),s=i?.createImageData(n.width,n.height);s?.data,JSON.parse(e.args[0]),i?.putImageData(s,0,0)}}deserializeAndPreloadCanvasEvents(e,r){return Te(this,void 0,void 0,function*(){if(!this.canvasEventMap.has(r)){let n={isUnchanged:!0};if("commands"in e){let i=yield Promise.all(e.commands.map(s=>Te(this,void 0,void 0,function*(){let o=yield Promise.all(s.args.map(Oe(this.imageMap,null,n)));return Object.assign(Object.assign({},s),{args:o})})));n.isUnchanged===!1&&this.canvasEventMap.set(r,Object.assign(Object.assign({},e),{commands:i}))}else{let i=yield Promise.all(e.args.map(Oe(this.imageMap,null,n)));n.isUnchanged===!1&&this.canvasEventMap.set(r,Object.assign(Object.assign({},e),{args:i}))}}})}applyIncremental(e,r){var n,i,s;let{data:o}=e;switch(o.source){case A.Mutation:{try{this.applyMutation(o,r)}catch(l){this.warn(`Exception in mutation ${l.message||l}`,o)}break}case A.Drag:case A.TouchMove:case A.MouseMove:if(r){let l=o.positions[o.positions.length-1];this.mousePos={x:l.x,y:l.y,id:l.id,debugData:o}}else o.positions.forEach(l=>{let a={doAction:()=>{this.moveAndHover(l.x,l.y,l.id,r,o)},delay:l.timeOffset+e.timestamp-this.service.state.context.baselineTime};this.timer.addAction(a)}),this.timer.addAction({doAction(){},delay:e.delay-((n=o.positions[0])===null||n===void 0?void 0:n.timeOffset)});break;case A.MouseInteraction:{if(o.id===-1)break;let l=new Event(xe(V[o.type])),a=this.mirror.getNode(o.id);if(!a)return this.debugNodeNotFound(o,o.id);this.emitter.emit(Z.MouseInteraction,{type:o.type,target:a});let{triggerFocus:c}=this.config;switch(o.type){case V.Blur:"blur"in a&&a.blur();break;case V.Focus:c&&a.focus&&a.focus({preventScroll:!0});break;case V.Click:case V.TouchStart:case V.TouchEnd:case V.MouseDown:case V.MouseUp:r?(o.type===V.TouchStart?this.touchActive=!0:o.type===V.TouchEnd&&(this.touchActive=!1),o.type===V.MouseDown?this.lastMouseDownEvent=[a,l]:o.type===V.MouseUp&&(this.lastMouseDownEvent=null),this.mousePos={x:o.x,y:o.y,id:o.id,debugData:o}):(o.type===V.TouchStart&&(this.tailPositions.length=0),this.moveAndHover(o.x,o.y,o.id,r,o),o.type===V.Click?(this.mouse.classList.remove("active"),this.mouse.offsetWidth,this.mouse.classList.add("active")):o.type===V.TouchStart?(this.mouse.offsetWidth,this.mouse.classList.add("touch-active")):o.type===V.TouchEnd?this.mouse.classList.remove("touch-active"):a.dispatchEvent(l));break;case V.TouchCancel:r?this.touchActive=!1:this.mouse.classList.remove("touch-active");break;default:a.dispatchEvent(l)}break}case A.Scroll:{if(o.id===-1)break;if(this.usingVirtualDom){let l=this.virtualDom.mirror.getNode(o.id);if(!l)return this.debugNodeNotFound(o,o.id);l.scrollData=o;break}this.applyScroll(o,r);break}case A.ViewportResize:this.emitter.emit(Z.Resize,{width:o.width,height:o.height});break;case A.Input:{if(o.id===-1)break;if(this.usingVirtualDom){let l=this.virtualDom.mirror.getNode(o.id);if(!l)return this.debugNodeNotFound(o,o.id);l.inputData=o;break}this.applyInput(o);break}case A.MediaInteraction:{let l=this.usingVirtualDom?this.virtualDom.mirror.getNode(o.id):this.mirror.getNode(o.id);if(!l)return this.debugNodeNotFound(o,o.id);let a=l;try{o.currentTime!==void 0&&(a.currentTime=o.currentTime),o.volume!==void 0&&(a.volume=o.volume),o.muted!==void 0&&(a.muted=o.muted),o.type===1&&a.pause(),o.type===0&&a.play(),o.type===4&&(a.playbackRate=o.playbackRate)}catch(c){this.warn(`Failed to replay media interactions: ${c.message||c}`)}break}case A.StyleSheetRule:case A.StyleDeclaration:{this.usingVirtualDom?o.styleId?this.constructedStyleMutations.push(o):o.id&&((i=this.virtualDom.mirror.getNode(o.id))===null||i===void 0||i.rules.push(o)):this.applyStyleSheetMutation(o);break}case A.CanvasMutation:{if(!this.config.UNSAFE_replayCanvas)return;if(this.usingVirtualDom){let l=this.virtualDom.mirror.getNode(o.id);if(!l)return this.debugNodeNotFound(o,o.id);l.canvasMutations.push({event:e,mutation:o})}else{let l=this.mirror.getNode(o.id);if(!l)return this.debugNodeNotFound(o,o.id);Mn({event:e,mutation:o,target:l,imageMap:this.imageMap,canvasEventMap:this.canvasEventMap,errorHandler:this.warnCanvasMutationFailed.bind(this)})}break}case A.Font:{try{let l=new FontFace(o.family,o.buffer?new Uint8Array(JSON.parse(o.fontSource)):o.fontSource,o.descriptors);(s=this.iframe.contentDocument)===null||s===void 0||s.fonts.add(l)}catch(l){this.warn(l)}break}case A.Selection:{if(r){this.lastSelectionData=o;break}this.applySelection(o);break}case A.AdoptedStyleSheet:{this.usingVirtualDom?this.adoptedStyleSheets.push(o):this.applyAdoptedStyleSheet(o);break}}}applyMutation(e,r){if(this.config.useVirtualDom&&!this.usingVirtualDom&&r&&(this.usingVirtualDom=!0,bo(this.iframe.contentDocument,this.mirror,this.virtualDom),Object.keys(this.legacy_missingNodeRetryMap).length))for(let c in this.legacy_missingNodeRetryMap)try{let u=this.legacy_missingNodeRetryMap[c],d=fi(u.node,this.virtualDom,this.mirror);d&&(u.node=d)}catch(u){this.warn(u)}let n=this.usingVirtualDom?this.virtualDom.mirror:this.mirror;e.removes=e.removes.filter(c=>n.getNode(c.id)?!0:(this.warnNodeNotFound(e,c.id),!1)),e.removes.forEach(c=>{var u;let d=n.getNode(c.id);if(!d)return;let h=n.getNode(c.parentId);if(!h)return this.warnNodeNotFound(e,c.parentId);if(c.isShadow&&De(h)&&(h=h.shadowRoot),n.removeNodeFromMap(d),h)try{h.removeChild(d),this.usingVirtualDom&&d.nodeName==="#text"&&h.nodeName==="STYLE"&&((u=h.rules)===null||u===void 0?void 0:u.length)>0&&(h.rules=[])}catch(f){if(f instanceof DOMException)this.warn("parent could not remove child in mutation",h,d,e);else throw f}});let i=Object.assign({},this.legacy_missingNodeRetryMap),s=[],o=c=>{let u=null;return c.nextId&&(u=n.getNode(c.nextId)),c.nextId!==null&&c.nextId!==void 0&&c.nextId!==-1&&!u},l=c=>{var u,d;if(!this.iframe.contentDocument)return this.warn("Looks like your replayer has been destroyed.");let h=n.getNode(c.parentId);if(!h)return c.node.type===x.Document?this.newDocumentQueue.push(c):s.push(c);c.node.isShadow&&(De(h)||h.attachShadow({mode:"open"}),h=h.shadowRoot);let f=null,p=null;if(c.previousId&&(f=n.getNode(c.previousId)),c.nextId&&(p=n.getNode(c.nextId)),o(c))return s.push(c);if(c.node.rootId&&!n.getNode(c.node.rootId))return;let m=c.node.rootId?n.getNode(c.node.rootId):this.usingVirtualDom?this.virtualDom:this.iframe.contentDocument;if(Je(h,n)){this.attachDocumentToIframe(c,h);return}let I=(g,b)=>{if(!this.usingVirtualDom)for(let E of this.config.plugins||[])E.onBuild&&E.onBuild(g,{id:b,replayer:this})},y=ot(c.node,{doc:m,mirror:n,skipChild:!0,hackCss:!0,cache:this.cache,afterAppend:I});if(c.previousId===-1||c.nextId===-1){i[c.node.id]={node:y,mutation:c};return}let v=n.getMeta(h);if(v&&v.type===x.Element&&v.tagName==="textarea"&&c.node.type===x.Text){let g=Array.isArray(h.childNodes)?h.childNodes:Array.from(h.childNodes);for(let b of g)b.nodeType===h.TEXT_NODE&&h.removeChild(b)}else if(v?.type===x.Document){let g=h;c.node.type===x.DocumentType&&((u=g.childNodes[0])===null||u===void 0?void 0:u.nodeType)===Node.DOCUMENT_TYPE_NODE&&g.removeChild(g.childNodes[0]),y.nodeName==="HTML"&&g.documentElement&&g.removeChild(g.documentElement)}if(f&&f.nextSibling&&f.nextSibling.parentNode?h.insertBefore(y,f.nextSibling):p&&p.parentNode?h.contains(p)?h.insertBefore(y,p):h.insertBefore(y,null):h.appendChild(y),I(y,c.node.id),this.usingVirtualDom&&y.nodeName==="#text"&&h.nodeName==="STYLE"&&((d=h.rules)===null||d===void 0?void 0:d.length)>0&&(h.rules=[]),Je(y,this.mirror)){let g=this.mirror.getId(y),b=this.newDocumentQueue.find(E=>E.parentId===g);b&&(this.attachDocumentToIframe(b,y),this.newDocumentQueue=this.newDocumentQueue.filter(E=>E!==b))}(c.previousId||c.nextId)&&this.legacy_resolveMissingNode(i,h,y,c)};e.adds.forEach(c=>{l(c)});let a=Date.now();for(;s.length;){let c=Yn(s);if(s.length=0,Date.now()-a>500){this.warn("Timeout in the loop, please check the resolve tree data:",c);break}for(let u of c)n.getNode(u.value.parentId)?Lr(u,h=>{l(h)}):this.debug("Drop resolve tree since there is no parent for the root node.",u)}Object.keys(i).length&&Object.assign(this.legacy_missingNodeRetryMap,i),Kn(e.texts).forEach(c=>{var u;let d=n.getNode(c.id);if(!d)return e.removes.find(h=>h.id===c.id)?void 0:this.warnNodeNotFound(e,c.id);if(d.textContent=c.value,this.usingVirtualDom){let h=d.parentNode;((u=h?.rules)===null||u===void 0?void 0:u.length)>0&&(h.rules=[])}}),e.attributes.forEach(c=>{let u=n.getNode(c.id);if(!u)return e.removes.find(d=>d.id===c.id)?void 0:this.warnNodeNotFound(e,c.id);for(let d in c.attributes)if(typeof d=="string"){let h=c.attributes[d];if(h===null)u.removeAttribute(d);else if(typeof h=="string")try{if(d==="_cssText"&&(u.nodeName==="LINK"||u.nodeName==="STYLE"))try{let f=n.getMeta(u);Object.assign(f.attributes,c.attributes);let p=ot(f,{doc:u.ownerDocument,mirror:n,skipChild:!0,hackCss:!0,cache:this.cache}),m=u.nextSibling,I=u.parentNode;if(p&&I){I.removeChild(u),I.insertBefore(p,m),n.replace(c.id,p);break}}catch{}u.setAttribute(d,h)}catch(f){this.warn("An error occurred may due to the checkout feature.",f)}else if(d==="style"){let f=h,p=u;for(let m in f)if(f[m]===!1)p.style.removeProperty(m);else if(f[m]instanceof Array){let I=f[m];p.style.setProperty(m,I[0],I[1])}else{let I=f[m];p.style.setProperty(m,I)}}}})}applyScroll(e,r){var n,i;let s=this.mirror.getNode(e.id);if(!s)return this.debugNodeNotFound(e,e.id);let o=this.mirror.getMeta(s);if(s===this.iframe.contentDocument)(n=this.iframe.contentWindow)===null||n===void 0||n.scrollTo({top:e.y,left:e.x,behavior:r?"auto":"smooth"});else if(o?.type===x.Document)(i=s.defaultView)===null||i===void 0||i.scrollTo({top:e.y,left:e.x,behavior:r?"auto":"smooth"});else try{s.scrollTo({top:e.y,left:e.x,behavior:r?"auto":"smooth"})}catch{}}applyInput(e){let r=this.mirror.getNode(e.id);if(!r)return this.debugNodeNotFound(e,e.id);try{r.checked=e.isChecked,r.value=e.text}catch{}}applySelection(e){try{let r=new Set,n=e.ranges.map(({start:i,startOffset:s,end:o,endOffset:l})=>{let a=this.mirror.getNode(i),c=this.mirror.getNode(o);if(!a||!c)return;let u=new Range;u.setStart(a,s),u.setEnd(c,l);let d=a.ownerDocument,h=d?.getSelection();return h&&r.add(h),{range:u,selection:h}});r.forEach(i=>i.removeAllRanges()),n.forEach(i=>{var s;return i&&((s=i.selection)===null||s===void 0?void 0:s.addRange(i.range))})}catch{}}applyStyleSheetMutation(e){var r;let n=null;e.styleId?n=this.styleMirror.getStyle(e.styleId):e.id&&(n=((r=this.mirror.getNode(e.id))===null||r===void 0?void 0:r.sheet)||null),n&&(e.source===A.StyleSheetRule?this.applyStyleSheetRule(e,n):e.source===A.StyleDeclaration&&this.applyStyleDeclaration(e,n))}applyStyleSheetRule(e,r){var n,i,s,o;if((n=e.adds)===null||n===void 0||n.forEach(({rule:l,index:a})=>{try{if(Array.isArray(a)){let{positions:c,index:u}=$t(a);Ye(r.cssRules,c).insertRule(l,u)}else{let c=a===void 0?void 0:Math.min(a,r.cssRules.length);r?.insertRule(l,c)}}catch{}}),(i=e.removes)===null||i===void 0||i.forEach(({index:l})=>{try{if(Array.isArray(l)){let{positions:a,index:c}=$t(l);Ye(r.cssRules,a).deleteRule(c||0)}else r?.deleteRule(l)}catch{}}),e.replace)try{(s=r.replace)===null||s===void 0||s.call(r,e.replace)}catch{}if(e.replaceSync)try{(o=r.replaceSync)===null||o===void 0||o.call(r,e.replaceSync)}catch{}}applyStyleDeclaration(e,r){e.set&&Ye(r.rules,e.index).style.setProperty(e.set.property,e.set.value,e.set.priority),e.remove&&Ye(r.rules,e.index).style.removeProperty(e.remove.property)}applyAdoptedStyleSheet(e){var r;let n=this.mirror.getNode(e.id);if(!n)return;(r=e.styles)===null||r===void 0||r.forEach(l=>{var a;let c=null,u=null;if(De(n)?u=((a=n.ownerDocument)===null||a===void 0?void 0:a.defaultView)||null:n.nodeName==="#document"&&(u=n.defaultView),!!u)try{c=new u.CSSStyleSheet,this.styleMirror.add(c,l.styleId),this.applyStyleSheetRule({source:A.StyleSheetRule,adds:l.rules},c)}catch{}});let i=10,s=0,o=(l,a)=>{let c=a.map(u=>this.styleMirror.getStyle(u)).filter(u=>u!==null);De(l)?l.shadowRoot.adoptedStyleSheets=c:l.nodeName==="#document"&&(l.adoptedStyleSheets=c),c.length!==a.length&&s<i&&(setTimeout(()=>o(l,a),0+100*s),s++)};o(n,e.styleIds)}legacy_resolveMissingNode(e,r,n,i){let{previousId:s,nextId:o}=i,l=s&&e[s],a=o&&e[o];if(l){let{node:c,mutation:u}=l;r.insertBefore(c,n),delete e[u.node.id],delete this.legacy_missingNodeRetryMap[u.node.id],(u.previousId||u.nextId)&&this.legacy_resolveMissingNode(e,r,c,u)}if(a){let{node:c,mutation:u}=a;r.insertBefore(c,n.nextSibling),delete e[u.node.id],delete this.legacy_missingNodeRetryMap[u.node.id],(u.previousId||u.nextId)&&this.legacy_resolveMissingNode(e,r,c,u)}}moveAndHover(e,r,n,i,s){let o=this.mirror.getNode(n);if(!o)return this.debugNodeNotFound(s,n);let l=_r(o,this.iframe),a=e*l.absoluteScale+l.x,c=r*l.absoluteScale+l.y;this.mouse.style.left=`${a}px`,this.mouse.style.top=`${c}px`,i||this.drawMouseTail({x:a,y:c}),this.hoverElements(o)}drawMouseTail(e){if(!this.mouseTail)return;let{lineCap:r,lineWidth:n,strokeStyle:i,duration:s}=this.config.mouseTail===!0?Kt:Object.assign({},Kt,this.config.mouseTail),o=()=>{if(!this.mouseTail)return;let l=this.mouseTail.getContext("2d");!l||!this.tailPositions.length||(l.clearRect(0,0,this.mouseTail.width,this.mouseTail.height),l.beginPath(),l.lineWidth=n,l.lineCap=r,l.strokeStyle=i,l.moveTo(this.tailPositions[0].x,this.tailPositions[0].y),this.tailPositions.forEach(a=>l.lineTo(a.x,a.y)),l.stroke())};this.tailPositions.push(e),o(),setTimeout(()=>{this.tailPositions=this.tailPositions.filter(l=>l!==e),o()},s/this.speedService.state.context.timer.speed)}hoverElements(e){var r;(r=this.lastHoveredRootNode||this.iframe.contentDocument)===null||r===void 0||r.querySelectorAll(".\\:hover").forEach(i=>{i.classList.remove(":hover")}),this.lastHoveredRootNode=e.getRootNode();let n=e;for(;n;)n.classList&&n.classList.add(":hover"),n=n.parentElement}isUserInteraction(e){return e.type!==M.IncrementalSnapshot?!1:e.data.source>A.Mutation&&e.data.source<=A.Input}backToNormal(){this.nextUserInteractionEvent=null,!this.speedService.state.matches("normal")&&(this.speedService.send({type:"BACK_TO_NORMAL"}),this.emitter.emit(Z.SkipEnd,{speed:this.speedService.state.context.normalSpeed}))}warnNodeNotFound(e,r){this.warn(`Node with id '${r}' not found. `,e)}warnCanvasMutationFailed(e,r){this.warn("Has error on canvas update",r,"canvas mutation:",e)}debugNodeNotFound(e,r){this.debug(`Node with id '${r}' not found. `,e)}warn(...e){this.config.showWarning&&this.config.logger.warn(kn,...e)}debug(...e){this.config.showDebug&&this.config.logger.log(kn,...e)}},{addCustomEvent:Po}=Pe,{freezePage:Wo}=Pe,oe=Uint8Array,de=Uint16Array,dt=Uint32Array,Lt=new oe([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Ft=new oe([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),yr=new oe([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Si=function(t,e){for(var r=new de(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var i=new dt(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)i[s]=s-r[n]<<5|n;return[r,i]},bi=Si(Lt,2),wi=bi[0],Cr=bi[1];wi[28]=258,Cr[258]=28;var Ei=Si(Ft,0),Uo=Ei[0],On=Ei[1],Ir=new de(32768);for(z=0;z<32768;++z)Ee=(z&43690)>>>1|(z&21845)<<1,Ee=(Ee&52428)>>>2|(Ee&13107)<<2,Ee=(Ee&61680)>>>4|(Ee&3855)<<4,Ir[z]=((Ee&65280)>>>8|(Ee&255)<<8)>>>1;var Ee,z,Ce=function(t,e,r){for(var n=t.length,i=0,s=new de(e);i<n;++i)++s[t[i]-1];var o=new de(e);for(i=0;i<e;++i)o[i]=o[i-1]+s[i-1]<<1;var l;if(r){l=new de(1<<e);var a=15-e;for(i=0;i<n;++i)if(t[i])for(var c=i<<4|t[i],u=e-t[i],d=o[t[i]-1]++<<u,h=d|(1<<u)-1;d<=h;++d)l[Ir[d]>>>a]=c}else for(l=new de(n),i=0;i<n;++i)l[i]=Ir[o[t[i]-1]++]>>>15-t[i];return l},Le=new oe(288);for(z=0;z<144;++z)Le[z]=8;var z;for(z=144;z<256;++z)Le[z]=9;var z;for(z=256;z<280;++z)Le[z]=7;var z;for(z=280;z<288;++z)Le[z]=8;var z,ht=new oe(32);for(z=0;z<32;++z)ht[z]=5;var z,Vo=Ce(Le,9,0),Go=Ce(Le,9,1),Ho=Ce(ht,5,0),Zo=Ce(ht,5,1),jt=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},ve=function(t,e,r){var n=e/8>>0;return(t[n]|t[n+1]<<8)>>>(e&7)&r},Jt=function(t,e){var r=e/8>>0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>>(e&7)},Vr=function(t){return(t/8>>0)+(t&7&&1)},Gr=function(t,e,r){(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length);var n=new(t instanceof de?de:t instanceof dt?dt:oe)(r-e);return n.set(t.subarray(e,r)),n},zo=function(t,e,r){var n=t.length,i=!e||r,s=!r||r.i;r||(r={}),e||(e=new oe(n*3));var o=function(ae){var le=e.length;if(ae>le){var he=new oe(Math.max(le*2,ae));he.set(e),e=he}},l=r.f||0,a=r.p||0,c=r.b||0,u=r.l,d=r.d,h=r.m,f=r.n,p=n*8;do{if(!u){r.f=l=ve(t,a,1);var m=ve(t,a+1,3);if(a+=3,m)if(m==1)u=Go,d=Zo,h=9,f=5;else if(m==2){var g=ve(t,a,31)+257,b=ve(t,a+10,15)+4,E=g+ve(t,a+5,31)+1;a+=14;for(var T=new oe(E),D=new oe(19),w=0;w<b;++w)D[yr[w]]=ve(t,a+w*3,7);a+=b*3;var j=jt(D),_=(1<<j)-1;if(!s&&a+E*(j+7)>p)break;for(var J=Ce(D,j,1),w=0;w<E;){var W=J[ve(t,a,_)];a+=W&15;var I=W>>>4;if(I<16)T[w++]=I;else{var G=0,K=0;for(I==16?(K=3+ve(t,a,3),a+=2,G=T[w-1]):I==17?(K=3+ve(t,a,7),a+=3):I==18&&(K=11+ve(t,a,127),a+=7);K--;)T[w++]=G}}var L=T.subarray(0,g),F=T.subarray(g);h=jt(L),f=jt(F),u=Ce(L,h,1),d=Ce(F,f,1)}else throw"invalid block type";else{var I=Vr(a)+4,y=t[I-4]|t[I-3]<<8,v=I+y;if(v>n){if(s)throw"unexpected EOF";break}i&&o(c+y),e.set(t.subarray(I,v),c),r.b=c+=y,r.p=a=v*8;continue}if(a>p)throw"unexpected EOF"}i&&o(c+131072);for(var k=(1<<h)-1,H=(1<<f)-1,S=h+f+18;s||a+S<p;){var G=u[Jt(t,a)&k],C=G>>>4;if(a+=G&15,a>p)throw"unexpected EOF";if(!G)throw"invalid length/literal";if(C<256)e[c++]=C;else if(C==256){u=null;break}else{var N=C-254;if(C>264){var w=C-257,R=Lt[w];N=ve(t,a,(1<<R)-1)+wi[w],a+=R}var Y=d[Jt(t,a)&H],Q=Y>>>4;if(!Y)throw"invalid distance";a+=Y&15;var F=Uo[Q];if(Q>3){var R=Ft[Q];F+=Jt(t,a)&(1<<R)-1,a+=R}if(a>p)throw"unexpected EOF";i&&o(c+131072);for(var ee=c+N;c<ee;c+=4)e[c]=e[c-F],e[c+1]=e[c+1-F],e[c+2]=e[c+2-F],e[c+3]=e[c+3-F];c=ee}}r.l=u,r.p=a,r.b=c,u&&(l=1,r.m=h,r.d=d,r.n=f)}while(!l);return c==e.length?e:Gr(e,0,c)},Ae=function(t,e,r){r<<=e&7;var n=e/8>>0;t[n]|=r,t[n+1]|=r>>>8},tt=function(t,e,r){r<<=e&7;var n=e/8>>0;t[n]|=r,t[n+1]|=r>>>8,t[n+2]|=r>>>16},Xt=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var i=r.length,s=r.slice();if(!i)return[new oe(0),0];if(i==1){var o=new oe(r[0].s+1);return o[r[0].s]=1,[o,1]}r.sort(function(E,T){return E.f-T.f}),r.push({s:-1,f:25001});var l=r[0],a=r[1],c=0,u=1,d=2;for(r[0]={s:-1,f:l.f+a.f,l,r:a};u!=i-1;)l=r[r[c].f<r[d].f?c++:d++],a=r[c!=u&&r[c].f<r[d].f?c++:d++],r[u++]={s:-1,f:l.f+a.f,l,r:a};for(var h=s[0].s,n=1;n<i;++n)s[n].s>h&&(h=s[n].s);var f=new de(h+1),p=Sr(r[u-1],f,0);if(p>e){var n=0,m=0,I=p-e,y=1<<I;for(s.sort(function(T,D){return f[D.s]-f[T.s]||T.f-D.f});n<i;++n){var v=s[n].s;if(f[v]>e)m+=y-(1<<p-f[v]),f[v]=e;else break}for(m>>>=I;m>0;){var g=s[n].s;f[g]<e?m-=1<<e-f[g]++-1:++n}for(;n>=0&&m;--n){var b=s[n].s;f[b]==e&&(--f[b],++m)}p=e}return[new oe(f),p]},Sr=function(t,e,r){return t.s==-1?Math.max(Sr(t.l,e,r+1),Sr(t.r,e,r+1)):e[t.s]=r},xn=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new de(++e),n=0,i=t[0],s=1,o=function(a){r[n++]=a},l=1;l<=e;++l)if(t[l]==i&&l!=e)++s;else{if(!i&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(i),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(i);s=1,i=t[l]}return[r.subarray(0,n),e]},rt=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},wt=function(t,e,r){var n=r.length,i=Vr(e+2);t[i]=n&255,t[i+1]=n>>>8,t[i+2]=t[i]^255,t[i+3]=t[i+1]^255;for(var s=0;s<n;++s)t[i+s+4]=r[s];return(i+4+n)*8},Ln=function(t,e,r,n,i,s,o,l,a,c,u){Ae(e,u++,r),++i[256];for(var d=Xt(i,15),h=d[0],f=d[1],p=Xt(s,15),m=p[0],I=p[1],y=xn(h),v=y[0],g=y[1],b=xn(m),E=b[0],T=b[1],D=new de(19),w=0;w<v.length;++w)D[v[w]&31]++;for(var w=0;w<E.length;++w)D[E[w]&31]++;for(var j=Xt(D,7),_=j[0],J=j[1],W=19;W>4&&!_[yr[W-1]];--W);var G=c+5<<3,K=rt(i,Le)+rt(s,ht)+o,L=rt(i,h)+rt(s,m)+o+14+3*W+rt(D,_)+(2*D[16]+3*D[17]+7*D[18]);if(G<=K&&G<=L)return wt(e,u,t.subarray(a,a+c));var F,k,H,S;if(Ae(e,u,1+(L<K)),u+=2,L<K){F=Ce(h,f,0),k=h,H=Ce(m,I,0),S=m;var C=Ce(_,J,0);Ae(e,u,g-257),Ae(e,u+5,T-1),Ae(e,u+10,W-4),u+=14;for(var w=0;w<W;++w)Ae(e,u+3*w,_[yr[w]]);u+=3*W;for(var N=[v,E],R=0;R<2;++R)for(var Y=N[R],w=0;w<Y.length;++w){var Q=Y[w]&31;Ae(e,u,C[Q]),u+=_[Q],Q>15&&(Ae(e,u,Y[w]>>>5&127),u+=Y[w]>>>12)}}else F=Vo,k=Le,H=Ho,S=ht;for(var w=0;w<l;++w)if(n[w]>255){var Q=n[w]>>>18&31;tt(e,u,F[Q+257]),u+=k[Q+257],Q>7&&(Ae(e,u,n[w]>>>23&31),u+=Lt[Q]);var ee=n[w]&31;tt(e,u,H[ee]),u+=S[ee],ee>3&&(tt(e,u,n[w]>>>5&8191),u+=Ft[ee])}else tt(e,u,F[n[w]]),u+=k[n[w]];return tt(e,u,F[256]),u+k[256]},Yo=new dt([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Ko=new oe(0),jo=function(t,e,r,n,i,s){var o=t.length,l=new oe(n+o+5*(1+Math.floor(o/7e3))+i),a=l.subarray(n,l.length-i),c=0;if(!e||o<8)for(var u=0;u<=o;u+=65535){var d=u+65535;d<o?c=wt(a,c,t.subarray(u,d)):(a[u]=s,c=wt(a,c,t.subarray(u,o)))}else{for(var h=Yo[e-1],f=h>>>13,p=h&8191,m=(1<<r)-1,I=new de(32768),y=new de(m+1),v=Math.ceil(r/3),g=2*v,b=function(ge){return(t[ge]^t[ge+1]<<v^t[ge+2]<<g)&m},E=new dt(25e3),T=new de(288),D=new de(32),w=0,j=0,u=0,_=0,J=0,W=0;u<o;++u){var G=b(u),K=u&32767,L=y[G];if(I[K]=L,y[G]=K,J<=u){var F=o-u;if((w>7e3||_>24576)&&F>423){c=Ln(t,a,0,E,T,D,j,_,W,u-W,c),_=w=j=0,W=u;for(var k=0;k<286;++k)T[k]=0;for(var k=0;k<30;++k)D[k]=0}var H=2,S=0,C=p,N=K-L&32767;if(F>2&&G==b(u-N))for(var R=Math.min(f,F)-1,Y=Math.min(32767,u),Q=Math.min(258,F);N<=Y&&--C&&K!=L;){if(t[u+H]==t[u+H-N]){for(var ee=0;ee<Q&&t[u+ee]==t[u+ee-N];++ee);if(ee>H){if(H=ee,S=N,ee>R)break;for(var ae=Math.min(N,ee-2),le=0,k=0;k<ae;++k){var he=u-N+k+32768&32767,fe=I[he],O=he-fe+32768&32767;O>le&&(le=O,L=he)}}}K=L,L=I[K],N+=K-L+32768&32767}if(S){E[_++]=268435456|Cr[H]<<18|On[S];var se=Cr[H]&31,U=On[S]&31;j+=Lt[se]+Ft[U],++T[257+se],++D[U],J=u+H,++w}else E[_++]=t[u],++T[t[u]]}}c=Ln(t,a,s,E,T,D,j,_,W,u-W,c),s||(c=wt(a,c,Ko))}return Gr(l,0,n+Vr(c)+i)},Jo=function(){var t=1,e=0;return{p:function(r){for(var n=t,i=e,s=r.length,o=0;o!=s;){for(var l=Math.min(o+5552,s);o<l;++o)n+=r[o],i+=n;n%=65521,i%=65521}t=n,e=i},d:function(){return(t>>>8<<16|(e&255)<<8|e>>>8)+((t&255)<<23)*2}}},Xo=function(t,e,r,n,i){return jo(t,e.level==null?6:e.level,e.mem==null?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):12+e.mem,r,n,!i)},Qo=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},qo=function(t,e){var r=e.level,n=r==0?0:r<6?1:r==9?3:2;t[0]=120,t[1]=n<<6|(n?32-2*n:1)},$o=function(t){if((t[0]&15)!=8||t[0]>>>4>7||(t[0]<<8|t[1])%31)throw"invalid zlib data";if(t[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function ea(t,e){e===void 0&&(e={});var r=Jo();r.p(t);var n=Xo(t,e,2,4);return qo(n,e),Qo(n,n.length-4,r.d()),n}function ta(t,e){return zo(($o(t),t.subarray(2,-4)),e)}function Ai(t,e){var r=t.length;if(!e&&typeof TextEncoder<"u")return new TextEncoder().encode(t);for(var n=new oe(t.length+(t.length>>>1)),i=0,s=function(c){n[i++]=c},o=0;o<r;++o){if(i+5>n.length){var l=new oe(i+8+(r-o<<1));l.set(n),n=l}var a=t.charCodeAt(o);a<128||e?s(a):a<2048?(s(192|a>>>6),s(128|a&63)):a>55295&&a<57344?(a=65536+(a&1047552)|t.charCodeAt(++o)&1023,s(240|a>>>18),s(128|a>>>12&63),s(128|a>>>6&63),s(128|a&63)):(s(224|a>>>12),s(128|a>>>6&63),s(128|a&63))}return Gr(n,0,i)}function Ni(t,e){var r="";if(!e&&typeof TextDecoder<"u")return new TextDecoder().decode(t);for(var n=0;n<t.length;){var i=t[n++];i<128||e?r+=String.fromCharCode(i):i<224?r+=String.fromCharCode((i&31)<<6|t[n++]&63):i<240?r+=String.fromCharCode((i&15)<<12|(t[n++]&63)<<6|t[n++]&63):(i=((i&15)<<18|(t[n++]&63)<<12|(t[n++]&63)<<6|t[n++]&63)-65536,r+=String.fromCharCode(55296|i>>10,56320|i&1023))}return r}var br="v1",ra=t=>{let e=Object.assign(Object.assign({},t),{v:br});return Ni(ea(Ai(JSON.stringify(e))),!0)},na=t=>{if(typeof t!="string")return t;try{let e=JSON.parse(t);if(e.timestamp)return e}catch{}try{let e=JSON.parse(Ni(ta(Ai(t,!0))));if(e.v===br)return e;throw new Error(`These events were packed with packer ${e.v} which is incompatible with current packer ${br}.`)}catch(e){throw console.error(e),new Error("Unknown data format.")}},ke=class{constructor(e){this.fileName=e.fileName||"",this.functionName=e.functionName||"",this.lineNumber=e.lineNumber,this.columnNumber=e.columnNumber}toString(){let e=this.lineNumber||"",r=this.columnNumber||"";return this.functionName?`${this.functionName} (${this.fileName}:${e}:${r})`:`${this.fileName}:${e}:${r}`}},ia=/(^|@)\S+:\d+/,Fn=/^\s*at .*(\S+:\d+|\(native\))/m,sa=/^(eval@)?(\[native code])?$/,Qt={parse:function(t){return t?typeof t.stacktrace<"u"||typeof t["opera#sourceloc"]<"u"?this.parseOpera(t):t.stack&&t.stack.match(Fn)?this.parseV8OrIE(t):t.stack?this.parseFFOrSafari(t):(console.warn("[console-record-plugin]: Failed to parse error object:",t),[]):[]},extractLocation:function(t){if(t.indexOf(":")===-1)return[t];let r=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(t.replace(/[()]/g,""));if(!r)throw new Error(`Cannot parse given url: ${t}`);return[r[1],r[2]||void 0,r[3]||void 0]},parseV8OrIE:function(t){return t.stack.split(`
`).filter(function(r){return!!r.match(Fn)},this).map(function(r){r.indexOf("(eval ")>-1&&(r=r.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(\),.*$)/g,""));let n=r.replace(/^\s+/,"").replace(/\(eval code/g,"("),i=n.match(/ (\((.+):(\d+):(\d+)\)$)/);n=i?n.replace(i[0],""):n;let s=n.split(/\s+/).slice(1),o=this.extractLocation(i?i[1]:s.pop()),l=s.join(" ")||void 0,a=["eval","<anonymous>"].indexOf(o[0])>-1?void 0:o[0];return new ke({functionName:l,fileName:a,lineNumber:o[1],columnNumber:o[2]})},this)},parseFFOrSafari:function(t){return t.stack.split(`
`).filter(function(r){return!r.match(sa)},this).map(function(r){if(r.indexOf(" > eval")>-1&&(r=r.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),r.indexOf("@")===-1&&r.indexOf(":")===-1)return new ke({functionName:r});{let n=/((.*".+"[^@]*)?[^@]*)(?:@)/,i=r.match(n),s=i&&i[1]?i[1]:void 0,o=this.extractLocation(r.replace(n,""));return new ke({functionName:s,fileName:o[0],lineNumber:o[1],columnNumber:o[2]})}},this)},parseOpera:function(t){return!t.stacktrace||t.message.indexOf(`
`)>-1&&t.message.split(`
`).length>t.stacktrace.split(`
`).length?this.parseOpera9(t):t.stack?this.parseOpera11(t):this.parseOpera10(t)},parseOpera9:function(t){let e=/Line (\d+).*script (?:in )?(\S+)/i,r=t.message.split(`
`),n=[];for(let i=2,s=r.length;i<s;i+=2){let o=e.exec(r[i]);o&&n.push(new ke({fileName:o[2],lineNumber:parseFloat(o[1])}))}return n},parseOpera10:function(t){let e=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,r=t.stacktrace.split(`
`),n=[];for(let i=0,s=r.length;i<s;i+=2){let o=e.exec(r[i]);o&&n.push(new ke({functionName:o[3]||void 0,fileName:o[2],lineNumber:parseFloat(o[1])}))}return n},parseOpera11:function(t){return t.stack.split(`
`).filter(function(r){return!!r.match(ia)&&!r.match(/^Error created at/)},this).map(function(r){let n=r.split("@"),i=this.extractLocation(n.pop()),o=(n.shift()||"").replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;return new ke({functionName:o,fileName:i[0],lineNumber:i[1],columnNumber:i[2]})},this)}};function oa(t){if(!t||!t.outerHTML)return"";let e="";for(;t.parentElement;){let r=t.localName;if(!r)break;r=r.toLowerCase();let n=t.parentElement,i=[];if(n.children&&n.children.length>0)for(let s=0;s<n.children.length;s++){let o=n.children[s];o.localName&&o.localName.toLowerCase&&o.localName.toLowerCase()===r&&i.push(o)}i.length>1&&(r+=`:eq(${i.indexOf(t)})`),e=r+(e?">"+e:""),t=n}return e}function wr(t){return Object.prototype.toString.call(t)==="[object Object]"}function Ti(t,e){if(e===0)return!0;let r=Object.keys(t);for(let n of r)if(wr(t[n])&&Ti(t[n],e-1))return!0;return!1}function Ue(t,e){let r={numOfKeysLimit:50,depthOfLimit:4};Object.assign(r,e);let n=[],i=[];return JSON.stringify(t,function(l,a){if(n.length>0){let c=n.indexOf(this);~c?n.splice(c+1):n.push(this),~c?i.splice(c,1/0,l):i.push(l),~n.indexOf(a)&&(n[0]===a?a="[Circular ~]":a="[Circular ~."+i.slice(0,n.indexOf(a)).join(".")+"]")}else n.push(a);if(a===null)return a;if(a===void 0)return"undefined";if(s(a))return o(a);if(a instanceof Event){let c={};for(let u in a){let d=a[u];Array.isArray(d)?c[u]=oa(d.length?d[0]:null):c[u]=d}return c}else{if(a instanceof Node)return a instanceof HTMLElement?a?a.outerHTML:"":a.nodeName;if(a instanceof Error)return a.stack?a.stack+`
End of stack for Error object`:a.name+": "+a.message}return a});function s(l){return!!(wr(l)&&Object.keys(l).length>r.numOfKeysLimit||typeof l=="function"||wr(l)&&Ti(l,r.depthOfLimit))}function o(l){let a=l.toString();return r.stringLengthLimit&&a.length>r.stringLengthLimit&&(a=`${a.slice(0,r.stringLengthLimit)}...`),a}}var _n={level:["assert","clear","count","countReset","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","table","time","timeEnd","timeLog","trace","warn"],lengthThreshold:1e3,logger:"console"};function aa(t,e,r){let n=r?Object.assign({},_n,r):_n,i=n.logger;if(!i)return()=>{};let s;typeof i=="string"?s=e[i]:s=i;let o=0,l=!1,a=[];if(n.level.includes("error")){let u=h=>{let f=h.message,p=h.error,m=Qt.parse(p).map(y=>y.toString()),I=[Ue(f,n.stringifyOptions)];t({level:"error",trace:m,payload:I})};e.addEventListener("error",u),a.push(()=>{e.removeEventListener("error",u)});let d=h=>{let f,p;h.reason instanceof Error?(f=h.reason,p=[Ue(`Uncaught (in promise) ${f.name}: ${f.message}`,n.stringifyOptions)]):(f=new Error,p=[Ue("Uncaught (in promise)",n.stringifyOptions),Ue(h.reason,n.stringifyOptions)]);let m=Qt.parse(f).map(I=>I.toString());t({level:"error",trace:m,payload:p})};e.addEventListener("unhandledrejection",d),a.push(()=>{e.removeEventListener("unhandledrejection",d)})}for(let u of n.level)a.push(c(s,u));return()=>{a.forEach(u=>u())};function c(u,d){return u[d]?Be(u,d,h=>(...f)=>{if(h.apply(this,f),!l){l=!0;try{let p=Qt.parse(new Error).map(I=>I.toString()).splice(1),m=f.map(I=>Ue(I,n.stringifyOptions));o++,o<n.lengthThreshold?t({level:d,trace:p,payload:m}):o===n.lengthThreshold&&t({level:"warn",trace:[],payload:[Ue("The number of log records reached the threshold.")]})}catch(p){h("rrweb logger error:",p,...f)}finally{l=!1}}}):()=>{}}}var Hr="rrweb/console@1",la=t=>({name:Hr,observer:aa,options:t}),Ct="__rrweb_original__",ca={level:["assert","clear","count","countReset","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","table","time","timeEnd","timeLog","trace","warn"],replayLogger:void 0},Er=class{constructor(e){this.config=Object.assign(ca,e)}getConsoleLogger(){let e={};for(let r of this.config.level)r==="trace"?e[r]=n=>{(console.log[Ct]?console.log[Ct]:console.log)(...n.payload.map(s=>JSON.parse(s)),this.formatMessage(n))}:e[r]=n=>{(console[r][Ct]?console[r][Ct]:console[r])(...n.payload.map(s=>JSON.parse(s)),this.formatMessage(n))};return e}formatMessage(e){if(e.trace.length===0)return"";let r=`
	at `,n=r;return n+=e.trace.join(r),n}},ua=t=>{let e=t?.replayLogger||new Er(t).getConsoleLogger();return{handler(r,n,i){let s=null;if(r.type===M.IncrementalSnapshot&&r.data.source===A.Log?s=r.data:r.type===M.Plugin&&r.data.plugin===Hr&&(s=r.data.payload),s)try{typeof e[s.level]=="function"&&e[s.level](s)}catch(o){i.replayer.config.showWarning&&console.warn(o)}}}};re.EventType=M;re.IncrementalSource=A;re.MouseInteractions=V;re.PLUGIN_NAME=Hr;re.Replayer=vr;re.ReplayerEvents=Z;re.addCustomEvent=Po;re.freezePage=Wo;re.getRecordConsolePlugin=la;re.getReplayConsolePlugin=ua;re.pack=ra;re.record=Pe;re.unpack=na;re.utils=Ds});function Ji(t){let e="__DOUBLE_ASTERISK_TOKEN__",r="__SINGLE_ASTERISK_TOKEN__",i=t.replace(/\*\*/g,e).replace(/\*/g,r).replace(/[.+?^${}()|[\]\\]/g,"\\$&");i=i.replace(new RegExp(`/${e}/`,"g"),"/(?:.+/)?"),i=i.replace(new RegExp(e,"g"),".*"),i=i.replace(/\//g,"\\/");let s=i.replace(new RegExp(r,"g"),"[^/]+");return new RegExp("^"+s+"$")}function Ht(t,e){for(let r of e)try{if(Ji(r).test(t))return r}catch(n){console.error(`Invalid pattern: ${r}`,n)}return null}function rn(t,e){let r=null;return(...n)=>{r&&clearTimeout(r),r=setTimeout(()=>t(...n),e)}}function nn(t){try{let e=window.location.hostname,r=new URL(t).hostname;return r!==e&&r!==""}catch{return!1}}function Zt(t,e){if(!t)return e;try{let r=JSON.parse(t);return Array.isArray(e)&&!Array.isArray(r)?e:r}catch(r){return console.error("Error parsing JSON:",r),e}}function sn(t){let e=t.getAttribute("src");if(!e)return console.error("Script src attribute is missing"),null;let r=e.split("/script.js")[0];if(!r)return console.error("Please provide a valid analytics host"),null;let n=t.getAttribute("data-site-id")||t.getAttribute("site-id");if(!n||isNaN(Number(n)))return console.error("Please provide a valid site ID using the data-site-id attribute"),null;let i=t.getAttribute("data-debounce")?Math.max(0,parseInt(t.getAttribute("data-debounce"))):500,s=Zt(t.getAttribute("data-skip-patterns"),[]),o=Zt(t.getAttribute("data-mask-patterns"),[]),l=t.getAttribute("data-api-key")||void 0,a=t.getAttribute("data-replay-batch-size")?Math.max(1,parseInt(t.getAttribute("data-replay-batch-size"))):3,c=t.getAttribute("data-replay-batch-interval")?Math.max(1e3,parseInt(t.getAttribute("data-replay-batch-interval"))):2e3;return console.info(t),{analyticsHost:r,siteId:n,debounceDuration:i,autoTrackPageview:t.getAttribute("data-auto-track-pageview")!=="false",autoTrackSpa:t.getAttribute("data-track-spa")!=="false",trackQuerystring:t.getAttribute("data-track-query")!=="false",trackOutbound:t.getAttribute("data-track-outbound")!=="false",enableWebVitals:t.getAttribute("data-web-vitals")==="true",trackErrors:t.getAttribute("data-track-errors")==="true",enableSessionReplay:t.getAttribute("data-session-replay")==="true",sessionReplayBatchSize:a,sessionReplayBatchInterval:c,skipPatterns:s,maskPatterns:o,apiKey:l}}var da=Ri(),_t=class{constructor(e,r,n){this.isRecording=!1;this.eventBuffer=[];this.config=e,this.userId=r,this.sendBatch=n}async initialize(){this.config.enableSessionReplay&&this.startRecording()}startRecording(){if(this.isRecording||!this.config.enableSessionReplay){console.log("[Session Replay] Cannot start recording:",{isRecording:this.isRecording,enableSessionReplay:this.config.enableSessionReplay});return}console.log("[Session Replay] Starting recording at",new Date().toISOString()),console.log("[Session Replay] Document ready state:",document.readyState);try{this.stopRecordingFn=da.record({emit:e=>{let n={0:"DOMContentLoaded",1:"Load",2:"FullSnapshot",3:"IncrementalSnapshot",4:"Meta",5:"Custom",6:"Plugin"}[e.type]||`Unknown(${e.type})`;console.log(`[Session Replay] Event collected: Type ${e.type} (${n}) at ${new Date(e.timestamp||Date.now()).toISOString()}`),this.addEvent({type:e.type,data:e.data,timestamp:e.timestamp||Date.now()})},recordCanvas:!0,collectFonts:!0,checkoutEveryNms:3e4,checkoutEveryNth:200,maskAllInputs:!0,maskInputOptions:{password:!0,email:!0},slimDOMOptions:{script:!1,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0},sampling:{mousemove:!1,mouseInteraction:!0,scroll:150,input:"last"}}),this.isRecording=!0,this.setupBatchTimer(),console.log("Session replay recording started")}catch(e){console.error("Failed to start session replay recording:",e)}}stopRecording(){this.isRecording&&(this.stopRecordingFn&&this.stopRecordingFn(),this.isRecording=!1,this.clearBatchTimer(),this.eventBuffer.length>0&&this.flushEvents(),console.log("Session replay recording stopped"))}isActive(){return this.isRecording}addEvent(e){this.eventBuffer.push(e),console.log(`[Session Replay] Event added to buffer (${this.eventBuffer.length}/${this.config.sessionReplayBatchSize})`),this.eventBuffer.length>=this.config.sessionReplayBatchSize&&(console.log(`[Session Replay] Buffer full, flushing ${this.eventBuffer.length} events`),this.flushEvents())}setupBatchTimer(){this.clearBatchTimer(),this.batchTimer=window.setInterval(()=>{this.eventBuffer.length>0&&(console.log(`[Session Replay] Timer triggered, flushing ${this.eventBuffer.length} events`),this.flushEvents())},this.config.sessionReplayBatchInterval)}clearBatchTimer(){this.batchTimer&&(clearInterval(this.batchTimer),this.batchTimer=void 0)}async flushEvents(){if(this.eventBuffer.length===0)return;let e=[...this.eventBuffer];this.eventBuffer=[],console.log(`[Session Replay] Sending batch with ${e.length} events to server`),console.log("[Session Replay] Event types in batch:",e.map(n=>`Type ${n.type}`).join(", ")),console.log("[Session Replay] Batch size:",JSON.stringify(e).length,"characters");let r={userId:this.userId,events:e,metadata:{pageUrl:window.location.href,viewportWidth:screen.width,viewportHeight:screen.height,language:navigator.language}};try{await this.sendBatch(r),console.log(`[Session Replay] Successfully sent batch with ${e.length} events`)}catch(n){console.error("Failed to send session replay batch:",n),console.error("Failed batch details:",{eventCount:e.length,eventTypes:e.map(i=>i.type),batchSize:JSON.stringify(r).length,userId:this.userId,url:window.location.href}),console.log(`[Session Replay] Re-queuing ${e.length} failed events for retry`),this.eventBuffer.unshift(...e)}}updateUserId(e){this.userId=e}onPageChange(){this.isRecording&&this.flushEvents()}cleanup(){this.stopRecording()}};var Bt=class{constructor(e){this.customUserId=null;this.config=e,this.loadUserId(),e.enableSessionReplay&&this.initializeSessionReplay()}loadUserId(){try{let e=localStorage.getItem("rybbit-user-id");e&&(this.customUserId=e)}catch{}}async initializeSessionReplay(){try{this.sessionReplayRecorder=new _t(this.config,this.customUserId||"",e=>this.sendSessionReplayBatch(e)),await this.sessionReplayRecorder.initialize()}catch(e){console.error("Failed to initialize session replay:",e)}}async sendSessionReplayBatch(e){try{await fetch(`${this.config.analyticsHost}/session-replay/record/${this.config.siteId}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),mode:"cors",keepalive:!1})}catch(r){throw console.error("Failed to send session replay batch:",r),r}}createBasePayload(){let e=new URL(window.location.href),r=e.pathname;if(e.hash&&e.hash.startsWith("#/")&&(r=e.hash.substring(1)),Ht(r,this.config.skipPatterns))return null;let n=Ht(r,this.config.maskPatterns);n&&(r=n);let i={site_id:this.config.siteId,hostname:e.hostname,pathname:r,querystring:this.config.trackQuerystring?e.search:"",screenWidth:screen.width,screenHeight:screen.height,language:navigator.language,page_title:document.title,referrer:document.referrer};return this.customUserId&&(i.user_id=this.customUserId),this.config.apiKey&&(i.api_key=this.config.apiKey),i}async sendTrackingData(e){try{await fetch(`${this.config.analyticsHost}/track`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),mode:"cors",keepalive:!0})}catch(r){console.error("Failed to send tracking data:",r)}}track(e,r="",n={}){if(e==="custom_event"&&(!r||typeof r!="string")){console.error("Event name is required and must be a string for custom events");return}let i=this.createBasePayload();if(!i)return;let s={...i,type:e,event_name:r,properties:e==="custom_event"||e==="outbound"||e==="error"?JSON.stringify(n):void 0};this.sendTrackingData(s)}trackPageview(){this.track("pageview")}trackEvent(e,r={}){this.track("custom_event",e,r)}trackOutbound(e,r="",n="_self"){this.track("outbound","",{url:e,text:r,target:n})}trackWebVitals(e){let r=this.createBasePayload();if(!r)return;let n={...r,type:"performance",event_name:"web-vitals",...e};this.sendTrackingData(n)}trackError(e,r={}){let n=window.location.origin,i=r.filename||"",s=e.stack||"";if(i)try{if(new URL(i).origin!==n)return}catch{}else if(s&&!s.includes(n))return;let o={message:e.message?.substring(0,500)||"Unknown error",stack:s.substring(0,2e3)||""};if(i&&(o.fileName=i),r.lineno){let l=typeof r.lineno=="string"?parseInt(r.lineno,10):r.lineno;l&&l!==0&&(o.lineNumber=l)}if(r.colno){let l=typeof r.colno=="string"?parseInt(r.colno,10):r.colno;l&&l!==0&&(o.columnNumber=l)}for(let l in r)!["lineno","colno"].includes(l)&&r[l]!==void 0&&(o[l]=r[l]);this.track("error",e.name||"Error",o)}identify(e){if(typeof e!="string"||e.trim()===""){console.error("User ID must be a non-empty string");return}this.customUserId=e.trim();try{localStorage.setItem("rybbit-user-id",this.customUserId)}catch{console.warn("Could not persist user ID to localStorage")}this.sessionReplayRecorder&&this.sessionReplayRecorder.updateUserId(this.customUserId)}clearUserId(){this.customUserId=null;try{localStorage.removeItem("rybbit-user-id")}catch{}}getUserId(){return this.customUserId}startSessionReplay(){this.sessionReplayRecorder?this.sessionReplayRecorder.startRecording():console.warn("Session replay not initialized")}stopSessionReplay(){this.sessionReplayRecorder&&this.sessionReplayRecorder.stopRecording()}isSessionReplayActive(){return this.sessionReplayRecorder?.isActive()??!1}onPageChange(){this.sessionReplayRecorder&&this.sessionReplayRecorder.onPageChange()}cleanup(){this.sessionReplayRecorder&&this.sessionReplayRecorder.cleanup()}};var Pi=-1,$e=t=>{addEventListener("pageshow",e=>{e.persisted&&(Pi=e.timeStamp,t(e))},!0)},Ie=(t,e,r,n)=>{let i,s;return o=>{e.value>=0&&(o||n)&&(s=e.value-(i??0),(s||i===void 0)&&(i=e.value,e.delta=s,e.rating=((l,a)=>l>a[1]?"poor":l>a[0]?"needs-improvement":"good")(e.value,r),t(e)))}},Qr=t=>{requestAnimationFrame(()=>requestAnimationFrame(()=>t()))},qr=()=>{let t=performance.getEntriesByType("navigation")[0];if(t&&t.responseStart>0&&t.responseStart<performance.now())return t},mt=()=>qr()?.activationStart??0,Se=(t,e=-1)=>{let r=qr(),n="navigate";return Pi>=0?n="back-forward-cache":r&&(document.prerendering||mt()>0?n="prerender":document.wasDiscarded?n="restore":r.type&&(n=r.type.replace(/_/g,"-"))),{name:t,value:e,rating:"good",delta:0,entries:[],id:`v5-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:n}},Zr=new WeakMap;function $r(t,e){return Zr.get(t)||Zr.set(t,new e),Zr.get(t)}var Yr=class{constructor(){be(this,"t");be(this,"i",0);be(this,"o",[])}h(e){if(e.hadRecentInput)return;let r=this.o[0],n=this.o.at(-1);this.i&&r&&n&&e.startTime-n.startTime<1e3&&e.startTime-r.startTime<5e3?(this.i+=e.value,this.o.push(e)):(this.i=e.value,this.o=[e]),this.t?.(e)}},gt=(t,e,r={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(t)){let n=new PerformanceObserver(i=>{Promise.resolve().then(()=>{e(i.getEntries())})});return n.observe({type:t,buffered:!0,...r}),n}}catch{}},en=t=>{let e=!1;return()=>{e||(t(),e=!0)}},qe=-1,Mi=()=>document.visibilityState!=="hidden"||document.prerendering?1/0:0,Wt=t=>{document.visibilityState==="hidden"&&qe>-1&&(qe=t.type==="visibilitychange"?t.timeStamp:0,ha())},ki=()=>{addEventListener("visibilitychange",Wt,!0),addEventListener("prerenderingchange",Wt,!0)},ha=()=>{removeEventListener("visibilitychange",Wt,!0),removeEventListener("prerenderingchange",Wt,!0)},Wi=()=>{if(qe<0){let t=mt();qe=(document.prerendering?void 0:globalThis.performance.getEntriesByType("visibility-state").filter(r=>r.name==="hidden"&&r.startTime>t)[0]?.startTime)??Mi(),ki(),$e(()=>{setTimeout(()=>{qe=Mi(),ki()})})}return{get firstHiddenTime(){return qe}}},Ut=t=>{document.prerendering?addEventListener("prerenderingchange",()=>t(),!0):t()},Di=[1800,3e3],tn=(t,e={})=>{Ut(()=>{let r=Wi(),n,i=Se("FCP"),s=gt("paint",o=>{for(let l of o)l.name==="first-contentful-paint"&&(s.disconnect(),l.startTime<r.firstHiddenTime&&(i.value=Math.max(l.startTime-mt(),0),i.entries.push(l),n(!0)))});s&&(n=Ie(t,i,Di,e.reportAllChanges),$e(o=>{i=Se("FCP"),n=Ie(t,i,Di,e.reportAllChanges),Qr(()=>{i.value=performance.now()-o.timeStamp,n(!0)})}))})},Oi=[.1,.25],Ui=(t,e={})=>{tn(en(()=>{let r,n=Se("CLS",0),i=$r(e,Yr),s=l=>{for(let a of l)i.h(a);i.i>n.value&&(n.value=i.i,n.entries=i.o,r())},o=gt("layout-shift",s);o&&(r=Ie(t,n,Oi,e.reportAllChanges),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&(s(o.takeRecords()),r(!0))}),$e(()=>{i.i=0,n=Se("CLS",0),r=Ie(t,n,Oi,e.reportAllChanges),Qr(()=>r())}),setTimeout(r))}))},Vi=0,zr=1/0,Pt=0,fa=t=>{for(let e of t)e.interactionId&&(zr=Math.min(zr,e.interactionId),Pt=Math.max(Pt,e.interactionId),Vi=Pt?(Pt-zr)/7+1:0)},Kr,xi=()=>Kr?Vi:performance.interactionCount??0,pa=()=>{"interactionCount"in performance||Kr||(Kr=gt("event",fa,{type:"event",buffered:!0,durationThreshold:0}))},Li=0,jr=class{constructor(){be(this,"u",[]);be(this,"l",new Map);be(this,"m");be(this,"v")}p(){Li=xi(),this.u.length=0,this.l.clear()}P(){let e=Math.min(this.u.length-1,Math.floor((xi()-Li)/50));return this.u[e]}h(e){if(this.m?.(e),!e.interactionId&&e.entryType!=="first-input")return;let r=this.u.at(-1),n=this.l.get(e.interactionId);if(n||this.u.length<10||e.duration>r.T){if(n?e.duration>n.T?(n.entries=[e],n.T=e.duration):e.duration===n.T&&e.startTime===n.entries[0].startTime&&n.entries.push(e):(n={id:e.interactionId,entries:[e],T:e.duration},this.l.set(n.id,n),this.u.push(n)),this.u.sort((i,s)=>s.T-i.T),this.u.length>10){let i=this.u.splice(10);for(let s of i)this.l.delete(s.id)}this.v?.(n)}}},Gi=t=>{let e=globalThis.requestIdleCallback||setTimeout;document.visibilityState==="hidden"?t():(t=en(t),document.addEventListener("visibilitychange",t,{once:!0}),e(()=>{t(),document.removeEventListener("visibilitychange",t)}))},Fi=[200,500],Hi=(t,e={})=>{globalThis.PerformanceEventTiming&&"interactionId"in PerformanceEventTiming.prototype&&Ut(()=>{pa();let r,n=Se("INP"),i=$r(e,jr),s=l=>{Gi(()=>{for(let c of l)i.h(c);let a=i.P();a&&a.T!==n.value&&(n.value=a.T,n.entries=a.entries,r())})},o=gt("event",s,{durationThreshold:e.durationThreshold??40});r=Ie(t,n,Fi,e.reportAllChanges),o&&(o.observe({type:"first-input",buffered:!0}),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&(s(o.takeRecords()),r(!0))}),$e(()=>{i.p(),n=Se("INP"),r=Ie(t,n,Fi,e.reportAllChanges)}))})},Jr=class{constructor(){be(this,"m")}h(e){this.m?.(e)}},_i=[2500,4e3],Zi=(t,e={})=>{Ut(()=>{let r=Wi(),n,i=Se("LCP"),s=$r(e,Jr),o=a=>{e.reportAllChanges||(a=a.slice(-1));for(let c of a)s.h(c),c.startTime<r.firstHiddenTime&&(i.value=Math.max(c.startTime-mt(),0),i.entries=[c],n())},l=gt("largest-contentful-paint",o);if(l){n=Ie(t,i,_i,e.reportAllChanges);let a=en(()=>{o(l.takeRecords()),l.disconnect(),n(!0)});for(let c of["keydown","click","visibilitychange"])addEventListener(c,()=>Gi(a),{capture:!0,once:!0});$e(c=>{i=Se("LCP"),n=Ie(t,i,_i,e.reportAllChanges),Qr(()=>{i.value=performance.now()-c.timeStamp,n(!0)})})}})},Bi=[800,1800],Xr=t=>{document.prerendering?Ut(()=>Xr(t)):document.readyState!=="complete"?addEventListener("load",()=>Xr(t),!0):setTimeout(t)},zi=(t,e={})=>{let r=Se("TTFB"),n=Ie(t,r,Bi,e.reportAllChanges);Xr(()=>{let i=qr();i&&(r.value=Math.max(i.responseStart-mt(),0),r.entries=[i],n(!0),$e(()=>{r=Se("TTFB",0),n=Ie(t,r,Bi,e.reportAllChanges),n(!0)}))})};var Vt=class{constructor(e){this.data={lcp:null,cls:null,inp:null,fcp:null,ttfb:null};this.sent=!1;this.timeout=null;this.onReadyCallback=null;this.onReadyCallback=e}initialize(){try{Zi(this.collectMetric.bind(this)),Ui(this.collectMetric.bind(this)),Hi(this.collectMetric.bind(this)),tn(this.collectMetric.bind(this)),zi(this.collectMetric.bind(this)),this.timeout=setTimeout(()=>{this.sent||this.sendData()},2e4),window.addEventListener("beforeunload",()=>{this.sent||this.sendData()})}catch(e){console.warn("Error initializing web vitals tracking:",e)}}collectMetric(e){if(this.sent)return;let r=e.name.toLowerCase();this.data[r]=e.value,Object.values(this.data).every(i=>i!==null)&&this.sendData()}sendData(){this.sent||(this.sent=!0,this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.onReadyCallback&&this.onReadyCallback(this.data))}getData(){return{...this.data}}};(function(){let t=document.currentScript;if(!t){console.error("Could not find current script tag");return}if(window.__RYBBIT_OPTOUT__||localStorage.getItem("disable-rybbit")!==null){window.rybbit={pageview:()=>{},event:()=>{},trackOutbound:()=>{},identify:()=>{},clearUserId:()=>{},getUserId:()=>null,startSessionReplay:()=>{},stopSessionReplay:()=>{},isSessionReplayActive:()=>!1};return}let e=sn(t);if(!e)return;let r=new Bt(e);e.enableWebVitals&&new Vt(l=>{r.trackWebVitals(l)}).initialize(),e.trackErrors&&(window.addEventListener("error",o=>{r.trackError(o.error||new Error(o.message),{filename:o.filename,lineno:o.lineno,colno:o.colno})}),window.addEventListener("unhandledrejection",o=>{let l=o.reason instanceof Error?o.reason:new Error(String(o.reason));r.trackError(l,{type:"unhandledrejection"})}));let n=()=>r.trackPageview(),i=e.debounceDuration>0?rn(n,e.debounceDuration):n;function s(){if(document.addEventListener("click",function(o){let l=o.target;for(;l&&l!==document.documentElement;){if(l.hasAttribute("data-rybbit-event")){let a=l.getAttribute("data-rybbit-event");if(a){let c={};for(let u of l.attributes)if(u.name.startsWith("data-rybbit-prop-")){let d=u.name.replace("data-rybbit-prop-","");c[d]=u.value}r.trackEvent(a,c)}break}l=l.parentElement}if(e.trackOutbound){let a=o.target.closest("a");a?.href&&nn(a.href)&&r.trackOutbound(a.href,a.innerText||a.textContent||"",a.target||"_self")}}),e.autoTrackSpa){let o=history.pushState,l=history.replaceState;history.pushState=function(...a){o.apply(this,a),i(),r.onPageChange()},history.replaceState=function(...a){l.apply(this,a),i(),r.onPageChange()},window.addEventListener("popstate",()=>{i(),r.onPageChange()}),window.addEventListener("hashchange",()=>{i(),r.onPageChange()})}}window.rybbit={pageview:()=>r.trackPageview(),event:(o,l={})=>r.trackEvent(o,l),trackOutbound:(o,l="",a="_self")=>r.trackOutbound(o,l,a),identify:o=>r.identify(o),clearUserId:()=>r.clearUserId(),getUserId:()=>r.getUserId(),startSessionReplay:()=>r.startSessionReplay(),stopSessionReplay:()=>r.stopSessionReplay(),isSessionReplayActive:()=>r.isSessionReplayActive()},s(),window.addEventListener("beforeunload",()=>{r.cleanup()}),e.autoTrackPageview&&r.trackPageview()})();})();
/*! Bundled license information:

rrweb/lib/rrweb-all.cjs:
  (*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** *)
*/
